---
title: "Prediksi Produksi Jagung Masa Depan - Aceh"
author: "Nurul Aina Tasya"
date: "2023-11-01"
output: html_document
---

# 1. Load Library/Packages
```{r}
# library untuk manipulasi data
library(dplyr)
library(tidyverse)
# library untuk manipulasi data tanggal
library(lubridate)
# library untuk menampilkan hasil statistik deskriptif
library(summarytools)
# library untuk visualisasi data
library (ggplot2)
# library untuk membaca data dari file Excel (.xlsx)
library(readxl)
# library untuk model Random Forest
library(randomForest)
# library untuk model SVR
library(e1071)
# library Untuk partisi dataset
library(caret)
# library untuk evaluasi model
library(Metrics)
# library untuk model Prophet
library (prophet)
```


# 2. Obstain Data

## a.Import Data
```{r}
pangan <- read_excel("Dataset Jagung Indonesia/pangan_Indonesia.xlsx")
```

## b.Menampilkan Contoh Data
```{r}
# Menampilkan 6 data teratas
head(pangan)
```
```{r}
# Menampilkan 6 data terbawah
tail(pangan)
```
```{r}
glimpse(pangan)
```

# 3. Scrub Data

## a. Merubah type data
```{r}
# Merubah type data karakter menjadi numeric
pangan$Produksi <- as.numeric(pangan$Produksi)
pangan$Produktivitas <- as.numeric(pangan$Produktivitas)
pangan$Luas_Panen <- as.numeric(pangan$Luas_Panen)
glimpse(pangan)
```
```{r}
# Merubah type Tahun menjadi Date
pangan$Tahun <- make_date(pangan$Tahun)
glimpse(pangan)
```
```{r}
tail(pangan)
```
```{r}
head(pangan)
```

## b. Menghapus Data Kosong
```{r}
# Menampilkan variabel dengan baris kosong
glimpse(pangan)
colSums(is.na(pangan))
```
Jumlah data : 5,474 Record. Dari 6 variabel terhadap 3 buah variabel dengan data NA'S

```{r}
# Menghapus data NA'S
pangan_clean <- na.omit(pangan)
colSums(is.na(pangan_clean))
summary(pangan_clean)
```
Berdasarkan hasil diatas bisa dilihat semua variabel tidak ada lagi data
yang kosong atau NA'
```{r}
glimpse(pangan_clean)
```
Jumlah data setelah dihapus data NA' menjadi 4,643 baris observasi dengan
6 variabel.


# 4. Explore Data Analysis (EDA)
## a.Tampilkan Dataset
```{r}
glimpse(pangan_clean)
```
## b.Menampilkan hasil statistik deskriptif
```{r}
descr(pangan_clean)
```


## c. Jumlah Produksi Jagung Per Provinsi
```{r}
plot_jagung_1 <- ggplot(Jagung, aes(x = Tahun, y = Produksi, group = Provinsi, color = Provinsi)) +
  geom_line() +
  labs(title = "Jumlah Produksi Jagung", x = "Tahun", y = "Produksi Jagung (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung_1

```

```{r}
# Hitung total produksi per provinsi
totproduksi_jagung <- Jagung %>% 
  #mutate(first_date_month = floor_date(Tahun, unit = "year")) %>% 
  group_by(Provinsi) %>% 
  summarise(JumlahProduksi = sum(Produksi)) %>% 
  arrange(JumlahProduksi)
totproduksi_jagung
```

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Hitung total produksi per provinsi/tahun
totproduksi_jagung <- Jagung %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(TotalProduksi = sum(Produksi))

totproduksi_jagung
```

```{r}
summary(totproduksi_jagung)
```
## d. Tren Produksi Jagung Per Provinsi
```{r}
# Visualisasi Tren Produksi Jagung
plot_jagung_2 <- ggplot(totproduksi_jagung, aes(x = Tahun, y = TotalProduksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Jagung", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung_2
```

## e. Perbandingan Produksi Jagung Per Provinsi
```{r}
# Hitung total produksi Jagung per Provinsi
totproduksi_jagung_provinsi <- Jagung %>% 
  group_by(Provinsi) %>% 
  summarise(TotalProduksi = sum(Produksi))
totproduksi_jagung_provinsi

# Visualisasi dengan barplot
plot_jagung_3 <- ggplot(totproduksi_jagung_provinsi, aes(x = Provinsi, y = TotalProduksi, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Jagung antara Provinsi", x = "Provinsi", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_jagung_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Jagung dalam kurun waktu 1993 - 2015 adalah dari provinsi Jawa Timur yang terbanyak dengan Jumlah Produksi Jagung sebesar 98164357 Ton.

## f. Perbandingan Produktivitas Jagung Per Provinsi
```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren produktivitas jagung
produktivitas_jagung <- Jagung %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(Produktivitas = sum(Produktivitas))
produktivitas_jagung
```

```{r}

# Hitung total produktivitas Jagung per provinsi
totproduktivitas_jagung_provinsi <- Jagung %>% 
  group_by(Provinsi) %>% 
  summarise(Total_Produktivitas = sum(Produktivitas))

# Visualisasi dengan barplot
plot_jagung_4 <- ggplot(totproduktivitas_jagung_provinsi, aes(x = Provinsi, y = Total_Produktivitas, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produktivitas Jagung antar Provinsi", x = "Provinsi", y = "Produktivitas (Kuintal/Hektar)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_jagung_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))


```

## g. Korelasi Luas Panen, Produktivitas dengan Produksi Jagung
```{r}
# Visualisasi korelasi luas panen dan produksi Jagung
plot_jagung_5 <- ggplot(Jagung, aes(x = Luas_Panen, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_jagung1 <- cor(Jagung$Luas_Panen, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_jagung1)
```
Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0,95; sehingga bisa disimpulkan bahwa jika semakin banyak luas panen maka akan meningkat jumlah produksi jagung.

```{r}
# Visualisasi korelasi produktifitas dan produksi Jagung
plot_jagung_5 <- ggplot(Jagung, aes(x = Produktivitas, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Produktivitas", x = "Produktivitas (Kuintal/Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_jagung2 <- cor(Jagung$Produktivitas, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_jagung2)
```
Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0.38; Nilai korelasi sebesar 0.38 menunjukkan hubungan positif yang relatif lemah. Ini berarti bahwa meskipun ada hubungan antara produktivitas dan produksi, hubungannya tidak sangat kuat. Namun, itu masih dapat dianggap sebagai hubungan yang signifikan.

## h. Filter data jagung

```{r}
JagungAceh <- filter(pangan_clean, Jenis_Komoditi == "Jagung", Provinsi == "ACEH")
JagungAceh

```


# 5. Prediksi Produksi Jagung di Masa Depan - Model Prophet




