---
title: "Analisis Dampak Iklim Terhadap Produksi Pangan di Sumatera Barat"
author: "Nurul Aina Tasya"
date: "2023-10-31"
output: html_document
---

# 1. Load Library/Packages
```{r}
# library manipulasi data
library(tidyverse)
# library Untuk partisi dataset
library(caret) 
# library untuk evaluasi model
library(Metrics)
# library untuk import excel
library(readxl)
# library untuk model Random Forest
library(randomForest)
# library untuk model SVR
library(e1071)
```

# 2. Obstain - Load Dataset
## a. Import Data
```{r}
Iklim <- read_excel("dataset/Dataset Tanaman Pangan dan Iklim di Indonesia (2006-2015).xlsx")
Iklim
```

## b.Menampilkan Contoh Data
```{r}
# Menampilkan 6 data teratas
head(Iklim)
```
```{r}
# Menampilkan 6 data terbawah
tail(Iklim)
```
```{r}
glimpse(Iklim)
```


# 3. Scrub data
## a. Merubah type data
```{r}
# Merubah type Tahun menjadi Date
Iklim$Tahun <- make_date(Iklim$Tahun)
glimpse(Iklim)
tail(Iklim)
head(Iklim)
```
## b. Menghapus Data Kosong
```{r}
# Menampilkan variabel dengan baris kosong
glimpse(Iklim)
colSums(is.na(Iklim))
```
Jumlah data : 2,380 Record. Dari 11 variabel terhadap 8 buah variabel dengan data NA'S

```{r}
# Menghapus data NA'S
iklim_clean <- na.omit(Iklim)
colSums(is.na(iklim_clean))
summary(iklim_clean)
```
Berdasarkan hasil diatas bisa dilihat semua variabel tidak ada lagi data
yang kosong atau NA'
```{r}
glimpse(iklim_clean)
```
Jumlah data setelah dihapus data NA' menjadi 2,026 baris observasi dengan 11 variabel.

## c. Filter data
### - Filter data jagung
```{r}
Jagung <- filter(iklim_clean, Jenis_Komoditi == "Jagung", Provinsi == "SUMATERA BARAT")
Jagung

```
### - Filter data kacang hijau
```{r}
KacangHijau <- filter(iklim_clean, Jenis_Komoditi == "Kacang Hijau", Provinsi == "SUMATERA BARAT")
KacangHijau
```
### - Filter data kacang kedelai
```{r}
KacangKedelai <- filter(iklim_clean, Jenis_Komoditi == "Kedelai", Provinsi == "SUMATERA BARAT")
KacangKedelai
```
### - Filter data kacang tanah
```{r}
KacangTanah <- filter(iklim_clean, Jenis_Komoditi == "Kacang Tanah", Provinsi == "SUMATERA BARAT")
KacangTanah
```
### - Filter data ubi jalar
```{r}
UbiJalar <- filter(iklim_clean, Jenis_Komoditi == "Ubi Jalar", Provinsi == "SUMATERA BARAT")
UbiJalar

```
### - Filter data ubi kayu
```{r}
UbiKayu <- filter(iklim_clean, Jenis_Komoditi == "Ubi Kayu", Provinsi == "SUMATERA BARAT")
UbiKayu
```
### - Filter data padi
```{r}
Padi <- filter(iklim_clean, Jenis_Komoditi == "Padi", Provinsi == "SUMATERA BARAT")
Padi
```

# 4. Eksplorasi Data Analisis (EDA)
## 1. Padi
```{r}
plot_padi <- ggplot(Padi, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Padi di Sumatera Barat", x = "Tahun", y = "Produksi Padi (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_padi
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_pd <- cor(Padi$Luas_Panen, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_pd)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,99. Hubungan luas panen dan produksi padi bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi padi.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_pd <- cor(Padi$Kecepatan_Angin, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,22. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_pd <- cor(Padi$Kelembapan, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,25. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_pd <- cor(Padi$Suhu, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_pd <- cor(Padi$Tekanan_Udara, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,05. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_pd <- cor(Padi$Penyinaran_Matahari, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,01. 


```{r}
# Menghitung total produksi untuk setiap tahun
summary_padi <- Padi %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_padi
```

```{r}
# Visulisasi Produksi Padi Sepanjang Tahun 2006-2015
ggplot(summary_padi, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Padi dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##2. Kacang Hijau

```{r}
plot_kacanghijau <- ggplot(KacangHijau, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Kacang Hijau di Sumatera Barat", x = "Tahun", y = "Produksi Kacang Hijau (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacanghijau
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_kh <- cor(KacangHijau$Luas_Panen, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_kh)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,99. Hubungan luas panen dan produksi kacang hijau bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi kacang hijau.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_kh <- cor(KacangHijau$Kecepatan_Angin, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,01. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_kh <- cor(KacangHijau$Kelembapan, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,09. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_kh <- cor(KacangHijau$Suhu, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,21. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_kh <- cor(KacangHijau$Tekanan_Udara, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,20. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_kh <- cor(KacangHijau$Penyinaran_Matahari, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,28. 


```{r}
# Menghitung total produksi untuk setiap tahun
summary_kacanghijau <- KacangHijau %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_kacanghijau
```

```{r}
# Visulisasi Produksi Kacang Hijau Sepanjang Tahun 2006-2015
ggplot(summary_kacanghijau, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Hijau dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##3. Kacang Kedelai
```{r}
plot_kacangkedelai <- ggplot(KacangKedelai, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Kacang Kedelai di Sumatera Barat", x = "Tahun", y = "Produksi Kacang Kedelai (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangkedelai
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_kd <- cor(KacangKedelai$Luas_Panen, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_kd)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,97. Hubungan luas panen dan produksi kacang kedelai bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi kacang kedelai.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_kd <- cor(KacangKedelai$Kecepatan_Angin, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,15. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_kd <- cor(KacangKedelai$Kelembapan, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,2. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_kd <- cor(KacangKedelai$Suhu, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,05. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_kd <- cor(KacangKedelai$Tekanan_Udara, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,36. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_kd <- cor(KacangKedelai$Penyinaran_Matahari, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,55. 


```{r}
# Menghitung total produksi untuk setiap tahun
summary_kacangkedelai <- KacangKedelai %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_kacangkedelai
```

```{r}
# Visulisasi Produksi Kacang Hijau Sepanjang Tahun 2006-2015
ggplot(summary_kacangkedelai, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Kedelai dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##4. Kacang Tanah
```{r}
plot_kacangtanah <- ggplot(KacangTanah, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Kacang Tanah di Sumatera Barat", x = "Tahun", y = "Produksi Kacang Tanah (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangtanah
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_kt <- cor(KacangTanah$Luas_Panen, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_kt)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,89. Hubungan luas panen dan produksi kacang tanah bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi kacang tanah.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_kt <- cor(KacangTanah$Kecepatan_Angin, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,14. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_kt <- cor(KacangTanah$Kelembapan, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,57. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_kt <- cor(KacangTanah$Suhu, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_kt <- cor(KacangTanah$Tekanan_Udara, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,49. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_kt <- cor(KacangTanah$Penyinaran_Matahari, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,62. 


```{r}
# Menghitung total produksi untuk setiap tahun
summary_kacangtanah <- KacangTanah %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_kacangtanah
```

```{r}
# Visulisasi Produksi Kacang Tanah Sepanjang Tahun 2006-2015
ggplot(summary_kacangtanah, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Tanah dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##5. Ubi Jalar

```{r}
plot_ubijalar <- ggplot(UbiJalar, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Ubi Jalar di Sumatera Barat", x = "Tahun", y = "Produksi Ubi Jalar (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubijalar
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_uj <- cor(UbiJalar$Luas_Panen, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_uj)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,91. Hubungan luas panen dan produksi ubi jalar bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi ubi jalar.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_uj <- cor(UbiJalar$Kecepatan_Angin, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,15. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_uj <- cor(UbiJalar$Kelembapan, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,12. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_uj <- cor(UbiJalar$Suhu, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,07. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_uj <- cor(UbiJalar$Tekanan_Udara, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,03. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_uj <- cor(UbiJalar$Penyinaran_Matahari, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,11. 


```{r}
# Menghitung total produksi untuk setiap tahun
summary_ubijalar <- UbiJalar %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_ubijalar
```

```{r}
# Visulisasi Produksi Ubi Jalar Sepanjang Tahun 2006-2015
ggplot(summary_ubijalar, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Ubi Jalar dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##6. Ubi Kayu

```{r}
plot_ubikayu <- ggplot(UbiKayu, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Ubi Kayu di Sumatera Barat", x = "Tahun", y = "Produksi Ubi Kayu (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubikayu
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_uk <- cor(UbiKayu$Luas_Panen, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,23. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_uk <- cor(UbiKayu$Kecepatan_Angin, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,06. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_uk <- cor(UbiKayu$Kelembapan, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_uk <- cor(UbiKayu$Suhu, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_uk <- cor(UbiKayu$Tekanan_Udara, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_uk <- cor(UbiKayu$Penyinaran_Matahari, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,07. 


```{r}
# Menghitung total produksi untuk setiap tahun
summary_ubikayu <- UbiKayu %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_ubikayu
```

```{r}
# Visulisasi Produksi Ubi Kayu Sepanjang Tahun 2006-2015
ggplot(summary_ubikayu, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Ubi Kayu dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##7. Jagung

```{r}
plot_jagung <- ggplot(Jagung, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Jagung di Sumatera Barat", x = "Tahun", y = "Produksi Jagung (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_jg <- cor(Jagung$Luas_Panen, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_jg)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,91. Hubungan luas panen dan produksi jagung bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi jagung.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_jg <- cor(Jagung$Kecepatan_Angin, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,34. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_jg <- cor(Jagung$Kelembapan, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,007. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_jg <- cor(Jagung$Suhu, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,01. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_jg <- cor(Jagung$Tekanan_Udara, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,11. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_jg <- cor(Jagung$Penyinaran_Matahari, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,02. 


```{r}
# Menghitung total produksi untuk setiap tahun
summary_jagung <- Jagung %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_jagung
```

```{r}
# Visulisasi Produksi Jagung Sepanjang Tahun 2006-2015
ggplot(summary_jagung, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Jagung dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```




# 4. Model
## 1. Padi
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_Padi <- createDataPartition(Padi$Produksi, p = 0.6, list = FALSE)
data_train_Padi <- Padi[splitIndex_Padi, ]  # Data pelatihan (60%)
data_test_Padi <- Padi[-splitIndex_Padi, ]  # Data pengujian (40%)
data_train_Padi
data_test_Padi 
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_Padi <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari, data = data_train_Padi, ntree = 1000)
rf_model_Padi
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_Padi <- predict(rf_model_Padi, data_test_Padi)
predictions_rf_Padi
```

```{r}
# Visualisasi Hasil
result_data_rf_Padi <- data.frame(Produksi = data_test_Padi$Produksi, Predictions = predictions_rf_Padi)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_Padi, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_Padi, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_Padi <- data.frame(Tahun = data_test_Padi$Tahun, Produksi = data_test_Padi$Produksi, Predictions = predictions_rf_Padi)

ggplot(data = result_data_rf2_Padi, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_Padi <- data.frame(Variable = row.names(importance(rf_model_Padi)),
                              Importance = importance(rf_model_Padi)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_Padi <- importance_rf_Padi[order(importance_rf_Padi$Importance, decreasing = TRUE), ]
importance_rf_Padi

# Visualisasi dengan ggplot
ggplot(importance_rf_Padi, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Produktivitas dan Luas Panen.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_Padi <- mae(data_test_Padi$Produksi, predictions_rf_Padi)

# Hitung MSE
mse_value_rf_Padi <- mse(data_test_Padi$Produksi, predictions_rf_Padi)

# Hitung RMSE
rmse_value_rf_Padi <- rmse(data_test_Padi$Produksi, predictions_rf_Padi)

# Hitung MAPE
mape_value_rf_Padi <- mape(data_test_Padi$Produksi, predictions_rf_Padi)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_Padi, "\n"))
cat(paste("MSE: ", mse_value_rf_Padi, "\n"))
cat(paste("RMSE: ", rmse_value_rf_Padi, "\n"))
cat(paste("MAPE: ", mape_value_rf_Padi, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_Padi <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari, data = data_train_Padi, kernel = "radial", cost = 1)
svr_model_Padi
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_Padi <- predict(svr_model_Padi, data_test_Padi)
predictions_svr_Padi
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_Padi <- data.frame(Produksi = data_test_Padi$Produksi, Predictions = predictions_svr_Padi)

ggplot(data = result_data_svr_Padi, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_Padi, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_Padi <- data.frame(Tahun = data_test_Padi$Tahun, Produksi = data_test_Padi$Produksi, Predictions = predictions_svr_Padi)

ggplot(data = result_data_svr2_Padi, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_Padi <- mae(data_test_Padi$Produksi, predictions_svr_Padi)

# Hitung MSE
mse_value_svr_Padi <- mse(data_test_Padi$Produksi, predictions_svr_Padi)

# Hitung RMSE
rmse_value_svr_Padi <- rmse(data_test_Padi$Produksi, predictions_svr_Padi)

# Hitung MAPE
mape_value_svr_Padi <- mape(data_test_Padi$Produksi, predictions_svr_Padi)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_Padi, "\n"))
cat(paste("MSE: ", mse_value_svr_Padi, "\n"))
cat(paste("RMSE: ", rmse_value_svr_Padi, "\n"))
cat(paste("MAPE: ", mape_value_svr_Padi, "%\n"))
```


## 2. Kacang Hijau
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_KacangHijau <- createDataPartition(KacangHijau$Produksi, p = 0.6, list = FALSE)
data_train_KacangHijau <- KacangHijau[splitIndex_KacangHijau, ]  # Data pelatihan (60%)
data_test_KacangHijau <- KacangHijau[-splitIndex_KacangHijau, ]  # Data pengujian (40%)
data_train_KacangHijau
data_test_KacangHijau 
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_KacangHijau <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari, data = data_train_KacangHijau, ntree = 1000)
rf_model_KacangHijau
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_KacangHijau <- predict(rf_model_KacangHijau, data_test_KacangHijau)
predictions_rf_KacangHijau
```

```{r}
# Visualisasi Hasil
result_data_rf_KacangHijau <- data.frame(Produksi = data_test_KacangHijau$Produksi, Predictions = predictions_rf_KacangHijau)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_KacangHijau, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_KacangHijau, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_KacangHijau <- data.frame(Tahun = data_test_KacangHijau$Tahun, Produksi = data_test_KacangHijau$Produksi, Predictions = predictions_rf_KacangHijau)

ggplot(data = result_data_rf2_KacangHijau, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_KacangHijau <- data.frame(Variable = row.names(importance(rf_model_KacangHijau)),
                              Importance = importance(rf_model_KacangHijau)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_KacangHijau <- importance_rf_KacangHijau[order(importance_rf_KacangHijau$Importance, decreasing = TRUE), ]
importance_rf_KacangHijau

# Visualisasi dengan ggplot
ggplot(importance_rf_KacangHijau, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Produktivitas dan Luas Panen.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_KacangHijau <- mae(data_test_KacangHijau$Produksi, predictions_rf_KacangHijau)

# Hitung MSE
mse_value_rf_KacangHijau <- mse(data_test_KacangHijau$Produksi, predictions_rf_KacangHijau)

# Hitung RMSE
rmse_value_rf_KacangHijau <- rmse(data_test_KacangHijau$Produksi, predictions_rf_KacangHijau)

# Hitung MAPE
mape_value_rf_KacangHijau <- mape(data_test_KacangHijau$Produksi, predictions_rf_KacangHijau)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_KacangHijau, "\n"))
cat(paste("MSE: ", mse_value_rf_KacangHijau, "\n"))
cat(paste("RMSE: ", rmse_value_rf_KacangHijau, "\n"))
cat(paste("MAPE: ", mape_value_rf_KacangHijau, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_KacangHijau <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari, data = data_train_KacangHijau, kernel = "radial", cost = 1)
svr_model_KacangHijau
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_KacangHijau <- predict(svr_model_KacangHijau, data_test_KacangHijau)
predictions_svr_KacangHijau
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_KacangHijau <- data.frame(Produksi = data_test_KacangHijau$Produksi, Predictions = predictions_svr_KacangHijau)

ggplot(data = result_data_svr_KacangHijau, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_KacangHijau, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_KacangHijau <- data.frame(Tahun = data_test_KacangHijau$Tahun, Produksi = data_test_KacangHijau$Produksi, Predictions = predictions_svr_KacangHijau)

ggplot(data = result_data_svr2_KacangHijau, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_KacangHijau <- mae(data_test_KacangHijau$Produksi, predictions_svr_KacangHijau)

# Hitung MSE
mse_value_svr_KacangHijau <- mse(data_test_KacangHijau$Produksi, predictions_svr_KacangHijau)

# Hitung RMSE
rmse_value_svr_KacangHijau <- rmse(data_test_KacangHijau$Produksi, predictions_svr_KacangHijau)

# Hitung MAPE
mape_value_svr_KacangHijau <- mape(data_test_KacangHijau$Produksi, predictions_svr_KacangHijau)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_KacangHijau, "\n"))
cat(paste("MSE: ", mse_value_svr_KacangHijau, "\n"))
cat(paste("RMSE: ", rmse_value_svr_KacangHijau, "\n"))
cat(paste("MAPE: ", mape_value_svr_KacangHijau, "%\n"))
```





