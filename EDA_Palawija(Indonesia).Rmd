---
title: "Exploratory Data Analysis (EDA) Palawija - Indonesia"
author: "Nurul Aina Tasya"
date: "2023-10-05"
output:
  html_document:
    df_print: paged
---

# 1. Load Library/Packages
```{r}
# library untuk manipulasi data
library(dplyr)
# library untuk manipulasi data tanggal
library(lubridate)
# library untuk menampilkan hasil statistik deskriptif
library(summarytools)
# library untuk visualisasi data
library (ggplot2)
# library untuk membaca data dari file Excel (.xlsx)
library(readxl)
# library untuk mengakses fungsi dari model Random Forest
library(randomForest)
# library untuk mengaktifkan paket e1071, khususnya model SVR
library(e1071)
# library Untuk metrik evaluasi
library(caret) 
library(Metrics)
```


# 2. Obstain Data

## a.Import Data
```{r}
palawija <- read_excel("dataset/pangan_Indonesia.xlsx")
```

## b.Menampilkan Contoh Data
```{r}
# Menampilkan 6 data teratas
head(palawija)
```
```{r}
# Menampilkan 6 data terbawah
tail(palawija)
```
```{r}
glimpse(palawija)
```

# 3. Scrub Data

## a. Merubah type data
```{r}
# Merubah type data karakter menjadi numeric
palawija$Produksi <- as.numeric(palawija$Produksi)
palawija$Produktivitas <- as.numeric(palawija$Produktivitas)
palawija$Luas_Panen <- as.numeric(palawija$Luas_Panen)
glimpse(palawija)
```
```{r}
# Merubah type Tahun menjadi Date
palawija$Tahun <- make_date(palawija$Tahun)
glimpse(palawija)
```
```{r}
tail(palawija)
```
```{r}
head(palawija)
```

## b. Menghapus Data Kosong
```{r}
# Menampilkan variabel dengan baris kosong
glimpse(palawija)
colSums(is.na(palawija))
```
Jumlah data : 5,474 Record. Dari 6 variabel terhadap 3 buah variabel dengan data NA'S

```{r}
# Menghapus data NA'S
palawija_clean <- na.omit(palawija)
colSums(is.na(palawija_clean))
summary(palawija_clean)
```
Berdasarkan hasil diatas bisa dilihat semua variabel tidak ada lagi data
yang kosong atau NA'
```{r}
glimpse(palawija_clean)
```
Jumlah data setelah dihapus data NA' menjadi 4,647 baris observasi dengan
6 variabel.


# 4. Explore Data Analysis (EDA)
## a.Tampilkan Dataset
```{r}
glimpse(palawija_clean)
```
## b.Menampilkan hasil statistik deskriptif
```{r}
descr(palawija_clean)
```

## c. Filter data jagung, kacang hijau, kacang kedelai, kacang tanah, ubi jalar, dan ubi kayu
### - Filter data jagung
```{r}
Jagung <- filter(palawija_clean, Jenis_Komoditi == "Jagung")
Jagung

```
### - Filter data kacang hijau
```{r}
KacangHijau <- filter(palawija_clean, Jenis_Komoditi == "Kacang Hijau")
KacangHijau
```
### - Filter data kacang kedelai
```{r}
KacangKedelai <- filter(palawija_clean, Jenis_Komoditi == "Kedelai")
KacangKedelai
```
### - Filter data kacang tanah
```{r}
KacangTanah <- filter(palawija_clean, Jenis_Komoditi == "Kacang Tanah")
KacangTanah
```
### - Filter data ubi jalar
```{r}
UbiJalar <- filter(palawija_clean, Jenis_Komoditi == "Ubi Jalar")
UbiJalar

```
### - Filter data ubi kayu
```{r}
UbiKayu <- filter(palawija_clean, Jenis_Komoditi == "Ubi Kayu")
UbiKayu
```

## d. Jumlah Produksi Palawija Per Provinsi
### - Jumlah Produksi Jagung Per Provinsi
```{r}
plot_jagung_1 <- ggplot(Jagung, aes(x = Tahun, y = Produksi, group = Provinsi, color = Provinsi)) +
  geom_line() +
  labs(title = "Jumlah Produksi Jagung", x = "Tahun", y = "Produksi Jagung (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung_1

```

```{r}
# Hitung total produksi per provinsi
totproduksi_jagung <- Jagung %>% 
  #mutate(first_date_month = floor_date(Tahun, unit = "year")) %>% 
  group_by(Provinsi) %>% 
  summarise(JumlahProduksi = sum(Produksi)) %>% 
  arrange(JumlahProduksi)
totproduksi_jagung
```

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Hitung total produksi per provinsi/tahun
totproduksi_jagung <- Jagung %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(TotalProduksi = sum(Produksi))

totproduksi_jagung
```

```{r}
summary(totproduksi_jagung)
```


### - Jumlah Produksi Kacang Hijau Per Provinsi
```{r}
plot_kacanghijau_1 <- ggplot(KacangHijau, aes(x = Tahun, y = Produksi, group = Provinsi, color = Provinsi)) +
  geom_line() +
  labs(title = "Jumlah Produksi Kacang Hijau", x = "Tahun", y = "Produksi Kacang Hijau (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacanghijau_1

```

```{r}
# Hitung total produksi per provinsi
totproduksi_kacanghijau <- KacangHijau %>% 
  #mutate(first_date_month = floor_date(Tahun, unit = "year")) %>% 
  group_by(Provinsi) %>% 
  summarise(JumlahProduksi = sum(Produksi)) %>% 
  arrange(JumlahProduksi)
totproduksi_kacanghijau
```

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Hitung total produksi per provinsi/tahun
totproduksi_kacanghijau <- KacangHijau %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(TotalProduksi = sum(Produksi))

totproduksi_kacanghijau
```

```{r}
summary(totproduksi_kacanghijau)
```



### - Jumlah Produksi Kacang Kedelai Per Provinsi
```{r}
plot_kacangkedelai_1 <- ggplot(KacangKedelai, aes(x = Tahun, y = Produksi, group = Provinsi, color = Provinsi)) +
  geom_line() +
  labs(title = "Jumlah Produksi Kacang Kedelai", x = "Tahun", y = "Produksi Kacang Kedelai (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangkedelai_1

```

```{r}
# Hitung total produksi per provinsi
totproduksi_kacangkedelai <- KacangKedelai %>% 
  #mutate(first_date_month = floor_date(Tahun, unit = "year")) %>% 
  group_by(Provinsi) %>% 
  summarise(JumlahProduksi = sum(Produksi)) %>% 
  arrange(JumlahProduksi)
totproduksi_kacangkedelai
```

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Hitung total produksi per provinsi/tahun
totproduksi_kacangkedelai <- KacangKedelai %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(TotalProduksi = sum(Produksi))

totproduksi_kacangkedelai
```

```{r}
summary(totproduksi_kacangkedelai)
```


### - Jumlah Produksi Kacang Tanah Per Provinsi
```{r}
plot_kacangtanah_1 <- ggplot(KacangTanah, aes(x = Tahun, y = Produksi, group = Provinsi, color = Provinsi)) +
  geom_line() +
  labs(title = "Jumlah Produksi Kacang Tanah", x = "Tahun", y = "Produksi Kacang Tanah (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangtanah_1

```

```{r}
# Hitung total produksi per provinsi
totproduksi_kacangtanah <- KacangTanah %>% 
  #mutate(first_date_month = floor_date(Tahun, unit = "year")) %>% 
  group_by(Provinsi) %>% 
  summarise(JumlahProduksi = sum(Produksi)) %>% 
  arrange(JumlahProduksi)
totproduksi_kacangtanah
```

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Hitung total produksi per provinsi/tahun
totproduksi_kacangtanah <- KacangTanah %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(TotalProduksi = sum(Produksi))

totproduksi_kacangtanah
```

```{r}
summary(totproduksi_kacangtanah)
```


### - Jumlah Produksi Ubi Jalar Per Provinsi
```{r}
plot_ubijalar_1 <- ggplot(UbiJalar, aes(x = Tahun, y = Produksi, group = Provinsi, color = Provinsi)) +
  geom_line() +
  labs(title = "Jumlah Produksi Ubi Jalar", x = "Tahun", y = "Produksi Ubi Jalar (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubijalar_1

```

```{r}
# Hitung total produksi per provinsi
totproduksi_ubijalar <- UbiJalar %>% 
  #mutate(first_date_month = floor_date(Tahun, unit = "year")) %>% 
  group_by(Provinsi) %>% 
  summarise(JumlahProduksi = sum(Produksi)) %>% 
  arrange(JumlahProduksi)
totproduksi_ubijalar
```

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Hitung total produksi per provinsi/tahun
totproduksi_ubijalar <- UbiJalar %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(TotalProduksi = sum(Produksi))

totproduksi_ubijalar
```

```{r}
summary(totproduksi_ubijalar)
```


### - Jumlah Produksi Ubi Kayu Per Provinsi
```{r}
plot_ubikayu_1 <- ggplot(UbiKayu, aes(x = Tahun, y = Produksi, group = Provinsi, color = Provinsi)) +
  geom_line() +
  labs(title = "Jumlah Produksi Ubi Kayu", x = "Tahun", y = "Produksi Ubi Kayu (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubikayu_1

```

```{r}
# Hitung total produksi per provinsi
totproduksi_ubikayu <- UbiKayu %>% 
  #mutate(first_date_month = floor_date(Tahun, unit = "year")) %>% 
  group_by(Provinsi) %>% 
  summarise(JumlahProduksi = sum(Produksi)) %>% 
  arrange(JumlahProduksi)
totproduksi_ubikayu
```

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Hitung total produksi per provinsi/tahun
totproduksi_ubikayu <- UbiKayu %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(TotalProduksi = sum(Produksi))

totproduksi_ubikayu
```

```{r}
summary(totproduksi_ubikayu)
```



## e. Tren Produksi Palawija Per Provinsi
### - Tren Produksi Jagung Per Provinsi
```{r}
# Visualisasi Tren Produksi Jagung
plot_jagung_2 <- ggplot(totproduksi_jagung, aes(x = Tahun, y = TotalProduksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Jagung", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung_2
```
### - Tren Produksi Kacang Hijau Per Provinsi
```{r}
# Visualisasi Tren Produksi Kacang Hijau
plot_kacanghijau_2 <- ggplot(totproduksi_kacanghijau, aes(x = Tahun, y = TotalProduksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Kacang Hijau", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacanghijau_2
```

### - Tren Produksi Kacang Kedelai Per Provinsi
```{r}
# Visualisasi Tren Produksi Kacang Kedelai
plot_kacangkedelai_2 <- ggplot(totproduksi_kacangkedelai, aes(x = Tahun, y = TotalProduksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Kacang Kedelai", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangkedelai_2
```

### - Tren Produksi Kacang Tanah Per Provinsi
```{r}
# Visualisasi Tren Produksi Kacang Tanah
plot_kacangtanah_2 <- ggplot(totproduksi_kacangtanah, aes(x = Tahun, y = TotalProduksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Kacang Tanah", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangtanah_2
```

### - Tren Produksi Ubi Jalar Per Provinsi
```{r}
# Visualisasi Tren Produksi Ubi Jalar
plot_ubijalar_2 <- ggplot(totproduksi_ubijalar, aes(x = Tahun, y = TotalProduksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Ubi Jalar", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubijalar_2
```

### - Tren Produksi Ubi Kayu Per Provinsi
```{r}
# Visualisasi Tren Produksi Ubi Kayu
plot_ubikayu_2 <- ggplot(totproduksi_ubikayu, aes(x = Tahun, y = TotalProduksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Ubi Kayu", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubikayu_2
```



## f. Perbandingan Produksi Palawija Per Provinsi
### - Perbandingan Produksi Jagung Per Provinsi
```{r}
# Hitung total produksi Jagung per Provinsi
totproduksi_jagung_provinsi <- Jagung %>% 
  group_by(Provinsi) %>% 
  summarise(TotalProduksi = sum(Produksi))
totproduksi_jagung_provinsi

# Visualisasi dengan barplot
plot_jagung_3 <- ggplot(totproduksi_jagung_provinsi, aes(x = Provinsi, y = TotalProduksi, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Jagung antara Provinsi", x = "Provinsi", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_jagung_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Jagung dalam kurun waktu 1993 - 2015 adalah dari provinsi Jawa Timur yang terbanyak dengan Jumlah Produksi Jagung sebesar 98164357 Ton.


### - Perbandingan Produksi Kacang Hijau Per Provinsi
```{r}
# Hitung total produksi Kacang Hijau per Provinsi
totproduksi_kacanghijau_provinsi <- KacangHijau %>% 
  group_by(Provinsi) %>% 
  summarise(TotalProduksi = sum(Produksi))
totproduksi_kacanghijau_provinsi

# Visualisasi dengan barplot
plot_kacanghijau_3 <- ggplot(totproduksi_kacanghijau_provinsi, aes(x = Provinsi, y = TotalProduksi, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Kacang Hijau antara Provinsi", x = "Provinsi", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_kacanghijau_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Kacang Hijau dalam kurun waktu 1993 - 2015 adalah dari provinsi Jawa Tengah yang terbanyak dengan Jumlah Produksi Kacang Hijau sebesar 1549775 Ton.


### - Perbandingan Produksi Kacang Kedelai Per Provinsi
```{r}
# Hitung total produksi Kacang Kedelai per Provinsi
totproduksi_kacangkedelai_provinsi <- KacangKedelai %>% 
  group_by(Provinsi) %>% 
  summarise(TotalProduksi = sum(Produksi))
totproduksi_kacangkedelai_provinsi

# Visualisasi dengan barplot
plot_kacangkedelai_3 <- ggplot(totproduksi_kacangkedelai_provinsi, aes(x = Provinsi, y = TotalProduksi, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Kacang Kedelai antara Provinsi", x = "Provinsi", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_kacangkedelai_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Kacang Kedelai dalam kurun waktu 1993 - 2015 adalah dari provinsi Jawa Timur yang terbanyak dengan Jumlah Produksi Kacang Kedelai sebesar 8773308 Ton.


### - Perbandingan Produksi Kacang Tanah Per Provinsi
```{r}
# Hitung total produksi Kacang Tanah per Provinsi
totproduksi_kacangtanah_provinsi <- KacangTanah %>% 
  group_by(Provinsi) %>% 
  summarise(TotalProduksi = sum(Produksi))
totproduksi_kacangtanah_provinsi

# Visualisasi dengan barplot
plot_kacangtanah_3 <- ggplot(totproduksi_kacangtanah_provinsi, aes(x = Provinsi, y = TotalProduksi, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Kacang Tanah antara Provinsi", x = "Provinsi", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_kacangtanah_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Kacang Tanah dalam kurun waktu 1993 - 2015 adalah dari provinsi Jawa Timur yang terbanyak dengan Jumlah Produksi Kacang Tanah sebesar 4295694 Ton.


### - Perbandingan Produksi Ubi Jalar Per Provinsi
```{r}
# Hitung total produksi Ubi Jalar per Provinsi
totproduksi_ubijalar_provinsi <- UbiJalar %>% 
  group_by(Provinsi) %>% 
  summarise(TotalProduksi = sum(Produksi))
totproduksi_ubijalar_provinsi

# Visualisasi dengan barplot
plot_ubijalar_3 <- ggplot(totproduksi_ubijalar_provinsi, aes(x = Provinsi, y = TotalProduksi, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Ubi Jalar antara Provinsi", x = "Provinsi", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_ubijalar_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Ubi Jalar dalam kurun waktu 1993 - 2015 adalah dari provinsi Jawa Barat yang terbanyak dengan Jumlah Produksi Ubi Jalar sebesar 9548484.00 Ton.


### - Perbandingan Produksi Ubi Kayu Per Provinsi
```{r}
# Hitung total produksi Ubi Kayu per Provinsi
totproduksi_ubikayu_provinsi <- UbiKayu %>% 
  group_by(Provinsi) %>% 
  summarise(TotalProduksi = sum(Produksi))
totproduksi_ubikayu_provinsi

# Visualisasi dengan barplot
plot_ubikayu_3 <- ggplot(totproduksi_ubikayu_provinsi, aes(x = Provinsi, y = TotalProduksi, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Ubi Kayu antara Provinsi", x = "Provinsi", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_ubikayu_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Ubi Kayu dalam kurun waktu 1993 - 2015 adalah dari provinsi Lampung yang terbanyak dengan Jumlah Produksi Ubi Kayu sebesar 118343702 Ton.



## g. Perbandingan Produktivitas Palawija Per Provinsi
### - Perbandingan Produktivitas Jagung Per Provinsi
```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren produktivitas jagung
produktivitas_jagung <- Jagung %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(Produktivitas = sum(Produktivitas))
produktivitas_jagung
```

```{r}

# Hitung total produktivitas Jagung per provinsi
totproduktivitas_jagung_provinsi <- Jagung %>% 
  group_by(Provinsi) %>% 
  summarise(Total_Produktivitas = sum(Produktivitas))

# Visualisasi dengan barplot
plot_jagung_4 <- ggplot(totproduktivitas_jagung_provinsi, aes(x = Provinsi, y = Total_Produktivitas, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produktivitas Jagung antar Provinsi", x = "Provinsi", y = "Produktivitas (Kuintal/Hektar)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_jagung_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))


```


### - Perbandingan Produktivitas Kacang Hijau Per Provinsi
```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren produktivitas Kacang Hijau
produktivitas_kacanghijau <- KacangHijau %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(Produktivitas = sum(Produktivitas))
produktivitas_kacanghijau
```

```{r}

# Hitung total produktivitas Kacang Hijau per provinsi
totproduktivitas_kacanghijau_provinsi <- KacangHijau %>% 
  group_by(Provinsi) %>% 
  summarise(Total_Produktivitas = sum(Produktivitas))

# Visualisasi dengan barplot
plot_kacanghijau_4 <- ggplot(totproduktivitas_kacanghijau_provinsi, aes(x = Provinsi, y = Total_Produktivitas, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produktivitas Kacang Hijau antar Provinsi", x = "Provinsi", y = "Produktivitas (Kuintal/Hektar)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_kacanghijau_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))


```


### - Perbandingan Produktivitas Kacang Kedelai Per Provinsi
```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren produktivitas Kacang Kedelai
produktivitas_kacangkedelai <- KacangKedelai %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(Produktivitas = sum(Produktivitas))
produktivitas_kacangkedelai
```

```{r}

# Hitung total produktivitas Kacang Kedelai per provinsi
totproduktivitas_kacangkedelai_provinsi <- KacangKedelai %>% 
  group_by(Provinsi) %>% 
  summarise(Total_Produktivitas = sum(Produktivitas))

# Visualisasi dengan barplot
plot_kacangkedelai_4 <- ggplot(totproduktivitas_kacangkedelai_provinsi, aes(x = Provinsi, y = Total_Produktivitas, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produktivitas Kacang Kedelai antar Provinsi", x = "Provinsi", y = "Produktivitas (Kuintal/Hektar)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_kacangkedelai_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))


```


### - Perbandingan Produktivitas Kacang Tanah Per Provinsi
```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren produktivitas Kacang Tanah
produktivitas_kacangtanah <- KacangTanah %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(Produktivitas = sum(Produktivitas))
produktivitas_kacangtanah
```

```{r}

# Hitung total produktivitas Kacang Tanah per provinsi
totproduktivitas_kacangtanah_provinsi <- KacangTanah %>% 
  group_by(Provinsi) %>% 
  summarise(Total_Produktivitas = sum(Produktivitas))

# Visualisasi dengan barplot
plot_kacangtanah_4 <- ggplot(totproduktivitas_kacangtanah_provinsi, aes(x = Provinsi, y = Total_Produktivitas, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produktivitas Kacang Tanah antar Provinsi", x = "Provinsi", y = "Produktivitas (Kuintal/Hektar)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_kacangtanah_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))


```


### - Perbandingan Produktivitas Ubi Jalar Per Provinsi
```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren produktivitas Ubi Jalar
produktivitas_ubijalar <- UbiJalar %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(Produktivitas = sum(Produktivitas))
produktivitas_ubijalar
```

```{r}

# Hitung total produkstivitas Ubi Jalar per provinsi
totproduktivitas_ubijalar_provinsi <- UbiJalar %>% 
  group_by(Provinsi) %>% 
  summarise(Total_Produktivitas = sum(Produktivitas))

# Visualisasi dengan barplot
plot_ubijalar_4 <- ggplot(totproduktivitas_ubijalar_provinsi, aes(x = Provinsi, y = Total_Produktivitas, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produktivitas Ubi Jalar antar Provinsi", x = "Provinsi", y = "Produktivitas (Kuintal/Hektar)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_ubijalar_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))


```


### - Perbandingan Produktivitas Ubi Kayu Per Provinsi
```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren produktivitas Ubi Kayu
produktivitas_ubikayu <- UbiKayu %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(Produktivitas = sum(Produktivitas))
produktivitas_ubikayu
```

```{r}

# Hitung total produkstivitas Ubi Kayu per provinsi
totproduktivitas_ubikayu_provinsi <- UbiKayu %>% 
  group_by(Provinsi) %>% 
  summarise(Total_Produktivitas = sum(Produktivitas))

# Visualisasi dengan barplot
plot_ubikayu_4 <- ggplot(totproduktivitas_ubikayu_provinsi, aes(x = Provinsi, y = Total_Produktivitas, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produktivitas Ubi Kayu antar Provinsi", x = "Provinsi", y = "Produktivitas (Kuintal/Hektar)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_ubikayu_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))


```



## h. Korelasi Luas Panen dan Produksi Palawija
### - Korelasi Luas Panen dan Produksi Jagung
```{r}
# Visualisasi korelasi luas panen dan produksi Jagung
plot_jagung_5 <- ggplot(Jagung, aes(x = Luas_Panen, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_jagung <- cor(Jagung$Luas_Panen, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_jagung)
```

Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0,95; sehingga bisa disimpulkan bahwa jika semakin banyak luas panen maka akan meningkat jumlah produksi jagung.

### - Korelasi Luas Panen dan Produksi Kacang Hijau
```{r}
# Visualisasi korelasi luas panen dan produksi Kacang Hijau
plot_kacanghijau_5 <- ggplot(KacangHijau, aes(x = Luas_Panen, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacanghijau_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_kacanghijau <- cor(KacangHijau$Luas_Panen, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_kacanghijau)
```

Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0,96; sehingga bisa disimpulkan bahwa jika semakin banyak luas panen maka akan meningkat jumlah produksi kacang hijau.


### - Korelasi Luas Panen dan Produksi Kacang Kedelai
```{r}
# Visualisasi korelasi luas panen dan produksi Kacang Kedelai
plot_kacangkedelai_5 <- ggplot(KacangKedelai, aes(x = Luas_Panen, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangkedelai_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_kacangkedelai <- cor(KacangKedelai$Luas_Panen, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_kacangkedelai)
```

Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0,99; sehingga bisa disimpulkan bahwa jika semakin banyak luas panen maka akan meningkat jumlah produksi kacang kedelai.


### - Korelasi Luas Panen dan Produksi Kacang Tanah
```{r}
# Visualisasi korelasi luas panen dan produksi Kacang Tanah
plot_kacangtanah_5 <- ggplot(KacangTanah, aes(x = Luas_Panen, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangtanah_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_kacangtanah <- cor(KacangTanah$Luas_Panen, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_kacangtanah)
```

Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0,99; sehingga bisa disimpulkan bahwa jika semakin banyak luas panen maka akan meningkat jumlah produksi kacang tanah.


### - Korelasi Luas Panen dan Produksi Ubi Jalar
```{r}
# Visualisasi korelasi luas panen dan produksi Ubi Jalar
plot_ubijalar_5 <- ggplot(UbiJalar, aes(x = Luas_Panen, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubijalar_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_ubijalar <- cor(UbiJalar$Luas_Panen, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_ubijalar)
```
Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0,89; sehingga bisa disimpulkan bahwa jika semakin banyak luas panen maka akan meningkat jumlah produksi ubi jalar.


### - Korelasi Luas Panen dan Produksi Ubi Kayu
```{r}
# Visualisasi korelasi luas panen dan produksi Ubi Kayu
plot_ubikayu_5 <- ggplot(UbiKayu, aes(x = Luas_Panen, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubikayu_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_kacangubikayu <- cor(UbiKayu$Luas_Panen, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_kacangubikayu)
```
Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0,94; sehingga bisa disimpulkan bahwa jika semakin banyak luas panen maka akan meningkat jumlah produksi ubi kayu.



## i. Perbandingan Produktivitas dengan Produksi Palawija 
### - Perbandingan Produktivitas dengan Produksi Jagung 
```{r}
# Create a boxplot using ggplot2
plot_jagung_6 <- ggplot(Jagung, aes(x = Provinsi, y = Produksi - Produktivitas, fill = Provinsi)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Produktivitas Jagung per Provinsi", x = "Provinsi", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_jagung_6 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### - Perbandingan Produktivitas dengan Produksi Kacang Hijau
```{r}
# Create a boxplot using ggplot2
plot_kacanghijau_6 <- ggplot(KacangHijau, aes(x = Provinsi, y = Produksi - Produktivitas, fill = Provinsi)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Produktivitas Kacang Hijau per Provinsi", x = "Provinsi", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_kacanghijau_6 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### - Perbandingan Produktivitas dengan Produksi Kacang Kedelai 
```{r}
# Create a boxplot using ggplot2
plot_kacangkedelai_6 <- ggplot(KacangKedelai, aes(x = Provinsi, y = Produksi - Produktivitas, fill = Provinsi)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Produktivitas Kacang Kedelai per Provinsi", x = "Provinsi", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_kacangkedelai_6 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### - Perbandingan Produktivitas dengan Produksi Kacang Tanah 
```{r}
# Create a boxplot using ggplot2
plot_kacangtanah_6 <- ggplot(KacangTanah, aes(x = Provinsi, y = Produksi - Produktivitas, fill = Provinsi)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Produktivitas Kacang Tanah per Provinsi", x = "Provinsi", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_kacangtanah_6 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### - Perbandingan Produktivitas dengan Produksi Ubi Jalar 
```{r}
# Create a boxplot using ggplot2
plot_ubijalar_6 <- ggplot(UbiJalar, aes(x = Provinsi, y = Produksi - Produktivitas, fill = Provinsi)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Produktivitas Ubi Jalar per Provinsi", x = "Provinsi", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_ubijalar_6 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

### - Perbandingan Produktivitas dengan Produksi Ubi Kayu
```{r}
# Create a boxplot using ggplot2
plot_ubikayu_6 <- ggplot(UbiKayu, aes(x = Provinsi, y = Produksi - Produktivitas, fill = Provinsi)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Produktivitas Ubi Kayu per Provinsi", x = "Provinsi", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_ubikayu_6 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


# 5. Prediksi Produksi Palawija dengan ML

## 1. Jagung
```{r}
# Menghitung total produksi untuk setiap tahun
summary_data_jagung <- Jagung %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_data_jagung
```

```{r}
# Membuat bar chart atau line chart
ggplot(summary_data_jagung, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Jagung dari 1993 - 2015",
       x = "Tahun",
       y = "Total Produksi")
```


```{r}
data_jagung <- summary_data_jagung %>% 
  rename(
    Tahun = "Tahun",
    Produksi_Jagung = "TotalProduksi"
  )
data_jagung

```


```{r}
# Membagi data menjadi data pelatihan dan pengujian - Jagung
set.seed(123) #menentukan nilai acak dari data
jagung_sample_indices <- sample(nrow(data_jagung), nrow(data_jagung) * 0.7)
jagung_training_data <- data_jagung[jagung_sample_indices, ]
jagung_testing_data <- data_jagung[-jagung_sample_indices, ]
jagung_training_data
jagung_testing_data
```
### a. Model Random Forest
#### - Membangun model
```{r}
# Membangun model Random Forest
rf_model_jagung <- randomForest(Produksi_Jagung ~., data = jagung_training_data, ntree = 500)
rf_model_jagung
```
#### - Melakukan prediksi
```{r}
# Melakukan prediksi jangka pendek
jagung_predictions <- predict(rf_model_jagung, newdata = jagung_testing_data)
jagung_predictions
plot(jagung_predictions)

```
```{r}
# Melakukan prediksi jangka panjang (10 tahun)
jagung_future_years <- seq(max(data_jagung$Tahun) + 1, max(data_jagung$Tahun) + 10, by = "years")
future_data_jagung <- data.frame(Tahun = jagung_future_years) 

future_predictions_jagung <- predict(rf_model_jagung, future_data_jagung)
future_predictions_jagung
```
#### - Evaluasi Model
```{r}
# 1. Evaluasi model dalam  melakukan prediksi jangka pendek
# Hitung MAE (Mean Absolute Error)
mae_jagung_jangkapendek <- mean(abs(jagung_testing_data$Produksi_Jagung - jagung_predictions))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_jagung_jangkapendek <- mean(abs((jagung_testing_data$Produksi_Jagung - jagung_predictions) / jagung_testing_data$Produksi_Jagung) * 100)

# Hitung MSE (Mean Squared Error)
mse_jagung_jangkapendek <- mean((jagung_testing_data$Produksi_Jagung - jagung_predictions)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_jagung_jangkapendek <- sqrt(mse_jagung_jangkapendek)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_jagung_jangkapendek, "\n")
cat("MAPE:", mape_jagung_jangkapendek, "%\n")
cat("MSE:", mse_jagung_jangkapendek, "\n")
cat("RMSE:", rmse_jagung_jangkapendek, "\n")

```
```{r}
# 2. Evaluasi model dalam  melakukan prediksi jangka panjang
# Hitung MAE (Mean Absolute Error)
mae_jagung_jangkapanjang <- mean(abs(jagung_testing_data$Produksi_Jagung - future_predictions_jagung))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_jagung_jangkapanjang <- mean(abs((jagung_testing_data$Produksi_Jagung - future_predictions_jagung) / jagung_testing_data$Produksi_Jagung) * 100)

# Hitung MSE (Mean Squared Error)
mse_jagung_jangkapanjang <- mean((jagung_testing_data$Produksi_Jagung - future_predictions_jagung)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_jagung_jangkapanjang <- sqrt(mse_jagung_jangkapanjang)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_jagung_jangkapanjang, "\n")
cat("MAPE:", mape_jagung_jangkapanjang, "%\n")
cat("MSE:", mse_jagung_jangkapanjang, "\n")
cat("RMSE:", rmse_jagung_jangkapanjang, "\n")

```





## 2. Kacang Hijau
```{r}
# Menghitung total produksi untuk setiap tahun
summary_data_kacanghijau <- KacangHijau %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_data_kacanghijau
```

```{r}
# Membuat bar chart atau line chart
ggplot(summary_data_kacanghijau, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Hijau dari 1993 - 2015",
       x = "Tahun",
       y = "Total Produksi")
```


```{r}
data_kacanghijau <- summary_data_kacanghijau %>% 
  rename(
    Tahun = "Tahun",
    Produksi_Kacanghijau = "TotalProduksi"
  )
data_kacanghijau

```


```{r}
# Membagi data menjadi data pelatihan dan pengujian - kacang hijau
set.seed(123) #menentukan nilai acak dari data
kacanghijau_sample_indices <- sample(nrow(data_kacanghijau), nrow(data_kacanghijau) * 0.7)
kacanghijau_training_data <- data_kacanghijau[kacanghijau_sample_indices, ]
kacanghijau_testing_data <- data_kacanghijau[-kacanghijau_sample_indices, ]
kacanghijau_training_data
kacanghijau_testing_data
```

### a. Model Random Forest
#### - Membangun model
```{r}
# Membangun model Random Forest
rf_model_kacanghijau <- randomForest(Produksi_Kacanghijau ~., data = kacanghijau_training_data, ntree = 500)
rf_model_kacanghijau
```
#### - Melakukan prediksi
```{r}
# Melakukan prediksi jangka pendek
kacanghijau_predictions <- predict(rf_model_kacanghijau, newdata = kacanghijau_testing_data)
kacanghijau_predictions
plot(kacanghijau_predictions)

```
```{r}
# Melakukan prediksi jangka panjang (10 tahun)
kacanghijau_future_years <- seq(max(data_kacanghijau$Tahun) + 1, max(data_kacanghijau$Tahun) + 10, by = "years")
future_data_kacanghijau <- data.frame(Tahun = kacanghijau_future_years) 

future_predictions_kacanghijau <- predict(rf_model_kacanghijau, future_data_kacanghijau)
future_predictions_kacanghijau
```
#### - Evaluasi Model
```{r}
# 1. Evaluasi model dalam  melakukan prediksi jangka pendek
# Hitung MAE (Mean Absolute Error)
mae_kacanghijau_jangkapendek <- mean(abs(kacanghijau_testing_data$Produksi_Kacanghijau - kacanghijau_predictions))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_kacanghijau_jangkapendek <- mean(abs((kacanghijau_testing_data$Produksi_Kacanghijau - kacanghijau_predictions) / kacanghijau_testing_data$Produksi_Kacanghijau) * 100)

# Hitung MSE (Mean Squared Error)
mse_kacanghijau_jangkapendek <- mean((kacanghijau_testing_data$Produksi_Kacanghijau - kacanghijau_predictions)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_kacanghijau_jangkapendek <- sqrt(mse_kacanghijau_jangkapendek)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_kacanghijau_jangkapendek, "\n")
cat("MAPE:", mape_kacanghijau_jangkapendek, "%\n")
cat("MSE:", mse_kacanghijau_jangkapendek, "\n")
cat("RMSE:", rmse_kacanghijau_jangkapendek, "\n")

```
```{r}
# 2. Evaluasi model dalam  melakukan prediksi jangka panjang
# Hitung MAE (Mean Absolute Error)
mae_kacanghijau_jangkapanjang <- mean(abs(kacanghijau_testing_data$Produksi_Kacanghijau - future_predictions_kacanghijau))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_kacanghijau_jangkapanjang <- mean(abs((kacanghijau_testing_data$Produksi_Kacanghijau - future_predictions_kacanghijau) / kacanghijau_testing_data$Produksi_Kacanghijau) * 100)

# Hitung MSE (Mean Squared Error)
mse_kacanghijau_jangkapanjang <- mean((kacanghijau_testing_data$Produksi_Kacanghijau - future_predictions_kacanghijau)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_kacanghijau_jangkapanjang <- sqrt(mse_kacanghijau_jangkapanjang)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_kacanghijau_jangkapanjang, "\n")
cat("MAPE:", mape_kacanghijau_jangkapanjang, "%\n")
cat("MSE:", mse_kacanghijau_jangkapanjang, "\n")
cat("RMSE:", rmse_kacanghijau_jangkapanjang, "\n")

```


## 3. Kacang Kedelai
```{r}
# Menghitung total produksi untuk setiap tahun
summary_data_kacangkedelai <- KacangKedelai %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_data_kacangkedelai
```

```{r}
# Membuat bar chart atau line chart
ggplot(summary_data_kacangkedelai, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Kedelai dari 1993 - 2015",
       x = "Tahun",
       y = "Total Produksi")
```


```{r}
data_kacangkedelai <- summary_data_kacangkedelai %>% 
  rename(
    Tahun = "Tahun",
    Produksi_Kacangkedelai = "TotalProduksi"
  )
data_kacangkedelai

```


```{r}
# Membagi data menjadi data pelatihan dan pengujian - Kacang Kedelai
set.seed(123) #menentukan nilai acak dari data
kacangkedelai_sample_indices <- sample(nrow(data_kacangkedelai), nrow(data_kacangkedelai) * 0.7)
kacangkedelai_training_data <- data_kacangkedelai[kacangkedelai_sample_indices, ]
kacangkedelai_testing_data <- data_kacangkedelai[-kacangkedelai_sample_indices, ]
kacangkedelai_training_data
kacangkedelai_testing_data
```
### a. Model Random Forest
#### - Membangun model
```{r}
# Membangun model Random Forest
rf_model_kacangkedelai <- randomForest(Produksi_Kacangkedelai ~., data = kacangkedelai_training_data, ntree = 500)
rf_model_kacangkedelai
```
#### - Melakukan prediksi
```{r}
# Melakukan prediksi jangka pendek
kacangkedelai_predictions <- predict(rf_model_kacangkedelai, newdata = kacangkedelai_testing_data)
kacangkedelai_predictions
plot(kacangkedelai_predictions)

```
```{r}
# Melakukan prediksi jangka panjang (10 tahun)
kacangkedelai_future_years <- seq(max(data_kacangkedelai$Tahun) + 1, max(data_kacangkedelai$Tahun) + 10, by = "years")
future_data_kacangkedelai <- data.frame(Tahun = kacangkedelai_future_years) 

future_predictions_kacangkedelai <- predict(rf_model_kacangkedelai, future_data_kacangkedelai)
future_predictions_kacangkedelai
```
#### - Evaluasi Model
```{r}
# 1. Evaluasi model dalam  melakukan prediksi jangka pendek
# Hitung MAE (Mean Absolute Error)
mae_kacangkedelai_jangkapendek <- mean(abs(kacangkedelai_testing_data$Produksi_Kacangkedelai - kacangkedelai_predictions))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_kacangkedelai_jangkapendek <- mean(abs((kacangkedelai_testing_data$Produksi_Kacangkedelai - kacangkedelai_predictions) / kacangkedelai_testing_data$Produksi_Kacangkedelai) * 100)

# Hitung MSE (Mean Squared Error)
mse_kacangkedelai_jangkapendek <- mean((kacangkedelai_testing_data$Produksi_Kacangkedelai - kacangkedelai_predictions)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_kacangkedelai_jangkapendek <- sqrt(mse_kacangkedelai_jangkapendek)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_kacangkedelai_jangkapendek, "\n")
cat("MAPE:", mape_kacangkedelai_jangkapendek, "%\n")
cat("MSE:", mse_kacangkedelai_jangkapendek, "\n")
cat("RMSE:", rmse_kacangkedelai_jangkapendek, "\n")

```
```{r}
# 2. Evaluasi model dalam  melakukan prediksi jangka panjang
# Hitung MAE (Mean Absolute Error)
mae_kacangkedelai_jangkapanjang <- mean(abs(kacangkedelai_testing_data$Produksi_Kacangkedelai - future_predictions_kacangkedelai))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_kacangkedelai_jangkapanjang <- mean(abs((kacangkedelai_testing_data$Produksi_Kacangkedelai - future_predictions_kacangkedelai) / kacangkedelai_testing_data$Produksi_Kacangkedelai) * 100)

# Hitung MSE (Mean Squared Error)
mse_kacangkedelai_jangkapanjang <- mean((kacangkedelai_testing_data$Produksi_Kacangkedelai - future_predictions_kacangkedelai)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_kacangkedelai_jangkapanjang <- sqrt(mse_kacangkedelai_jangkapanjang)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_kacangkedelai_jangkapanjang, "\n")
cat("MAPE:", mape_kacangkedelai_jangkapanjang, "%\n")
cat("MSE:", mse_kacangkedelai_jangkapanjang, "\n")
cat("RMSE:", rmse_kacangkedelai_jangkapanjang, "\n")

```


## 4. Kacang Tanah
```{r}
# Menghitung total produksi untuk setiap tahun
summary_data_kacangtanah <- KacangTanah %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_data_kacangtanah
```

```{r}
# Membuat bar chart atau line chart
ggplot(summary_data_kacangtanah, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Tanah dari 1993 - 2015",
       x = "Tahun",
       y = "Total Produksi")
```


```{r}
data_kacangtanah <- summary_data_kacangtanah %>% 
  rename(
    Tahun = "Tahun",
    Produksi_Kacangtanah = "TotalProduksi"
  )
data_kacangtanah

```


```{r}
# Membagi data menjadi data pelatihan dan pengujian - Kacang Tanah
set.seed(123) #menentukan nilai acak dari data
kacangtanah_sample_indices <- sample(nrow(data_kacangtanah), nrow(data_kacangtanah) * 0.7)
kacangtanah_training_data <- data_kacangtanah[kacangtanah_sample_indices, ]
kacangtanah_testing_data <- data_kacangtanah[-kacangtanah_sample_indices, ]
kacangtanah_training_data
kacangtanah_testing_data
```
### a. Model Random Forest
#### - Membangun model
```{r}
# Membangun model Random Forest
rf_model_kacangtanah <- randomForest(Produksi_Kacangtanah ~., data = kacangtanah_training_data, ntree = 500)
rf_model_kacangtanah
```
#### - Melakukan prediksi
```{r}
# Melakukan prediksi jangka pendek
kacangtanah_predictions <- predict(rf_model_kacangtanah, newdata = kacangtanah_testing_data)
kacangtanah_predictions
plot(kacangtanah_predictions)

```
```{r}
# Melakukan prediksi jangka panjang (10 tahun)
kacangtanah_future_years <- seq(max(data_kacangtanah$Tahun) + 1, max(data_kacangtanah$Tahun) + 10, by = "years")
future_data_kacangtanah <- data.frame(Tahun = kacangtanah_future_years) 

future_predictions_kacangtanah <- predict(rf_model_kacangtanah, future_data_kacangtanah)
future_predictions_kacangtanah
```
#### - Evaluasi Model
```{r}
# 1. Evaluasi model dalam  melakukan prediksi jangka pendek
# Hitung MAE (Mean Absolute Error)
mae_kacangtanah_jangkapendek <- mean(abs(kacangtanah_testing_data$Produksi_Kacangtanah - kacangtanah_predictions))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_kacangtanah_jangkapendek <- mean(abs((kacangtanah_testing_data$Produksi_Kacangtanah - kacangtanah_predictions) / kacangtanah_testing_data$Produksi_Kacangtanah) * 100)

# Hitung MSE (Mean Squared Error)
mse_kacangtanah_jangkapendek <- mean((kacangtanah_testing_data$Produksi_Kacangtanah - kacangtanah_predictions)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_kacangtanah_jangkapendek <- sqrt(mse_kacangtanah_jangkapendek)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_kacangtanah_jangkapendek, "\n")
cat("MAPE:", mape_kacangtanah_jangkapendek, "%\n")
cat("MSE:", mse_kacangtanah_jangkapendek, "\n")
cat("RMSE:", rmse_kacangtanah_jangkapendek, "\n")

```
```{r}
# 2. Evaluasi model dalam  melakukan prediksi jangka panjang
# Hitung MAE (Mean Absolute Error)
mae_kacangtanah_jangkapanjang <- mean(abs(kacangtanah_testing_data$Produksi_Kacangtanah - future_predictions_kacangtanah))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_kacangtanah_jangkapanjang <- mean(abs((kacangtanah_testing_data$Produksi_Kacangtanah - future_predictions_kacangtanah) / kacangtanah_testing_data$Produksi_Kacangtanah) * 100)

# Hitung MSE (Mean Squared Error)
mse_kacangtanah_jangkapanjang <- mean((kacangtanah_testing_data$Produksi_Kacangtanah - future_predictions_kacangtanah)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_kacangtanah_jangkapanjang <- sqrt(mse_kacangtanah_jangkapanjang)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_kacangtanah_jangkapanjang, "\n")
cat("MAPE:", mape_kacangtanah_jangkapanjang, "%\n")
cat("MSE:", mse_kacangtanah_jangkapanjang, "\n")
cat("RMSE:", rmse_kacangtanah_jangkapanjang, "\n")

```



## 5. Ubi Jalar
```{r}
# Menghitung total produksi untuk setiap tahun
summary_data_ubijalar <- UbiJalar %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_data_ubijalar
```

```{r}
# Membuat bar chart atau line chart
ggplot(summary_data_ubijalar, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Ubi Jalar dari 1993 - 2015",
       x = "Tahun",
       y = "Total Produksi")
```


```{r}
data_ubijalar <- summary_data_ubijalar %>% 
  rename(
    Tahun = "Tahun",
    Produksi_Ubijalar = "TotalProduksi"
  )
data_ubijalar

```


```{r}
# Membagi data menjadi data pelatihan dan pengujian - Ubi Jalar
set.seed(123) #menentukan nilai acak dari data
ubijalar_sample_indices <- sample(nrow(data_ubijalar), nrow(data_ubijalar) * 0.7)
ubijalar_training_data <- data_ubijalar[ubijalar_sample_indices, ]
ubijalar_testing_data <- data_ubijalar[-ubijalar_sample_indices, ]
ubijalar_training_data
ubijalar_testing_data
```
### a. Model Random Forest
#### - Membangun model
```{r}
# Membangun model Random Forest
rf_model_ubijalar <- randomForest(Produksi_Ubijalar ~., data = ubijalar_training_data, ntree = 500)
rf_model_ubijalar
```
#### - Melakukan prediksi
```{r}
# Melakukan prediksi jangka pendek
ubijalar_predictions <- predict(rf_model_ubijalar, newdata = ubijalar_testing_data)
ubijalar_predictions
plot(ubijalar_predictions)

```
```{r}
# Melakukan prediksi jangka panjang (10 tahun)
ubijalar_future_years <- seq(max(data_ubijalar$Tahun) + 1, max(data_ubijalar$Tahun) + 10, by = "years")
future_data_ubijalar <- data.frame(Tahun = ubijalar_future_years) 

future_predictions_ubijalar <- predict(rf_model_ubijalar, future_data_ubijalar)
future_predictions_ubijalar
```
#### - Evaluasi Model
```{r}
# 1. Evaluasi model dalam  melakukan prediksi jangka pendek
# Hitung MAE (Mean Absolute Error)
mae_ubijalar_jangkapendek <- mean(abs(ubijalar_testing_data$Produksi_Ubijalar - ubijalar_predictions))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_ubijalar_jangkapendek <- mean(abs((ubijalar_testing_data$Produksi_Ubijalar - ubijalar_predictions) / ubijalar_testing_data$Produksi_Ubijalar) * 100)

# Hitung MSE (Mean Squared Error)
mse_ubijalar_jangkapendek <- mean((ubijalar_testing_data$Produksi_Ubijalar - ubijalar_predictions)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_ubijalar_jangkapendek <- sqrt(mse_ubijalar_jangkapendek)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_ubijalar_jangkapendek, "\n")
cat("MAPE:", mape_ubijalar_jangkapendek, "%\n")
cat("MSE:", mse_ubijalar_jangkapendek, "\n")
cat("RMSE:", rmse_ubijalar_jangkapendek, "\n")

```
```{r}
# 2. Evaluasi model dalam  melakukan prediksi jangka panjang
# Hitung MAE (Mean Absolute Error)
mae_ubijalar_jangkapanjang <- mean(abs(ubijalar_testing_data$Produksi_Ubijalar - future_predictions_ubijalar))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_ubijalar_jangkapanjang <- mean(abs((ubijalar_testing_data$Produksi_Ubijalar - future_predictions_ubijalar) / ubijalar_testing_data$Produksi_Ubijalar) * 100)

# Hitung MSE (Mean Squared Error)
mse_ubijalar_jangkapanjang <- mean((ubijalar_testing_data$Produksi_Ubijalar - future_predictions_ubijalar)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_ubijalar_jangkapanjang <- sqrt(mse_ubijalar_jangkapanjang)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_ubijalar_jangkapanjang, "\n")
cat("MAPE:", mape_ubijalar_jangkapanjang, "%\n")
cat("MSE:", mse_ubijalar_jangkapanjang, "\n")
cat("RMSE:", rmse_ubijalar_jangkapanjang, "\n")

```


## 6. Ubi Kayu
```{r}
# Menghitung total produksi untuk setiap tahun
summary_data_ubikayu <- UbiKayu %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_data_ubikayu
```

```{r}
# Membuat bar chart atau line chart
ggplot(summary_data_ubikayu, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Ubi Kayu dari 1993 - 2015",
       x = "Tahun",
       y = "Total Produksi")
```


```{r}
data_ubikayu <- summary_data_ubikayu %>% 
  rename(
    Tahun = "Tahun",
    Produksi_Ubikayu = "TotalProduksi"
  )
data_ubikayu

```


```{r}
# Membagi data menjadi data pelatihan dan pengujian - Ubi Kayu
set.seed(123) #menentukan nilai acak dari data
ubikayu_sample_indices <- sample(nrow(data_ubikayu), nrow(data_ubikayu) * 0.7)
ubikayu_training_data <- data_ubikayu[ubikayu_sample_indices, ]
ubikayu_testing_data <- data_ubikayu[-ubikayu_sample_indices, ]
ubikayu_training_data
ubikayu_testing_data
```
### a. Model Random Forest
#### - Membangun model
```{r}
# Membangun model Random Forest
rf_model_ubikayu <- randomForest(Produksi_Ubikayu ~., data = ubikayu_training_data, ntree = 500)
rf_model_ubikayu
```
#### - Melakukan prediksi
```{r}
# Melakukan prediksi jangka pendek
ubikayu_predictions <- predict(rf_model_ubikayu, newdata = ubikayu_testing_data)
ubikayu_predictions
plot(ubikayu_predictions)

```
```{r}
# Melakukan prediksi jangka panjang (10 tahun)
ubikayu_future_years <- seq(max(data_ubikayu$Tahun) + 1, max(data_ubikayu$Tahun) + 10, by = "years")
future_data_ubikayu <- data.frame(Tahun = ubikayu_future_years) 

future_predictions_ubikayu <- predict(rf_model_ubikayu, future_data_ubikayu)
future_predictions_ubikayu
```
#### - Evaluasi Model
```{r}
# 1. Evaluasi model dalam  melakukan prediksi jangka pendek
# Hitung MAE (Mean Absolute Error)
mae_ubikayu_jangkapendek <- mean(abs(ubikayu_testing_data$Produksi_Ubikayu - ubikayu_predictions))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_ubikayu_jangkapendek <- mean(abs((ubikayu_testing_data$Produksi_Ubikayu - ubikayu_predictions) / ubikayu_testing_data$Produksi_Ubikayu) * 100)

# Hitung MSE (Mean Squared Error)
mse_ubikayu_jangkapendek <- mean((ubikayu_testing_data$Produksi_Ubikayu - ubikayu_predictions)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_ubikayu_jangkapendek <- sqrt(mse_ubikayu_jangkapendek)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_ubikayu_jangkapendek, "\n")
cat("MAPE:", mape_ubikayu_jangkapendek, "%\n")
cat("MSE:", mse_ubikayu_jangkapendek, "\n")
cat("RMSE:", rmse_ubikayu_jangkapendek, "\n")

```
```{r}
# 2. Evaluasi model dalam  melakukan prediksi jangka panjang
# Hitung MAE (Mean Absolute Error)
mae_ubikayu_jangkapanjang <- mean(abs(ubikayu_testing_data$Produksi_Ubikayu - future_predictions_ubikayu))

# Hitung MAPE (Mean Absolute Percentage Error)
mape_ubikayu_jangkapanjang <- mean(abs((ubikayu_testing_data$Produksi_Ubikayu - future_predictions_ubikayu) / ubikayu_testing_data$Produksi_Ubikayu) * 100)

# Hitung MSE (Mean Squared Error)
mse_ubikayu_jangkapanjang <- mean((ubikayu_testing_data$Produksi_Ubikayu - future_predictions_ubikayu)^2)

# Hitung RMSE (Root Mean Squared Error)
rmse_ubikayu_jangkapanjang <- sqrt(mse_ubikayu_jangkapanjang)

# Tampilkan hasil metrik evaluasi
cat("MAE:", mae_ubikayu_jangkapanjang, "\n")
cat("MAPE:", mape_ubikayu_jangkapanjang, "%\n")
cat("MSE:", mse_ubikayu_jangkapanjang, "\n")
cat("RMSE:", rmse_ubikayu_jangkapanjang, "\n")

```



