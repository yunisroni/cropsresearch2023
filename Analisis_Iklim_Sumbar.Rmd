---
title: "Analisis Dampak Iklim Terhadap Produksi Pangan di Sumatera Barat"
author: "Nurul Aina Tasya"
date: "2023-10-31"
output: html_document
---

# 1. Load Library/Packages
```{r}
# library manipulasi data
library(tidyverse)
# library Untuk partisi dataset
library(caret) 
# library untuk evaluasi model
library(Metrics)
# library untuk import excel
library(readxl)
# library untuk model Random Forest
library(randomForest)
# library untuk model SVR
library(e1071)
library(timetk)
```

# 2. Obstain - Load Dataset
## a. Import Data
```{r}
Iklim <- read_excel("dataset/Dataset Tanaman Pangan dan Iklim di Indonesia (2006-2015).xlsx")
Iklim
rainfall <- read_excel("dataset/climateserv-statistical - SUMBAR.xlsx")
rainfall
```

## b.Menampilkan Contoh Data
```{r}
# Menampilkan 6 data teratas
head(Iklim)
head(rainfall)
```
```{r}
# Menampilkan 6 data terbawah
tail(Iklim)
tail(rainfall)
```
```{r}
glimpse(Iklim)
glimpse(rainfall)
```


# 3. Scrub data
## a. Merubah type data
```{r}
# Merubah type Tahun menjadi Date
Iklim$Tahun <- make_date(Iklim$Tahun)
glimpse(Iklim)
tail(Iklim)
head(Iklim)
```
```{r}
# Merubah type variabel DateTime menjadi Date
rainfall$Date <- as.Date(rainfall$Date)
glimpse(rainfall)
```
```{r}
# Merubah nama variabel
names(rainfall)[names(rainfall) == "Date"] <- "Tanggal"
names(rainfall)[names(rainfall) == "UCSB CHIRPS Rainfall: avg"] <- "CurahHujan"
glimpse(rainfall)
```
```{r}
# Mengambil rata-rata curah hujan per tahun
curahhujan_pertahun <- rainfall %>%
  mutate(Year = lubridate::year(Tanggal)) %>%
  group_by(Year) %>%
  summarise(Avg_Rainfall  = mean(CurahHujan))
curahhujan_pertahun  
```
```{r}
# Merubah type tahun menjadi date
curahhujan_pertahun$Year <- make_date(curahhujan_pertahun$Year)
curahhujan_pertahun
```

## b. Menghapus Data Kosong
```{r}
# Menampilkan variabel dengan baris kosong
glimpse(Iklim)
colSums(is.na(Iklim))
```
Jumlah data : 2,380 Record. Dari 11 variabel terhadap 8 buah variabel dengan data NA'S

```{r}
# Menghapus data NA'S
iklim_clean <- na.omit(Iklim)
colSums(is.na(iklim_clean))
summary(iklim_clean)
```
Berdasarkan hasil diatas bisa dilihat semua variabel tidak ada lagi data
yang kosong atau NA'
```{r}
glimpse(iklim_clean)
```
Jumlah data setelah dihapus data NA' menjadi 2,026 baris observasi dengan 11 variabel.

## c. Filter data
```{r}
# Filter data for "Sumatera Barat"
sumbar_data <- iklim_clean %>%
  filter(Provinsi == "SUMATERA BARAT")
sumbar_data
```

```{r}
# Mengabungkan kedua dataset
merged_data <- merge(sumbar_data, curahhujan_pertahun, by.x = "Tahun", by.y = "Year")
merged_data
```
### - Filter data jagung
```{r}
Jagung <- filter(merged_data, Jenis_Komoditi == "Jagung")
Jagung
```
### - Filter data kacang hijau
```{r}
KacangHijau <- filter(merged_data, Jenis_Komoditi == "Kacang Hijau")
KacangHijau
```
### - Filter data kacang kedelai
```{r}
KacangKedelai <- filter(merged_data, Jenis_Komoditi == "Kedelai")
KacangKedelai
```
### - Filter data kacang tanah
```{r}
KacangTanah <- filter(merged_data, Jenis_Komoditi == "Kacang Tanah")
KacangTanah
```
### - Filter data ubi jalar
```{r}
UbiJalar <- filter(merged_data, Jenis_Komoditi == "Ubi Jalar")
UbiJalar
```
### - Filter data ubi kayu
```{r}
UbiKayu <- filter(merged_data, Jenis_Komoditi == "Ubi Kayu")
UbiKayu
```
### - Filter data padi
```{r}
Padi <- filter(merged_data, Jenis_Komoditi == "Padi")
Padi
```

# 4. Eksplorasi Data Analisis (EDA)
## 1. Padi
```{r}
plot_padi <- ggplot(Padi, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Padi di Sumatera Barat", x = "Tahun", y = "Produksi Padi (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_padi
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_pd <- cor(Padi$Luas_Panen, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_pd)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,99. Hubungan luas panen dan produksi padi bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi padi.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_pd <- cor(Padi$Kecepatan_Angin, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,22. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_pd <- cor(Padi$Kelembapan, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,25. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_pd <- cor(Padi$Suhu, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_pd <- cor(Padi$Tekanan_Udara, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,05. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_pd <- cor(Padi$Penyinaran_Matahari, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,01. 

```{r}
# Hitung Pearson correlation coefficient
correlation_curahhujan_pd <- cor(Padi$Avg_Rainfall, Padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah Hujan dan Produksi:", correlation_curahhujan_pd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,24. 


```{r}
# Menghitung total produksi untuk setiap tahun
summary_padi <- Padi %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_padi
```

```{r}
# Visulisasi Produksi Padi Sepanjang Tahun 2006-2015
ggplot(summary_padi, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Padi dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##2. Kacang Hijau

```{r}
plot_kacanghijau <- ggplot(KacangHijau, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Kacang Hijau di Sumatera Barat", x = "Tahun", y = "Produksi Kacang Hijau (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacanghijau
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_kh <- cor(KacangHijau$Luas_Panen, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_kh)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,99. Hubungan luas panen dan produksi kacang hijau bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi kacang hijau.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_kh <- cor(KacangHijau$Kecepatan_Angin, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,01. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_kh <- cor(KacangHijau$Kelembapan, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,09. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_kh <- cor(KacangHijau$Suhu, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,21. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_kh <- cor(KacangHijau$Tekanan_Udara, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,20. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_kh <- cor(KacangHijau$Penyinaran_Matahari, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,28. 

```{r}
# Hitung Pearson correlation coefficient
correlation_curahhujan_kh <- cor(KacangHijau$Avg_Rainfall, KacangHijau$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah Hujan dan Produksi:", correlation_curahhujan_kh)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,41. 

```{r}
# Menghitung total produksi untuk setiap tahun
summary_kacanghijau <- KacangHijau %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_kacanghijau
```


```{r}
# Visulisasi Produksi Kacang Hijau Sepanjang Tahun 2006-2015
ggplot(summary_kacanghijau, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Hijau dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##3. Kacang Kedelai
```{r}
plot_kacangkedelai <- ggplot(KacangKedelai, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Kacang Kedelai di Sumatera Barat", x = "Tahun", y = "Produksi Kacang Kedelai (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangkedelai
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_kd <- cor(KacangKedelai$Luas_Panen, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_kd)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,97. Hubungan luas panen dan produksi kacang kedelai bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi kacang kedelai.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_kd <- cor(KacangKedelai$Kecepatan_Angin, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,15. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_kd <- cor(KacangKedelai$Kelembapan, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,2. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_kd <- cor(KacangKedelai$Suhu, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,05. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_kd <- cor(KacangKedelai$Tekanan_Udara, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,36. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_kd <- cor(KacangKedelai$Penyinaran_Matahari, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,55. 

```{r}
# Hitung Pearson correlation coefficient
correlation_curahhujan_kd <- cor(KacangKedelai$Avg_Rainfall, KacangKedelai$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah Hujan dan Produksi:", correlation_curahhujan_kd)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,23. 

```{r}
# Menghitung total produksi untuk setiap tahun
summary_kacangkedelai <- KacangKedelai %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_kacangkedelai
```

```{r}
# Visulisasi Produksi Kacang Kedelai Sepanjang Tahun 2006-2015
ggplot(summary_kacangkedelai, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Kedelai dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##4. Kacang Tanah
```{r}
plot_kacangtanah <- ggplot(KacangTanah, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Kacang Tanah di Sumatera Barat", x = "Tahun", y = "Produksi Kacang Tanah (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_kacangtanah
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_kt <- cor(KacangTanah$Luas_Panen, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_kt)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,89. Hubungan luas panen dan produksi kacang tanah bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi kacang tanah.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_kt <- cor(KacangTanah$Kecepatan_Angin, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,14. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_kt <- cor(KacangTanah$Kelembapan, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,57. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_kt <- cor(KacangTanah$Suhu, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_kt <- cor(KacangTanah$Tekanan_Udara, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,49. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_kt <- cor(KacangTanah$Penyinaran_Matahari, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,62. 

```{r}
# Hitung Pearson correlation coefficient
correlation_curahhujan_kt <- cor(KacangTanah$Avg_Rainfall, KacangTanah$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah Hujan dan Produksi:", correlation_curahhujan_kt)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,37. 

```{r}
# Menghitung total produksi untuk setiap tahun
summary_kacangtanah <- KacangTanah %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_kacangtanah
```

```{r}
# Visulisasi Produksi Kacang Tanah Sepanjang Tahun 2006-2015
ggplot(summary_kacangtanah, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Kacang Tanah dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##5. Ubi Jalar

```{r}
plot_ubijalar <- ggplot(UbiJalar, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Ubi Jalar di Sumatera Barat", x = "Tahun", y = "Produksi Ubi Jalar (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubijalar
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_uj <- cor(UbiJalar$Luas_Panen, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_uj)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,91. Hubungan luas panen dan produksi ubi jalar bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi ubi jalar.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_uj <- cor(UbiJalar$Kecepatan_Angin, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,15. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_uj <- cor(UbiJalar$Kelembapan, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,12. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_uj <- cor(UbiJalar$Suhu, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,07. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_uj <- cor(UbiJalar$Tekanan_Udara, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,03. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_uj <- cor(UbiJalar$Penyinaran_Matahari, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,11. 

```{r}
# Hitung Pearson correlation coefficient
correlation_curahhujan_uj <- cor(UbiJalar$Avg_Rainfall, UbiJalar$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah Hujan dan Produksi:", correlation_curahhujan_uj)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,26. 

```{r}
# Menghitung total produksi untuk setiap tahun
summary_ubijalar <- UbiJalar %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_ubijalar
```

```{r}
# Visulisasi Produksi Ubi Jalar Sepanjang Tahun 2006-2015
ggplot(summary_ubijalar, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Ubi Jalar dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##6. Ubi Kayu

```{r}
plot_ubikayu <- ggplot(UbiKayu, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Ubi Kayu di Sumatera Barat", x = "Tahun", y = "Produksi Ubi Kayu (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_ubikayu
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_uk <- cor(UbiKayu$Luas_Panen, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,23. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_uk <- cor(UbiKayu$Kecepatan_Angin, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,06. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_uk <- cor(UbiKayu$Kelembapan, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_uk <- cor(UbiKayu$Suhu, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_uk <- cor(UbiKayu$Tekanan_Udara, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,08. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_uk <- cor(UbiKayu$Penyinaran_Matahari, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,07. 

```{r}
# Hitung Pearson correlation coefficient
correlation_curahhujan_uk <- cor(UbiKayu$Avg_Rainfall, UbiKayu$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah Hujan dan Produksi:", correlation_curahhujan_uk)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,12. 

```{r}
# Menghitung total produksi untuk setiap tahun
summary_ubikayu <- UbiKayu %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_ubikayu
```

```{r}
# Visulisasi Produksi Ubi Kayu Sepanjang Tahun 2006-2015
ggplot(summary_ubikayu, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Ubi Kayu dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```


##7. Jagung

```{r}
plot_jagung <- ggplot(Jagung, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Jagung di Sumatera Barat", x = "Tahun", y = "Produksi Jagung (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_jagung
```

```{r}
# Hitung Pearson correlation coefficient
correlation_luaspanen_jg <- cor(Jagung$Luas_Panen, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_luaspanen_jg)
```
Hubungan korelasi adalah besar dengan nilai korelasi sebesar 0,91. Hubungan luas panen dan produksi jagung bisa disimpulkan bahwa jumlah luas panen yang besar akan meningkatkan jumlah produksi jagung.

```{r}
# Hitung Pearson correlation coefficient
correlation_kecepatanangin_jg <- cor(Jagung$Kecepatan_Angin, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", correlation_kecepatanangin_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,34. 

```{r}
# Hitung Pearson correlation coefficient
correlation_kelembapan_jg <- cor(Jagung$Kelembapan, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson kelembapan dan Produksi:", correlation_kelembapan_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,007. 

```{r}
# Hitung Pearson correlation coefficient
correlation_suhu_jg <- cor(Jagung$Suhu, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson suhu dan Produksi:", correlation_suhu_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar 0,01. 

```{r}
# Hitung Pearson correlation coefficient
correlation_tekananudara_jg <- cor(Jagung$Tekanan_Udara, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson tekanan udara dan Produksi:", correlation_tekananudara_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,11. 

```{r}
# Hitung Pearson correlation coefficient
correlation_penyinaranmatahari_jg <- cor(Jagung$Penyinaran_Matahari, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Penyinaran Matahari dan Produksi:", correlation_penyinaranmatahari_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,02. 

```{r}
# Hitung Pearson correlation coefficient
correlation_curahhujan_jg <- cor(Jagung$Avg_Rainfall, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah Hujan dan Produksi:", correlation_curahhujan_jg)
```
Hubungan korelasi adalah kecil dengan nilai korelasi sebesar -0,26. 

```{r}
# Menghitung total produksi untuk setiap tahun
summary_jagung <- Jagung %>%
  group_by(Tahun) %>%
  summarise(TotalProduksi = sum(Produksi))
summary_jagung
```

```{r}
# Visulisasi Produksi Jagung Sepanjang Tahun 2006-2015
ggplot(summary_jagung, aes(x = Tahun, y = TotalProduksi)) +
  geom_line() +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  labs(title = "Perubahan Jumlah Produksi Jagung dari 2006 - 2015",
       subtitle = "Sumatera Barat",
       x = "Tahun",
       y = "Total Produksi")
```




# 4. Model
## 1. Padi
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_Padi <- createDataPartition(Padi$Produksi, p = 0.6, list = FALSE)
data_train_Padi <- Padi[splitIndex_Padi, ]  # Data pelatihan (60%)
data_test_Padi <- Padi[-splitIndex_Padi, ]  # Data pengujian (40%)
data_train_Padi
data_test_Padi 
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_Padi <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_Padi, ntree = 1000)
rf_model_Padi
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_Padi <- predict(rf_model_Padi, data_test_Padi)
predictions_rf_Padi
```

```{r}
# Visualisasi Hasil
result_data_rf_Padi <- data.frame(Produksi = data_test_Padi$Produksi, Predictions = predictions_rf_Padi)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_Padi, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_Padi, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_Padi <- data.frame(Tahun = data_test_Padi$Tahun, Produksi = data_test_Padi$Produksi, Predictions = predictions_rf_Padi)

ggplot(data = result_data_rf2_Padi, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_Padi <- data.frame(Variable = row.names(importance(rf_model_Padi)),
                              Importance = importance(rf_model_Padi)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_Padi <- importance_rf_Padi[order(importance_rf_Padi$Importance, decreasing = TRUE), ]
importance_rf_Padi

# Visualisasi dengan ggplot
ggplot(importance_rf_Padi, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Produktivitas dan Luas Panen.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_Padi <- mae(data_test_Padi$Produksi, predictions_rf_Padi)

# Hitung MSE
mse_value_rf_Padi <- mse(data_test_Padi$Produksi, predictions_rf_Padi)

# Hitung RMSE
rmse_value_rf_Padi <- rmse(data_test_Padi$Produksi, predictions_rf_Padi)

# Hitung MAPE
mape_value_rf_Padi <- mape(data_test_Padi$Produksi, predictions_rf_Padi)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_Padi, "\n"))
cat(paste("MSE: ", mse_value_rf_Padi, "\n"))
cat(paste("RMSE: ", rmse_value_rf_Padi, "\n"))
cat(paste("MAPE: ", mape_value_rf_Padi, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_Padi <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_Padi, kernel = "radial", cost = 1)
svr_model_Padi
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_Padi <- predict(svr_model_Padi, data_test_Padi)
predictions_svr_Padi
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_Padi <- data.frame(Produksi = data_test_Padi$Produksi, Predictions = predictions_svr_Padi)

ggplot(data = result_data_svr_Padi, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_Padi, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_Padi <- data.frame(Tahun = data_test_Padi$Tahun, Produksi = data_test_Padi$Produksi, Predictions = predictions_svr_Padi)

ggplot(data = result_data_svr2_Padi, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_Padi <- mae(data_test_Padi$Produksi, predictions_svr_Padi)

# Hitung MSE
mse_value_svr_Padi <- mse(data_test_Padi$Produksi, predictions_svr_Padi)

# Hitung RMSE
rmse_value_svr_Padi <- rmse(data_test_Padi$Produksi, predictions_svr_Padi)

# Hitung MAPE
mape_value_svr_Padi <- mape(data_test_Padi$Produksi, predictions_svr_Padi)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_Padi, "\n"))
cat(paste("MSE: ", mse_value_svr_Padi, "\n"))
cat(paste("RMSE: ", rmse_value_svr_Padi, "\n"))
cat(paste("MAPE: ", mape_value_svr_Padi, "%\n"))
```


## 2. Kacang Hijau
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_KacangHijau <- createDataPartition(KacangHijau$Produksi, p = 0.6, list = FALSE)
data_train_KacangHijau <- KacangHijau[splitIndex_KacangHijau, ]  # Data pelatihan (60%)
data_test_KacangHijau <- KacangHijau[-splitIndex_KacangHijau, ]  # Data pengujian (40%)
data_train_KacangHijau
data_test_KacangHijau 
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_KacangHijau <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_KacangHijau, ntree = 1000)
rf_model_KacangHijau
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_KacangHijau <- predict(rf_model_KacangHijau, data_test_KacangHijau)
predictions_rf_KacangHijau
```

```{r}
# Visualisasi Hasil
result_data_rf_KacangHijau <- data.frame(Produksi = data_test_KacangHijau$Produksi, Predictions = predictions_rf_KacangHijau)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_KacangHijau, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_KacangHijau, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_KacangHijau <- data.frame(Tahun = data_test_KacangHijau$Tahun, Produksi = data_test_KacangHijau$Produksi, Predictions = predictions_rf_KacangHijau)

ggplot(data = result_data_rf2_KacangHijau, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_KacangHijau <- data.frame(Variable = row.names(importance(rf_model_KacangHijau)),
                              Importance = importance(rf_model_KacangHijau)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_KacangHijau <- importance_rf_KacangHijau[order(importance_rf_KacangHijau$Importance, decreasing = TRUE), ]
importance_rf_KacangHijau

# Visualisasi dengan ggplot
ggplot(importance_rf_KacangHijau, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Produktivitas dan Luas Panen.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_KacangHijau <- mae(data_test_KacangHijau$Produksi, predictions_rf_KacangHijau)

# Hitung MSE
mse_value_rf_KacangHijau <- mse(data_test_KacangHijau$Produksi, predictions_rf_KacangHijau)

# Hitung RMSE
rmse_value_rf_KacangHijau <- rmse(data_test_KacangHijau$Produksi, predictions_rf_KacangHijau)

# Hitung MAPE
mape_value_rf_KacangHijau <- mape(data_test_KacangHijau$Produksi, predictions_rf_KacangHijau)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_KacangHijau, "\n"))
cat(paste("MSE: ", mse_value_rf_KacangHijau, "\n"))
cat(paste("RMSE: ", rmse_value_rf_KacangHijau, "\n"))
cat(paste("MAPE: ", mape_value_rf_KacangHijau, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_KacangHijau <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_KacangHijau, kernel = "radial", cost = 1)
svr_model_KacangHijau
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_KacangHijau <- predict(svr_model_KacangHijau, data_test_KacangHijau)
predictions_svr_KacangHijau
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_KacangHijau <- data.frame(Produksi = data_test_KacangHijau$Produksi, Predictions = predictions_svr_KacangHijau)

ggplot(data = result_data_svr_KacangHijau, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_KacangHijau, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_KacangHijau <- data.frame(Tahun = data_test_KacangHijau$Tahun, Produksi = data_test_KacangHijau$Produksi, Predictions = predictions_svr_KacangHijau)

ggplot(data = result_data_svr2_KacangHijau, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_KacangHijau <- mae(data_test_KacangHijau$Produksi, predictions_svr_KacangHijau)

# Hitung MSE
mse_value_svr_KacangHijau <- mse(data_test_KacangHijau$Produksi, predictions_svr_KacangHijau)

# Hitung RMSE
rmse_value_svr_KacangHijau <- rmse(data_test_KacangHijau$Produksi, predictions_svr_KacangHijau)

# Hitung MAPE
mape_value_svr_KacangHijau <- mape(data_test_KacangHijau$Produksi, predictions_svr_KacangHijau)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_KacangHijau, "\n"))
cat(paste("MSE: ", mse_value_svr_KacangHijau, "\n"))
cat(paste("RMSE: ", rmse_value_svr_KacangHijau, "\n"))
cat(paste("MAPE: ", mape_value_svr_KacangHijau, "%\n"))
```


## 3. Kacang Kedelai
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_KacangKedelai <- createDataPartition(KacangKedelai$Produksi, p = 0.6, list = FALSE)
data_train_KacangKedelai <- KacangKedelai[splitIndex_KacangKedelai, ]  # Data pelatihan (60%)
data_test_KacangKedelai <- KacangKedelai[-splitIndex_KacangKedelai, ]  # Data pengujian (40%)
data_train_KacangKedelai
data_test_KacangKedelai
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_KacangKedelai <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_KacangKedelai, ntree = 1000)
rf_model_KacangKedelai
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_KacangKedelai <- predict(rf_model_KacangKedelai, data_test_KacangKedelai)
predictions_rf_KacangKedelai
```

```{r}
# Visualisasi Hasil
result_data_rf_KacangKedelai <- data.frame(Produksi = data_test_KacangKedelai$Produksi, Predictions = predictions_rf_KacangKedelai)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_KacangKedelai, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_KacangKedelai, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_KacangKedelai <- data.frame(Tahun = data_test_KacangKedelai$Tahun, Produksi = data_test_KacangKedelai$Produksi, Predictions = predictions_rf_KacangKedelai)

ggplot(data = result_data_rf2_KacangKedelai, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_KacangKedelai <- data.frame(Variable = row.names(importance(rf_model_KacangKedelai)),
                              Importance = importance(rf_model_KacangKedelai)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_KacangKedelai <- importance_rf_KacangKedelai[order(importance_rf_KacangKedelai$Importance, decreasing = TRUE), ]
importance_rf_KacangKedelai

# Visualisasi dengan ggplot
ggplot(importance_rf_KacangKedelai, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Produktivitas dan Luas Panen.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_KacangKedelai <- mae(data_test_KacangKedelai$Produksi, predictions_rf_KacangKedelai)

# Hitung MSE
mse_value_rf_KacangKedelai <- mse(data_test_KacangKedelai$Produksi, predictions_rf_KacangKedelai)

# Hitung RMSE
rmse_value_rf_KacangKedelai <- rmse(data_test_KacangKedelai$Produksi, predictions_rf_KacangKedelai)

# Hitung MAPE
mape_value_rf_KacangKedelai <- mape(data_test_KacangKedelai$Produksi, predictions_rf_KacangKedelai)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_KacangKedelai, "\n"))
cat(paste("MSE: ", mse_value_rf_KacangKedelai, "\n"))
cat(paste("RMSE: ", rmse_value_rf_KacangKedelai, "\n"))
cat(paste("MAPE: ", mape_value_rf_KacangKedelai, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_KacangKedelai <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_KacangKedelai, kernel = "radial", cost = 1)
svr_model_KacangKedelai
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_KacangKedelai <- predict(svr_model_KacangKedelai, data_test_KacangKedelai)
predictions_svr_KacangKedelai
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_KacangKedelai <- data.frame(Produksi = data_test_KacangKedelai$Produksi, Predictions = predictions_svr_KacangKedelai)

ggplot(data = result_data_svr_KacangKedelai, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_KacangKedelai, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_KacangKedelai <- data.frame(Tahun = data_test_KacangKedelai$Tahun, Produksi = data_test_KacangKedelai$Produksi, Predictions = predictions_svr_KacangKedelai)

ggplot(data = result_data_svr2_KacangKedelai, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_KacangKedelai <- mae(data_test_KacangKedelai$Produksi, predictions_svr_KacangKedelai)

# Hitung MSE
mse_value_svr_KacangKedelai <- mse(data_test_KacangKedelai$Produksi, predictions_svr_KacangKedelai)

# Hitung RMSE
rmse_value_svr_KacangKedelai <- rmse(data_test_KacangKedelai$Produksi, predictions_svr_KacangKedelai)

# Hitung MAPE
mape_value_svr_KacangKedelai <- mape(data_test_KacangKedelai$Produksi, predictions_svr_KacangKedelai)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_KacangKedelai, "\n"))
cat(paste("MSE: ", mse_value_svr_KacangKedelai, "\n"))
cat(paste("RMSE: ", rmse_value_svr_KacangKedelai, "\n"))
cat(paste("MAPE: ", mape_value_svr_KacangKedelai, "%\n"))
```


## 4. Kacang Tanah
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_KacangTanah <- createDataPartition(KacangTanah$Produksi, p = 0.6, list = FALSE)
data_train_KacangTanah <- KacangTanah[splitIndex_KacangTanah, ]  # Data pelatihan (60%)
data_test_KacangTanah <- KacangTanah[-splitIndex_KacangTanah, ]  # Data pengujian (40%)
data_train_KacangTanah
data_test_KacangTanah
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_KacangTanah <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_KacangTanah, ntree = 1000)
rf_model_KacangTanah
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_KacangTanah <- predict(rf_model_KacangTanah, data_test_KacangTanah)
predictions_rf_KacangTanah
```

```{r}
# Visualisasi Hasil
result_data_rf_KacangTanah <- data.frame(Produksi = data_test_KacangTanah$Produksi, Predictions = predictions_rf_KacangTanah)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_KacangTanah, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_KacangTanah, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_KacangTanah <- data.frame(Tahun = data_test_KacangTanah$Tahun, Produksi = data_test_KacangTanah$Produksi, Predictions = predictions_rf_KacangTanah)

ggplot(data = result_data_rf2_KacangTanah, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_KacangTanah <- data.frame(Variable = row.names(importance(rf_model_KacangTanah)),
                              Importance = importance(rf_model_KacangTanah)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_KacangTanah <- importance_rf_KacangTanah[order(importance_rf_KacangTanah$Importance, decreasing = TRUE), ]
importance_rf_KacangTanah

# Visualisasi dengan ggplot
ggplot(importance_rf_KacangTanah, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Luas Panena dan penyinaran matahari.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_KacangTanah <- mae(data_test_KacangTanah$Produksi, predictions_rf_KacangTanah)

# Hitung MSE
mse_value_rf_KacangTanah <- mse(data_test_KacangTanah$Produksi, predictions_rf_KacangTanah)

# Hitung RMSE
rmse_value_rf_KacangTanah <- rmse(data_test_KacangTanah$Produksi, predictions_rf_KacangTanah)

# Hitung MAPE
mape_value_rf_KacangTanah <- mape(data_test_KacangTanah$Produksi, predictions_rf_KacangTanah)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_KacangTanah, "\n"))
cat(paste("MSE: ", mse_value_rf_KacangTanah, "\n"))
cat(paste("RMSE: ", rmse_value_rf_KacangTanah, "\n"))
cat(paste("MAPE: ", mape_value_rf_KacangTanah, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_KacangTanah <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_KacangTanah, kernel = "radial", cost = 1)
svr_model_KacangTanah
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_KacangTanah <- predict(svr_model_KacangTanah, data_test_KacangTanah)
predictions_svr_KacangTanah
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_KacangTanah <- data.frame(Produksi = data_test_KacangTanah$Produksi, Predictions = predictions_svr_KacangTanah)

ggplot(data = result_data_svr_KacangTanah, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_KacangTanah, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_KacangTanah <- data.frame(Tahun = data_test_KacangTanah$Tahun, Produksi = data_test_KacangTanah$Produksi, Predictions = predictions_svr_KacangTanah)

ggplot(data = result_data_svr2_KacangTanah, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_KacangTanah <- mae(data_test_KacangTanah$Produksi, predictions_svr_KacangTanah)

# Hitung MSE
mse_value_svr_KacangTanah <- mse(data_test_KacangTanah$Produksi, predictions_svr_KacangTanah)

# Hitung RMSE
rmse_value_svr_KacangTanah <- rmse(data_test_KacangTanah$Produksi, predictions_svr_KacangTanah)

# Hitung MAPE
mape_value_svr_KacangTanah <- mape(data_test_KacangTanah$Produksi, predictions_svr_KacangTanah)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_KacangTanah, "\n"))
cat(paste("MSE: ", mse_value_svr_KacangTanah, "\n"))
cat(paste("RMSE: ", rmse_value_svr_KacangTanah, "\n"))
cat(paste("MAPE: ", mape_value_svr_KacangTanah, "%\n"))
```



##5. Ubi Jalar
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_UbiJalar <- createDataPartition(UbiJalar$Produksi, p = 0.6, list = FALSE)
data_train_UbiJalar <- UbiJalar[splitIndex_UbiJalar, ]  # Data pelatihan (60%)
data_test_UbiJalar <- UbiJalar[-splitIndex_UbiJalar, ]  # Data pengujian (40%)
data_train_UbiJalar
data_test_UbiJalar
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_UbiJalar <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_UbiJalar, ntree = 1000)
rf_model_UbiJalar
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_UbiJalar <- predict(rf_model_UbiJalar, data_test_UbiJalar)
predictions_rf_UbiJalar
```

```{r}
# Visualisasi Hasil
result_data_rf_UbiJalar <- data.frame(Produksi = data_test_UbiJalar$Produksi, Predictions = predictions_rf_UbiJalar)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_UbiJalar, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_UbiJalar, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_UbiJalar <- data.frame(Tahun = data_test_UbiJalar$Tahun, Produksi = data_test_UbiJalar$Produksi, Predictions = predictions_rf_UbiJalar)

ggplot(data = result_data_rf2_UbiJalar, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_UbiJalar <- data.frame(Variable = row.names(importance(rf_model_UbiJalar)),
                              Importance = importance(rf_model_UbiJalar)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_UbiJalar <- importance_rf_UbiJalar[order(importance_rf_UbiJalar$Importance, decreasing = TRUE), ]
importance_rf_UbiJalar

# Visualisasi dengan ggplot
ggplot(importance_rf_UbiJalar, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Produktivitas dan Luas Panen.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_UbiJalar <- mae(data_test_UbiJalar$Produksi, predictions_rf_UbiJalar)

# Hitung MSE
mse_value_rf_UbiJalar <- mse(data_test_UbiJalar$Produksi, predictions_rf_UbiJalar)

# Hitung RMSE
rmse_value_rf_UbiJalar <- rmse(data_test_UbiJalar$Produksi, predictions_rf_UbiJalar)

# Hitung MAPE
mape_value_rf_UbiJalar <- mape(data_test_UbiJalar$Produksi, predictions_rf_UbiJalar)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_UbiJalar, "\n"))
cat(paste("MSE: ", mse_value_rf_UbiJalar, "\n"))
cat(paste("RMSE: ", rmse_value_rf_UbiJalar, "\n"))
cat(paste("MAPE: ", mape_value_rf_UbiJalar, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_UbiJalar <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_UbiJalar, kernel = "radial", cost = 1)
svr_model_UbiJalar
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_UbiJalar <- predict(svr_model_UbiJalar, data_test_UbiJalar)
predictions_svr_UbiJalar
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_UbiJalar <- data.frame(Produksi = data_test_UbiJalar$Produksi, Predictions = predictions_svr_UbiJalar)

ggplot(data = result_data_svr_UbiJalar, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_UbiJalar, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_UbiJalar <- data.frame(Tahun = data_test_UbiJalar$Tahun, Produksi = data_test_UbiJalar$Produksi, Predictions = predictions_svr_UbiJalar)

ggplot(data = result_data_svr2_UbiJalar, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_UbiJalar <- mae(data_test_UbiJalar$Produksi, predictions_svr_UbiJalar)

# Hitung MSE
mse_value_svr_UbiJalar <- mse(data_test_UbiJalar$Produksi, predictions_svr_UbiJalar)

# Hitung RMSE
rmse_value_svr_UbiJalar <- rmse(data_test_UbiJalar$Produksi, predictions_svr_UbiJalar)

# Hitung MAPE
mape_value_svr_UbiJalar <- mape(data_test_UbiJalar$Produksi, predictions_svr_UbiJalar)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_UbiJalar, "\n"))
cat(paste("MSE: ", mse_value_svr_UbiJalar, "\n"))
cat(paste("RMSE: ", rmse_value_svr_UbiJalar, "\n"))
cat(paste("MAPE: ", mape_value_svr_UbiJalar, "%\n"))
```



## 6. Ubi Kayu
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_UbiKayu <- createDataPartition(UbiKayu$Produksi, p = 0.6, list = FALSE)
data_train_UbiKayu <-UbiKayu[splitIndex_UbiKayu, ]  # Data pelatihan (60%)
data_test_UbiKayu <- UbiKayu[-splitIndex_UbiKayu, ]  # Data pengujian (40%)
data_train_UbiKayu
data_test_UbiKayu
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_UbiKayu <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari+ Avg_Rainfall, data = data_train_UbiKayu, ntree = 1000)
rf_model_UbiKayu
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_UbiKayu <- predict(rf_model_UbiKayu, data_test_UbiKayu)
predictions_rf_UbiKayu
```

```{r}
# Visualisasi Hasil
result_data_rf_UbiKayu <- data.frame(Produksi = data_test_UbiKayu$Produksi, Predictions = predictions_rf_UbiKayu)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_UbiKayu, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_UbiKayu, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_UbiKayu <- data.frame(Tahun = data_test_UbiKayu$Tahun, Produksi = data_test_UbiKayu$Produksi, Predictions = predictions_rf_UbiKayu)

ggplot(data = result_data_rf2_UbiKayu, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_UbiKayu <- data.frame(Variable = row.names(importance(rf_model_UbiKayu)),
                              Importance = importance(rf_model_UbiKayu)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_UbiKayu <- importance_rf_UbiKayu[order(importance_rf_UbiKayu$Importance, decreasing = TRUE), ]
importance_rf_UbiKayu

# Visualisasi dengan ggplot
ggplot(importance_rf_UbiKayu, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Produktivitas.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_UbiKayu <- mae(data_test_UbiKayu$Produksi, predictions_rf_UbiKayu)

# Hitung MSE
mse_value_rf_UbiKayu <- mse(data_test_UbiKayu$Produksi, predictions_rf_UbiKayu)

# Hitung RMSE
rmse_value_rf_UbiKayu <- rmse(data_test_UbiKayu$Produksi, predictions_rf_UbiKayu)

# Hitung MAPE
mape_value_rf_UbiKayu <- mape(data_test_UbiKayu$Produksi, predictions_rf_UbiKayu)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_UbiKayu, "\n"))
cat(paste("MSE: ", mse_value_rf_UbiKayu, "\n"))
cat(paste("RMSE: ", rmse_value_rf_UbiKayu, "\n"))
cat(paste("MAPE: ", mape_value_rf_UbiKayu, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_UbiKayu <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_UbiKayu, kernel = "radial", cost = 1)
svr_model_UbiKayu
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_UbiKayu <- predict(svr_model_UbiKayu, data_test_UbiKayu)
predictions_svr_UbiKayu
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_UbiKayu <- data.frame(Produksi = data_test_UbiKayu$Produksi, Predictions = predictions_svr_UbiKayu)

ggplot(data = result_data_svr_UbiKayu, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_UbiKayu, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_UbiKayu <- data.frame(Tahun = data_test_UbiKayu$Tahun, Produksi = data_test_UbiKayu$Produksi, Predictions = predictions_svr_UbiKayu)

ggplot(data = result_data_svr2_UbiKayu, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_UbiKayu <- mae(data_test_UbiKayu$Produksi, predictions_svr_UbiKayu)

# Hitung MSE
mse_value_svr_UbiKayu <- mse(data_test_UbiKayu$Produksi, predictions_svr_UbiKayu)

# Hitung RMSE
rmse_value_svr_UbiKayu <- rmse(data_test_UbiKayu$Produksi, predictions_svr_UbiKayu)

# Hitung MAPE
mape_value_svr_UbiKayu <- mape(data_test_UbiKayu$Produksi, predictions_svr_UbiKayu)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_UbiKayu, "\n"))
cat(paste("MSE: ", mse_value_svr_UbiKayu, "\n"))
cat(paste("RMSE: ", rmse_value_svr_UbiKayu, "\n"))
cat(paste("MAPE: ", mape_value_svr_UbiKayu, "%\n"))
```



## 7. Jagung
### a. Model Random Forest
####- Partisi Dataset
```{r}
set.seed(123)  # Untuk hasil yang dapat direproduksi
splitIndex_Jagung <- createDataPartition(Jagung$Produksi, p = 0.6, list = FALSE)
data_train_Jagung <- Jagung[splitIndex_Jagung, ]  # Data pelatihan (60%)
data_test_Jagung <- Jagung[-splitIndex_Jagung, ]  # Data pengujian (40%)
data_train_Jagung
data_test_Jagung
```

####- Model RF 
```{r}
# Membuat model RF
rf_model_Jagung <- randomForest(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_Jagung, ntree = 1000)
rf_model_Jagung
```

```{r}
# Melakukan Prediksi terhadap Data Pengujian
predictions_rf_Jagung <- predict(rf_model_Jagung, data_test_Jagung)
predictions_rf_Jagung
```

```{r}
# Visualisasi Hasil
result_data_rf_Jagung <- data.frame(Produksi = data_test_Jagung$Produksi, Predictions = predictions_rf_Jagung)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_Jagung, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_data_rf_Jagung, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_rf2_Jagung <- data.frame(Tahun = data_test_Jagung$Tahun, Produksi = data_test_Jagung$Produksi, Predictions = predictions_rf_Jagung)

ggplot(data = result_data_rf2_Jagung, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model RF") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Ambil variabel yang penting dalam data
importance_rf_Jagung <- data.frame(Variable = row.names(importance(rf_model_Jagung)),
                              Importance = importance(rf_model_Jagung)[, 1])

# Urutkan data berdasarkan derajat variabel penting
importance_rf_Jagung <- importance_rf_Jagung[order(importance_rf_Jagung$Importance, decreasing = TRUE), ]
importance_rf_Jagung

# Visualisasi dengan ggplot
ggplot(importance_rf_Jagung, aes(x = reorder(Variable, Importance), y = Importance)) +
  geom_bar(stat = "identity", fill = "blue") +
  labs(title = "Variable Importance Plot",
       x = "Variable",
       y = "Importance") +
  theme(axis.text.x = element_text(angle = 45, hjust = 1)) + # Rotating x-axis menjadi mudah dilihat
  theme_minimal()
```
Berdasarkan hasil diatas bisa disimpulkan, bahwa variabel yang sangat mempengaruhi produksi adalah Produktivitas dan Luas Panen.

```{r}
# Evaluasi RF Model

# Hitung MAE
mae_value_rf_Jagung <- mae(data_test_Jagung$Produksi, predictions_rf_Jagung)

# Hitung MSE
mse_value_rf_Jagung <- mse(data_test_Jagung$Produksi, predictions_rf_Jagung)

# Hitung RMSE
rmse_value_rf_Jagung <- rmse(data_test_Jagung$Produksi, predictions_rf_Jagung)

# Hitung MAPE
mape_value_rf_Jagung <- mape(data_test_Jagung$Produksi, predictions_rf_Jagung)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_rf_Jagung, "\n"))
cat(paste("MSE: ", mse_value_rf_Jagung, "\n"))
cat(paste("RMSE: ", rmse_value_rf_Jagung, "\n"))
cat(paste("MAPE: ", mape_value_rf_Jagung, "%\n"))
```
### b. Model SVR

```{r}
# Membuat model SVR
svr_model_Jagung <- svm(Produksi ~ Produktivitas + Luas_Panen + Kecepatan_Angin + Kelembapan + Suhu + Tekanan_Udara + Penyinaran_Matahari + Avg_Rainfall, data = data_train_Jagung, kernel = "radial", cost = 1)
svr_model_Jagung
```

```{r}
# Melakukan prediksi dengan Data Testing
predictions_svr_Jagung <- predict(svr_model_Jagung, data_test_Jagung)
predictions_svr_Jagung
```

```{r}
# Visualisasi hasil prediksi
result_data_svr_Jagung <- data.frame(Produksi = data_test_Jagung$Produksi, Predictions = predictions_svr_Jagung)

ggplot(data = result_data_svr_Jagung, aes(x = Produksi, y = Predictions)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  labs(x = "Produksi Aktual (Ton)", y = "Prediksi Produksi (Ton)") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  theme_minimal()
```

```{r}
# Buat grafik garis dengan ggplot2
ggplot(data = result_data_svr_Jagung, aes(x = 1:length(Produksi))) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Observasi", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```

```{r}
# Visualisasi hasil prediksi dengan sumbu x adalah tahun
result_data_svr2_Jagung <- data.frame(Tahun = data_test_Jagung$Tahun, Produksi = data_test_Jagung$Produksi, Predictions = predictions_svr_Jagung)

ggplot(data = result_data_svr2_Jagung, aes(x = Tahun)) +
  geom_line(aes(y = Produksi, color = "Aktual"), size = 1) +
  geom_line(aes(y = Predictions, color = "Prediksi"), size = 1) +
  labs(x = "Tahun", y = "Produksi (Ton)") +
  scale_color_manual(values = c("Aktual" = "blue", "Prediksi" = "red")) +
  ggtitle("Perbandingan Produksi Aktual dan Prediksi Model SVR") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal()
```
```{r}
# Evaluasi SVR Model

# Hitung MAE
mae_value_svr_Jagung <- mae(data_test_Jagung$Produksi, predictions_svr_Jagung)

# Hitung MSE
mse_value_svr_Jagung <- mse(data_test_Jagung$Produksi, predictions_svr_Jagung)

# Hitung RMSE
rmse_value_svr_Jagung <- rmse(data_test_Jagung$Produksi, predictions_svr_Jagung)

# Hitung MAPE
mape_value_svr_Jagung <- mape(data_test_Jagung$Produksi, predictions_svr_Jagung)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_svr_Jagung, "\n"))
cat(paste("MSE: ", mse_value_svr_Jagung, "\n"))
cat(paste("RMSE: ", rmse_value_svr_Jagung, "\n"))
cat(paste("MAPE: ", mape_value_svr_Jagung, "%\n"))
```
