---
title: "Analisis Iklim terhadap tanaman pangan dengan model VAR dan GLM"
author: "Fitria"
date: "2023-10-29"
output: pdf_document
---


```{r}
.libPaths("C:/Users/Lenovo/AppData/Local/R/win-library/4.3")
```

```{r}
library(readxl)
library(dplyr)
library(stats)
library(lubridate)
library(ggplot2)
library(lubridate)
library(summarytools)
library(cluster)
library(scales)
library(vars)
library(glm2)
library(Metrics)
```


# Load Data
```{r}
data_iklim_sumatera <-read_excel("D:/OneDrive - mikroskil.ac.id/Skripsi/Dataset 2006-2015.xlsx")
data_iklim_sumatera
```

```{r}
#menghapus variabel Luas panen
data_iklim_new <-data_iklim_sumatera %>%
  select(-Luas_Panen)
```

```{r}
data_iklim <- subset(data_iklim_sumatera, select = -Luas_Panen)
data_iklim
```

```{r}
#Merubah type data dari double menjadi numeric agar mudah di operasikan
data_iklim$Produktivitas<-as.numeric(data_iklim$Produktivitas)
data_iklim$Produksi<-as.numeric(data_iklim$Produksi)
data_iklim$Kecepatan_Angin<-as.numeric(data_iklim$Kecepatan_Angin)
data_iklim$Kelembapan<-as.numeric(data_iklim$Kelembapan)
data_iklim$Suhu<-as.numeric(data_iklim$Suhu)
data_iklim$Penyinaran_Matahari<-as.numeric(data_iklim$Penyinaran_Matahari)
data_iklim$Curah_hujan<-as.numeric(data_iklim$Curah_hujan)
data_iklim
```

```{r}
#Merubah type data dari double menjadi date agar mudah di operasikan
data_iklim$Tahun<-make_date(data_iklim$Tahun)
data_iklim
```
```{r}
glimpse(data_iklim)
```

```{r}
tail(data_iklim)
```

```{r}
# Menampilkan jumlah baris dan kolom pada data_iklim
dim(data_iklim)
```

```{r}
#shapiro.test(data_iklim$Produksi)
#shapiro.test(data_iklim$Produktivitas)
#shapiro.test(data_iklim$Luas_Panen)
#shapiro.test(data_iklim$Kecepatan_Angin)
#shapiro.test(data_iklim$Kelembapan)
#shapiro.test(data_iklim$Suhu)
#shapiro.test(data_iklim$Penyinaran_Matahari)
#shapiro.test(data_iklim$Curah_hujan)
```


```{r}
#ks.test(data_iklim$Produksi, "pnorm", mean=mean(data_iklim$Produksi), sd=sd(data_iklim$Produksi))
#ks.test(data_iklim$Kelembapan, "pnorm", mean=mean(data_iklim$Kelembapan), sd=sd(data_iklim$Kelembapan))
```

# Membersihkan Data
```{r}
# Menampikan variabel dengan baris kosong
colSums(is.na(data_iklim))
```

```{r}
# Menghapus data NA's
Iklim_clean <- na.omit(data_iklim)
summary(Iklim_clean)
```
```{r}
colSums(is.na(Iklim_clean))
```
```{r}
glimpse(Iklim_clean)
```


```{r}
tail(Iklim_clean)
```

```{r}
glimpse(Iklim_clean)
```

# Eksplorasi Data Analisis (EDA)

# Hitung total produksi semua tanaman palawija per provinsi di setiap tahun
### Jumlah Produksi Tanaman Pangan per Provinsi di Pulau Sumatera
```{r}
# Hitung total produksi semua tanaman pangan per provinsi di sumatera di setiap tahun
totproduksi_sumatera <- Iklim_clean %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi)) %>%
  arrange(desc(total_produksi))

totproduksi_sumatera
```

```{r}
# Hitung total produksi semua tanaman pangan per setiap Kabupaten/Kota
totproduksi_provsumatera <- Iklim_clean %>% 
  group_by(Provinsi) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_provsumatera

```

### visualisasi Produksi Tanaman Pangan per Provinsi di pulau sumatera
```{r}
# Visualisasi Tren Produksi tanaman pangan per provinsi di setiap tahun
plot_sumatera1 <- ggplot(totproduksi_sumatera, aes(x = Tahun, y = total_produksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Tanaman Pangan di Pulau Sumatera", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")

plot_sumatera1
```

### visualisasi Produksi Tanaman Pangan per Provinsi di pulau sumatera

```{r}
plot_sumatera <- ggplot(totproduksi_sumatera, aes(x = Tahun, y = total_produksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Tanaman Pangan di Pulau Sumatera", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")

plot_sumatera
```

Produksi tanaman pangan terbanyak di pulau sumatera dalam kurun waktu 2006 - 2015 adalah dari provinsi dengan Jumlah Produksi 



```{r}
# Hitung total produktivitas semua tanaman pangan per provinsi di sumatera di setiap tahun
totproduktivitas_sumatera <- Iklim_clean %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produktivitas = sum(Produktivitas)) %>%
  arrange(desc(total_produktivitas))

totproduktivitas_sumatera
```

```{r}
# Visualisasi Tren Produktivitas tanaman pangan per provinsi di setiap tahun
plot_sumatera_produktivitas<- ggplot(totproduktivitas_sumatera, aes(x = Tahun, y = total_produktivitas, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren ProduktivitasTanaman Pangan di Pulau Sumatera", x = "Tahun", y = "Total Produktivitas") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")

plot_sumatera_produktivitas
```



```{r}
shapiro.test(Iklim_clean$Produksi)
shapiro.test(Iklim_clean$Produktivitas)
shapiro.test(Iklim_clean$Luas_Panen)
shapiro.test(Iklim_clean$Kecepatan_Angin)
shapiro.test(Iklim_clean$Kelembapan)
shapiro.test(Iklim_clean$Suhu)
shapiro.test(Iklim_clean$Penyinaran_Matahari)
shapiro.test(Iklim_clean$Curah_hujan)
```

```{r}
#hist(data$variabel_dependen) untuk variabel dependen numerik yang hasilnya menunjukkan bahwa distribusi data tidak normal 
hist(Iklim_clean$Produksi)
hist(Iklim_clean$Produktivitas)
```
```{r}
# Melakukan transformasi logaritmik pada variabel Produktivitas
Iklim_clean$Produktivitas_transformed <- log(Iklim_clean$Produktivitas)

# Melakukan transformasi logaritmik pada variabel Produksi
Iklim_clean$Produksi_transformed <- log(Iklim_clean$Produksi)
```


```{r}
hist(Iklim_clean$Produksi_transformed)
hist(Iklim_clean$Produktivitas_transformed)
```


# A. MODEL VAR
Melakukan Analisis Iklim terhadap tanaman pangan di pulau Sumatera tahun 2006-2015 dengan model VAR


## Produksi Padi- VAR

```{r}
#Mengambil tanaman pangan padi di pulau sumatera

Iklim_padi <- Iklim_clean %>%
  filter(Jenis_Komoditi == "Padi") 

Iklim_padi
```

```{r}
#Pilih variabel yang akan diprediksi
padi_var_sumatera1 <- Iklim_padi[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
padi_var_sumatera1
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam format time series (ts)

```{r}
#Format time series
ts_data_padi_sumatera <- ts(padi_var_sumatera1, start = c(2006,1), frequency = 1)
ts_data_padi_sumatera
```

```{r}
best_lag_padi_sumatera<- VARselect(ts_data_padi_sumatera, lag.max = 5, type = "both")
best_lag_padi_sumatera
```

### VAR Model Iklim terhadap produksi padi sumatera

```{r}
var_model_Padi_sumatera <- VAR(ts_data_padi_sumatera, p = best_lag_padi_sumatera$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_Padi_sumatera)
```

### Uji Kolersi Pearson
```{r}
# Menghitung koefisien korelasi Pearson produksi padi terhadap curah hujan
kolerasi_padi1 <- cor(padi_var_sumatera1$Produksi, padi_var_sumatera1$Curah_hujan)
cat ("Koefisien Korelasi Pearson Curah hujan dan Produksipadi:",kolerasi_padi1)
```
Koefisien Korelasi Pearson Curah hujan dan Produksi: 


```{r}
# Menghitung koefisien korelasi Pearson 
kolerasi_padi3 <- cor(padi_var_sumatera1$Produksi, padi_var_sumatera1$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi padi:", kolerasi_padi3)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produksi: 

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi4 <- cor(padi_var_sumatera1$Produksi, padi_var_sumatera1$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produksi padi:", kolerasi_padi4)
```
Koefisien Korelasi Pearson Kelembapan dan Produksi: 0.003511531

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi5 <- cor(padi_var_sumatera1$Produksi, padi_var_sumatera1$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi padi:", kolerasi_padi5)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi: -8.509364e-05

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi6 <- cor(padi_var_sumatera1$Produksi, padi_var_sumatera1$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produksi padi:", kolerasi_padi6)
```
Koefisien Korelasi Pearson Suhu dan Produksi: 0.03617682

### Uji Granger Causality
```{r}
# Melakukan uji Granger Causality 
granger_padi_sumatera1 <- causality(var_model_Padi_sumatera, cause = "Curah_hujan")
granger_padi_sumatera1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```


```{r}
# Melakukan uji Granger Causality 
granger_padi_sumatera3 <- causality(var_model_Padi_sumatera, cause = "Suhu")
granger_padi_sumatera3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```


### Uji regresi linier
```{r}
# Membuat model regresi linier
regresi_padi_sumatera <- lm(Produksi ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = padi_var_sumatera1)

# Ringkasan hasil model
summary(regresi_padi_sumatera)
```

KESIMPULAN:


## Produktivitas Padi- VAR

```{r}
# Pilih variabel yang akan diprediksi

padi_var_sumatera2 <- Iklim_padi[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
padi_var_sumatera2
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_padi_sumatera2 <- ts(padi_var_sumatera2, start = c(2006,1), frequency = 1)
ts_padi_sumatera2
```

```{r}
best_lag_padi_sumatera2<- VARselect(ts_padi_sumatera2, lag.max = 5, type = "both")
best_lag_padi_sumatera2
```

### VAR Model Iklim terhadap produktivitas padi sumatera

```{r}
var_model_Padi_sumatera2 <- VAR(ts_padi_sumatera2, p = best_lag_padi_sumatera2$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_Padi_sumatera2)
```

### Uji Kolerasi Pearson
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi7 <- cor(padi_var_sumatera2$Produktivitas, padi_var_sumatera2$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_padi7)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: 0.04455614


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi9 <- cor(padi_var_sumatera2$Produktivitas, padi_var_sumatera2$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas:", kolerasi_padi9)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas: -0.51

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi10<- cor(padi_var_sumatera2$Produktivitas, padi_var_sumatera2$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produktivitas:", kolerasi_padi10)
```
Koefisien Korelasi Pearson Kelembapan dan Produktivitas: -0.09

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi11 <- cor(padi_var_sumatera2$Produktivitas, padi_var_sumatera2$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas:", kolerasi_padi11)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas : 0.013

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi6 <- cor(padi_var_sumatera2$Produktivitas, padi_var_sumatera2$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produktivitas:", kolerasi_padi6)
```
Koefisien Korelasi Pearson Suhu dan Produktivitas: -0.085


### Uji Granger Causality
```{r}
# Melakukan uji Granger Causality 
granger_padi_sumatera8 <- causality(var_model_Padi_sumatera2, cause = "Curah_hujan")
granger_padi_sumatera8

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_padi_sumatera9 <- causality(var_model_Padi_sumatera2, cause = "kelembapan")
granger_padi_sumatera9

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_padi_sumatera10 <- causality(var_model_Padi_sumatera, cause = "Penyinaran_Matahari")
granger_padi_sumatera10

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```


### Uji regresi linier
```{r}
# Membuat model regresi linier
regresi_padi_sumatera2 <- lm(Produktivitas ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = padi_var_sumatera2)

# Ringkasan hasil model
summary(regresi_padi_sumatera2)
```


KESIMPULAN



## Produksi Jagung - VAR

```{r}
#Mengambil tanaman pangan padi di pulau sumatera
Iklim_jagung <- Iklim_clean %>%
  filter(Jenis_Komoditi == "Jagung") 

Iklim_jagung
```

```{r}
# Pilih variabel yang akan diprediksi

jagung_var_sumatera1 <- Iklim_jagung[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
jagung_var_sumatera1
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_jagung_sumatera <- ts(jagung_var_sumatera1, start = c(2006,1), frequency = 1)
ts_jagung_sumatera
```


```{r}
best_lag_jagung_sumatera<- VARselect(ts_jagung_sumatera, lag.max = 5, type = "both")
best_lag_jagung_sumatera
```

### VAR Model Iklim terhadap produksi Jagung sumatera
```{r}

var_model_jagung_sumatera <- VAR(ts_jagung_sumatera, p = best_lag_jagung_sumatera$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_jagung_sumatera)
```

### Uji Kolereasi Pearson
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung1 <- cor(jagung_var_sumatera1$Produksi, jagung_var_sumatera1$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_jagung1)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: 0.011

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung3 <- cor(jagung_var_sumatera1$Produksi, jagung_var_sumatera1$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", kolerasi_jagung3)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:  -0.35

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung4 <- cor(jagung_var_sumatera1$Produksi, jagung_var_sumatera1$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produksi:", kolerasi_jagung4)
```
Koefisien Korelasi Pearson Kelembapan dan Produksi: -.19

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung5 <- cor(jagung_var_sumatera1$Produksi, jagung_var_sumatera1$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi:", kolerasi_jagung5)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi: 0.14

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung6 <- cor(jagung_var_sumatera1$Produksi, jagung_var_sumatera1$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produksi:", kolerasi_jagung6)
```
Koefisien Korelasi Pearson Suhu dan Produksi: 0.05

### Uji Granger Causality
```{r}
# Melakukan uji Granger Causality 
granger_jagung_sumatera1 <- causality(var_model_jagung_sumatera, cause = "Curah_hujan")
granger_jagung_sumatera1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_jagung_sumatera2 <- causality(var_model_jagung_sumatera, cause = "kelembapan")
granger_jagung_sumatera2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_jagung_sumatera3 <- causality(var_model_jagung_sumatera, cause = "Suhu")
granger_jagung_sumatera3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier
```{r}
# Membuat model regresi linier
regresi_jagung_sumatera1 <- lm(Produksi ~ Curah_hujan + Kelembapan  + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = jagung_var_sumatera1)

# Ringkasan hasil model
summary(regresi_jagung_sumatera1)
```


## Produktivitas Jagung - VAR

```{r}
# Pilih variabel yang akan diprediksi

jagung_var_sumatera2 <- Iklim_jagung[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
jagung_var_sumatera2
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_jagung_sumatera2 <- ts(jagung_var_sumatera2, start = c(2006,1), frequency = 1)
ts_jagung_sumatera2
```


```{r}
best_lag_jagung_sumatera2<- VARselect(ts_jagung_sumatera2, lag.max = 5, type = "both")
best_lag_jagung_sumatera2
```

### VAR Model Iklim terhadap produktivitas Jagung sumatera
```{r}

var_model_jagung_sumatera2 <- VAR(ts_jagung_sumatera2, p = best_lag_jagung_sumatera2$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_jagung_sumatera2)
```

### Uji kolerasi Pearson jagung
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_padi7 <- cor(jagung_var_sumatera2$Produktivitas, jagung_var_sumatera2$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_padi7)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: 0.0405


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung9 <- cor(jagung_var_sumatera2$Produktivitas, jagung_var_sumatera2$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas:", kolerasi_jagung9)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas: -0.65

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung10<- cor(jagung_var_sumatera2$Produktivitas, jagung_var_sumatera2$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produktivitas:", kolerasi_jagung10)
```
Koefisien Korelasi Pearson Kelembapan dan Produktivitas: -0.044

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung11 <- cor(jagung_var_sumatera2$Produktivitas, jagung_var_sumatera2$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas:", kolerasi_jagung11)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas : -0.074

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_jagung12 <- cor(jagung_var_sumatera2$Produktivitas, jagung_var_sumatera2$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produktivitas:", kolerasi_jagung12)
```
Koefisien Korelasi Pearson Suhu dan Produktivitas: -0.16

### Uji Granger Causality produktivitas jagung
```{r}
# Melakukan uji Granger Causality 
granger_jagung_produktivitas1 <- causality(var_model_jagung_sumatera2, cause = "Curah_hujan")
granger_jagung_produktivitas1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_jagung_produktivitas2 <- causality(var_model_jagung_sumatera, cause = "kelembapan")
granger_jagung_produktivitas2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_jagung_produktivitas3 <- causality(var_model_jagung_sumatera, cause = "Suhu")
granger_jagung_produktivitas3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier produktivitas Jagung
```{r}
# Membuat model regresi linier
regresi_jagung_sumatera2 <- lm(Produktivitas ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = jagung_var_sumatera2)

# Ringkasan hasil model
summary(regresi_jagung_sumatera2)
```



##  Produksi Ubi Jalar - VAR

```{r}
#Mengambil tanaman pangan ubi jalar di pulau sumatera
Iklim_ubi_jalar <- Iklim_clean %>%
  filter(Jenis_Komoditi == "Ubi Jalar") 

Iklim_ubi_jalar
```


```{r}
# Pilih variabel yang akan diprediksi

ubi_jalar_var_sumatera1 <- Iklim_ubi_jalar[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
ubi_jalar_var_sumatera1
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_ubi_jalar_sumatera <- ts(ubi_jalar_var_sumatera1, start = c(2006,1), frequency = 1)
ts_ubi_jalar_sumatera
```


```{r}
lag_ubijalar_sumatera<- VARselect(ts_ubi_jalar_sumatera, lag.max = 5, type = "both")
lag_ubijalar_sumatera
```

### VAR Model Iklim terhadap produksi ubi jalar Sumatera
```{r}
var_model_ubijalar_sumatera <- VAR(ts_ubi_jalar_sumatera, p = lag_ubijalar_sumatera$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_ubijalar_sumatera)
```

### Uji kolerasi pearson produksi ubi jalar Sumatera
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubi_jalar1 <- cor(ubi_jalar_var_sumatera1$Produksi, ubi_jalar_var_sumatera1$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_ubi_jalar1)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: 0.19


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar3 <- cor(ubi_jalar_var_sumatera1$Produksi, ubi_jalar_var_sumatera1$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", kolerasi_ubijalar3)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:  -0.51

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar4 <- cor(ubi_jalar_var_sumatera1$Produksi, ubi_jalar_var_sumatera1$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produksi:", kolerasi_ubijalar4)
```
Koefisien Korelasi Pearson Kelembapan dan Produksi: -0.003

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar5 <- cor(ubi_jalar_var_sumatera1$Produksi, ubi_jalar_var_sumatera1$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi:", kolerasi_ubijalar5)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi: -0.24

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar6 <- cor(ubi_jalar_var_sumatera1$Produksi, ubi_jalar_var_sumatera1$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produksi:", kolerasi_ubijalar6)
```
Koefisien Korelasi Pearson Suhu dan Produksi: 0.016

### Uji Granger Causality produksi Ubijalar
```{r}
# Melakukan uji Granger Causality 
granger_ubijalar_sumatera1 <- causality(var_model_ubijalar_sumatera, cause = "Curah_hujan")
granger_ubijalar_sumatera1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_ubijalar_sumatera2 <- causality(var_model_ubijalar_sumatera, cause = "kelembapan")
granger_ubijalar_sumatera2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_ubijalar_sumatera3 <- causality(var_model_ubijalar_sumatera, cause = "Kecepatan_Angin")
granger_ubijalar_sumatera3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier produksi Ubijalar
```{r}
# Membuat model regresi linier
regresi_ubijalar_sumatera1 <- lm(Produksi ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = ubi_jalar_var_sumatera1)

# Ringkasan hasil model
summary(regresi_ubijalar_sumatera1)
```


##Produktivitas Ubi Jalar - VAR

```{r}
# Pilih variabel yang akan diprediksi

ubijalar_var_sumatera2 <- Iklim_ubi_jalar[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
ubijalar_var_sumatera2
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_ubijalar_sumatera2 <- ts(ubijalar_var_sumatera2, start = c(2006,1), frequency = 1)
ts_ubijalar_sumatera2
```

```{r}
lag_ubijalar_sumatera2<- VARselect(ts_ubijalar_sumatera2, lag.max = 5, type = "both")
lag_ubijalar_sumatera2
```

### VAR Model Iklim terhadap produktivitas Ubijalar sumatera
```{r}

var_model_ubijalar_sumatera2 <- VAR(ts_ubijalar_sumatera2, p = lag_ubijalar_sumatera2$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_ubijalar_sumatera2)
```

### Uji Kolerasi person Produktivitas Ubi jalar
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar7 <- cor(ubijalar_var_sumatera2$Produktivitas, ubijalar_var_sumatera2$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_ubijalar7)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: -0.017


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar9 <- cor(ubijalar_var_sumatera2$Produktivitas, ubijalar_var_sumatera2$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas:", kolerasi_jagung9)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas: -0.65

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar10<- cor(ubijalar_var_sumatera2$Produktivitas, ubijalar_var_sumatera2$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produktivitas:", kolerasi_ubijalar10)
```
Koefisien Korelasi Pearson Kelembapan dan Produktivitas: 0.05

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar11 <- cor(ubijalar_var_sumatera2$Produktivitas, ubijalar_var_sumatera2$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas:", kolerasi_ubijalar11)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas : -0.26

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubijalar12 <- cor(ubijalar_var_sumatera2$Produktivitas, ubijalar_var_sumatera2$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produktivitas:", kolerasi_ubijalar12)
```
Koefisien Korelasi Pearson Suhu dan Produktivitas: -0.2519937

### Uji Granger Causality produktivitas Ubijalar
```{r}
# Melakukan uji Granger Causality 
granger_ubijalar_produktivitas1 <- causality(var_model_ubijalar_sumatera2, cause = "Curah_hujan")
granger_ubijalar_produktivitas1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_ubijalar_produktivitas2 <- causality(var_model_ubijalar_sumatera2, cause = "kelembapan")
granger_ubijalar_produktivitas2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_ubijalar_produktivitas3 <- causality(var_model_ubijalar_sumatera2, cause = "Kecepatan_Angin")
granger_ubijalar_produktivitas3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier produktivitas Ubi Jalar
```{r}
# Membuat model regresi linier
regresi_ubijalar_sumatera2 <- lm(Produktivitas ~ Curah_hujan + Kelembapan  + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = ubijalar_var_sumatera2)

# Ringkasan hasil model
summary(regresi_ubijalar_sumatera2)
```


## Produksi Ubi Kayu - VAR

```{r}
#Mengambil tanaman pangan ubi kayu di pulau sumatera
Iklim_ubikayu <- Iklim_clean %>%
  filter(Jenis_Komoditi == "Ubi Kayu") 

Iklim_ubikayu
```

```{r}
# Pilih variabel yang akan diprediksi

ubikayu_var_sumatera1 <- Iklim_ubikayu[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
ubikayu_var_sumatera1
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_ubikayu_sumatera <- ts(ubikayu_var_sumatera1, start = c(2006,1), frequency = 1)
ts_ubikayu_sumatera
```


```{r}
lag_ubikayu_sumatera<- VARselect(ts_ubikayu_sumatera, lag.max = 5, type = "both")
lag_ubikayu_sumatera
```

### VAR Model Iklim terhadap produksi ubi jalar Sumatera
```{r}
var_model_ubikayu_sumatera <- VAR(ts_ubikayu_sumatera, p = lag_ubikayu_sumatera$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_ubikayu_sumatera)
```

### Uji kolerasi pearson produksi ubi jalar Sumatera
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu1 <- cor(ubikayu_var_sumatera1$Produksi, ubikayu_var_sumatera1$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_ubikayu1)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: -0.10

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu3 <- cor(ubikayu_var_sumatera1$Produksi, ubikayu_var_sumatera1$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", kolerasi_ubikayu3)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:  -0.17

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu4 <- cor(ubikayu_var_sumatera1$Produksi, ubikayu_var_sumatera1$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produksi:", kolerasi_ubikayu4)
```
Koefisien Korelasi Pearson Kelembapan dan Produksi: -0.21

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu5 <- cor(ubikayu_var_sumatera1$Produksi, ubikayu_var_sumatera1$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi:", kolerasi_ubikayu5)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi: 0.31

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu6 <- cor(ubikayu_var_sumatera1$Produksi, ubikayu_var_sumatera1$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produksi:", kolerasi_ubikayu6)
```
Koefisien Korelasi Pearson Suhu dan Produksi: -0.005

### Uji Granger Causality produksi ubi kayu
```{r}
# Melakukan uji Granger Causality 
granger_ubikayu_sumatera1 <- causality(var_model_ubikayu_sumatera, cause = "Curah_hujan")
granger_ubikayu_sumatera1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_ubikayu_sumatera2 <- causality(var_model_ubikayu_sumatera, cause = "kelembapan")
granger_ubikayu_sumatera2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_ubikayu_sumatera3 <- causality(var_model_ubikayu_sumatera, cause = "Suhu")
granger_ubikayu_sumatera3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier produksi Ubijalar
```{r}
# Membuat model regresi linier
regresi_ubikayu_sumatera1 <- lm(Produksi ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = ubikayu_var_sumatera1)

# Ringkasan hasil model
summary(regresi_ubikayu_sumatera1)
```


## Produktivitas Ubi jalar - VAR

```{r}
# Pilih variabel yang akan diprediksi

ubikayu_var_sumatera2 <- Iklim_ubikayu[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
ubikayu_var_sumatera2
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_ubikayu_sumatera2 <- ts(ubikayu_var_sumatera2, start = c(2006,1), frequency = 1)
ts_ubikayu_sumatera2
```


```{r}
lag_ubikayu_sumatera2<- VARselect(ts_ubikayu_sumatera2, lag.max = 5, type = "both")
lag_ubikayu_sumatera2
```

### VAR Model Iklim terhadap produktivitas Ubi kayu sumatera
```{r}

var_model_ubikayu_sumatera2 <- VAR(ts_ubikayu_sumatera2, p = lag_ubikayu_sumatera2$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_ubikayu_sumatera2)
```

### Uji Kolerasi person Produktivitas Ubi kayu
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu7 <- cor(ubikayu_var_sumatera2$Produktivitas, ubikayu_var_sumatera2$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_ubikayu7)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: -0.011


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu9 <- cor(ubikayu_var_sumatera2$Produktivitas, ubikayu_var_sumatera2$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas:", kolerasi_ubikayu9)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas: -0.51

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu10<- cor(ubikayu_var_sumatera2$Produktivitas, ubikayu_var_sumatera2$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produktivitas:", kolerasi_ubikayu10)
```
Koefisien Korelasi Pearson Kelembapan dan Produktivitas: -0.19

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu11 <- cor(ubikayu_var_sumatera2$Produktivitas, ubikayu_var_sumatera2$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas:", kolerasi_ubikayu11)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas : -0.14

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_ubikayu12 <- cor(ubikayu_var_sumatera2$Produktivitas, ubikayu_var_sumatera2$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produktivitas:", kolerasi_ubikayu12)
```
Koefisien Korelasi Pearson Suhu dan Produktivitas: -0.06

### Uji Granger Causality produktivitas UbiKayu
```{r}
# Melakukan uji Granger Causality 
granger_ubikayu_produktivitas1 <- causality(var_model_ubikayu_sumatera2, cause = "Curah_hujan")
granger_ubikayu_produktivitas1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_ubikayu_produktivitas2 <- causality(var_model_ubikayu_sumatera2, cause = "kelembapan")
granger_ubikayu_produktivitas2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_ubikayu_produktivitas3 <- causality(var_model_ubikayu_sumatera2, cause = "Suhu")
granger_ubikayu_produktivitas3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier produktivitas Ubi Kayu
```{r}
# Membuat model regresi linier
regresi_ubikayu_sumatera2 <- lm(Produktivitas ~ Curah_hujan + Kelembapan  + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = ubikayu_var_sumatera2)

# Ringkasan hasil model
summary(regresi_ubikayu_sumatera2)
```


## Produksi Kacang kedelai - VAR

```{r}
#Mengambil tanaman pangan Kacang kedelai di pulau sumatera
Iklim_Kedelai<- Iklim_clean %>%
  filter(Jenis_Komoditi == "Kedelai") 

Iklim_Kedelai
```

```{r}
# Pilih variabel yang akan diprediksi

kedelai_var_sumatera1<- Iklim_Kedelai[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
kedelai_var_sumatera1
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_kedelai_sumatera1 <- ts(kedelai_var_sumatera1, start = c(2006,1), frequency = 1)
ts_kedelai_sumatera1
```


```{r}
lag_kedelai_sumatera1<- VARselect(ts_kedelai_sumatera1, lag.max = 5, type = "both")
lag_kedelai_sumatera1
```

### VAR Model Iklim terhadap produksi kedelai Sumatera
```{r}
var_model_kedelai_sumatera1 <- VAR(ts_kedelai_sumatera1, p = lag_kedelai_sumatera1$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_kedelai_sumatera1)
```

### Uji kolerasi pearson produksi kedelai Sumatera
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai1 <- cor(kedelai_var_sumatera1$Produksi, kedelai_var_sumatera1$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_kedelai1)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: -0.037


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai3 <- cor(kedelai_var_sumatera1$Produksi, kedelai_var_sumatera1$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", kolerasi_kedelai3)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:  0.13

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai4 <- cor(kedelai_var_sumatera1$Produksi, kedelai_var_sumatera1$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produksi:", kolerasi_kedelai4)
```
Koefisien Korelasi Pearson Kelembapan dan Produksi: -0.16

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai5 <- cor(kedelai_var_sumatera1$Produksi, kedelai_var_sumatera1$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi:", kolerasi_kedelai5)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi: 0.041

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai6 <- cor(kedelai_var_sumatera1$Produksi, kedelai_var_sumatera1$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produksi:", kolerasi_kedelai6)
```
Koefisien Korelasi Pearson Suhu dan Produksi: 0.059

### Uji Granger Causality produksi kacang kedelai
```{r}
# Melakukan uji Granger Causality 
granger_kedelai_sumatera1 <- causality(var_model_kedelai_sumatera1, cause = "Curah_hujan")
granger_kedelai_sumatera1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_kedelai_sumatera2 <- causality(var_model_kedelai_sumatera1, cause = "kelembapan")
granger_kedelai_sumatera2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_kedelai_sumatera3 <- causality(var_model_kedelai_sumatera1, cause = "Suhu")
granger_kedelai_sumatera3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier produksi kacang kedelai
```{r}
# Membuat model regresi linier
regresi_kedelai_sumatera1 <- lm(Produksi ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = kedelai_var_sumatera1)

# Ringkasan hasil model
summary(regresi_kedelai_sumatera1)
```


## Produktivitas Kacang kedelai - VAR

```{r}
# Pilih variabel yang akan diprediksi

kedelai_var_sumatera2 <- Iklim_Kedelai[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
kedelai_var_sumatera2
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_kedelai_sumatera2 <- ts(kedelai_var_sumatera2, start = c(2006,1), frequency = 1)
ts_kedelai_sumatera2
```


```{r}
lag_kedelai_sumatera2<- VARselect(ts_kedelai_sumatera2, lag.max = 5, type = "both")
lag_kedelai_sumatera2
```

### VAR Model Iklim terhadap produktivitas kedelai sumatera
```{r}

var_model_kedelai_sumatera2 <- VAR(ts_kedelai_sumatera2, p = lag_kedelai_sumatera2$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_kedelai_sumatera2)
```

### Uji Kolerasi person Produktivitas kedelai
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai7 <- cor(kedelai_var_sumatera2$Produktivitas, kedelai_var_sumatera2$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_kedelai7)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: -0.015


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai9 <- cor(kedelai_var_sumatera2$Produktivitas, kedelai_var_sumatera2$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas:", kolerasi_kedelai9)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas: -0.25

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai10<- cor(kedelai_var_sumatera2$Produktivitas, kedelai_var_sumatera2$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produktivitas:", kolerasi_kedelai10)
```
Koefisien Korelasi Pearson Kelembapan dan Produktivitas: 0.01

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai11 <- cor(kedelai_var_sumatera2$Produktivitas, kedelai_var_sumatera2$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas:", kolerasi_kedelai11)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas : -0.26

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kedelai12 <- cor(kedelai_var_sumatera2$Produktivitas, kedelai_var_sumatera2$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produktivitas:", kolerasi_kedelai12)
```
Koefisien Korelasi Pearson Suhu dan Produktivitas: -0.14

### Uji Granger Causality produktivitas Ubijalar
```{r}
# Melakukan uji Granger Causality 
granger_kedelai_produktivitas1 <- causality(var_model_kedelai_sumatera2, cause = "Curah_hujan")
granger_kedelai_produktivitas1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_kedelai_produktivitas2 <- causality(var_model_kedelai_sumatera2, cause = "kelembapan")
granger_kedelai_produktivitas2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_kedelai_produktivitas3 <- causality(var_model_kedelai_sumatera2, cause = "Suhu")
granger_kedelai_produktivitas3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```


### Uji regresi linier produktivitas kacang kedelai
```{r}
# Membuat model regresi linier
regresi_kedelai_sumatera2 <- lm(Produktivitas ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = kedelai_var_sumatera2)

# Ringkasan hasil model
summary(regresi_kedelai_sumatera2)
```


## Produksi Kacang Hijau - VAR

```{r}
#Mengambil tanaman pangan Kacang Hijau di pulau sumatera
Iklim_kacanghijau<- Iklim_clean %>%
  filter(Jenis_Komoditi == "Kacang Hijau") 

Iklim_kacanghijau
```


```{r}
# Pilih variabel yang akan diprediksi

kacanghijau_var_sumatera1<- Iklim_kacanghijau[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
kacanghijau_var_sumatera1
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_kacanghijau_sumatera1 <- ts(kacanghijau_var_sumatera1, start = c(2006,1), frequency = 1)
ts_kacanghijau_sumatera1
```


```{r}
lag_kacanghijau_sumatera1<- VARselect(ts_kacanghijau_sumatera1, lag.max = 5, type = "both")
lag_kacanghijau_sumatera1
```

### VAR Model Iklim terhadap produksi kacang hijau Sumatera
```{r}
var_model_kacanghijau_sumatera1 <- VAR(ts_kacanghijau_sumatera1, p = lag_kacanghijau_sumatera1$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_kacanghijau_sumatera1)
```

### Uji kolerasi pearson produksi kacang hijau Sumatera
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau1 <- cor(kacanghijau_var_sumatera1$Produksi, kacanghijau_var_sumatera1$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_kacanghijau1)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: 0.16


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau3 <- cor(kacanghijau_var_sumatera1$Produksi, kacanghijau_var_sumatera1$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", kolerasi_kacanghijau3)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:  -0.20

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau4 <- cor(kacanghijau_var_sumatera1$Produksi, kacanghijau_var_sumatera1$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produksi:", kolerasi_kacanghijau4)
```
Koefisien Korelasi Pearson Kelembapan dan Produksi: -0.10

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau5 <- cor(kacanghijau_var_sumatera1$Produksi, kacanghijau_var_sumatera1$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi:", kolerasi_kacanghijau5)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi: 0.073

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau6 <- cor(kacanghijau_var_sumatera1$Produksi, kacanghijau_var_sumatera1$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produksi:", kolerasi_kacanghijau6)
```
Koefisien Korelasi Pearson Suhu dan Produksi: 0.14


### Uji Granger Causality produksi kacang hijau
```{r}
# Melakukan uji Granger Causality 
granger_kacanghijau_sumatera1 <- causality(var_model_kacanghijau_sumatera1, cause = "Curah_hujan")
granger_kacanghijau_sumatera1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```


```{r}
# Melakukan uji Granger Causality 
granger_kacanghijau_sumatera3 <- causality(var_model_kacanghijau_sumatera1, cause = "Suhu")
granger_kacanghijau_sumatera3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier produksi kacang hijau
```{r}
# Membuat model regresi linier
regresi_kacanghijau_sumatera1 <- lm(Produksi ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = kacanghijau_var_sumatera1)

# Ringkasan hasil model
summary(regresi_kacanghijau_sumatera1)
```
Kesimpulan
Variabel yg memiliki hubungan dengan produksi adalah Luas panen=<2e-16*** ,Penyinaran matahari=0.0182* , kelembapan=0.0314* dengan f-statistik p-va;uenya adalah < 2.2e-16

## Analisis Iklim terhadap Produktivitas Kacang Hijau Sumatera

```{r}
# Pilih variabel yang akan diprediksi

kacanghijau_var_sumatera2 <- Iklim_kacanghijau[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
kacanghijau_var_sumatera2
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_kacanghijau_sumatera2 <- ts(kacanghijau_var_sumatera2, start = c(2006,1), frequency = 1)
ts_kacanghijau_sumatera2
```


```{r}
lag_kacanghijau_sumatera2<- VARselect(ts_kacanghijau_sumatera2, lag.max = 5, type = "both")
lag_kacanghijau_sumatera2
```

### VAR Model Iklim terhadap produktivitas kacanghijau sumatera
```{r}

var_model_kacanghijau_sumatera2 <- VAR(ts_kacanghijau_sumatera2, p = lag_kacanghijau_sumatera2$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_kacanghijau_sumatera2)
```

### Uji Kolerasi person Produktivitas kacanghijau
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau7 <- cor(kacanghijau_var_sumatera2$Produktivitas, kacanghijau_var_sumatera2$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_kacanghijau7)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: 0.36


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau9 <- cor(kacanghijau_var_sumatera2$Produktivitas, kacanghijau_var_sumatera2$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas:", kolerasi_kacanghijau9)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas: -0.15

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau10<- cor(kacanghijau_var_sumatera2$Produktivitas, kacanghijau_var_sumatera2$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produktivitas:", kolerasi_kacanghijau10)
```
Koefisien Korelasi Pearson Kelembapan dan Produktivitas: 0.08

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau11 <- cor(kacanghijau_var_sumatera2$Produktivitas, kacanghijau_var_sumatera2$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas:", kolerasi_kacanghijau11)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas : -0.39

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacanghijau12 <- cor(kacanghijau_var_sumatera2$Produktivitas, kacanghijau_var_sumatera2$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produktivitas:", kolerasi_kacanghijau12)
```
Koefisien Korelasi Pearson Suhu dan Produktivitas: -0.071

### Uji Granger Causality produktivitas kacanghijau
```{r}
# Melakukan uji Granger Causality 
granger_kacanghijau_produktivitas1 <- causality(var_model_kacanghijau_sumatera2, cause = "Curah_hujan")
granger_kacanghijau_produktivitas1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```


```{r}
# Melakukan uji Granger Causality 
granger_kacanghijau_produktivitas3 <- causality(var_model_kacanghijau_sumatera2, cause = "Suhu")
granger_kacanghijau_produktivitas3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```


### Uji regresi linier produktivitas kacang Hijau
```{r}
# Membuat model regresi linier
regresi_kacanghijau_sumatera2 <- lm(Produktivitas ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = kacanghijau_var_sumatera2)

# Ringkasan hasil model
summary(regresi_kacanghijau_sumatera2)
```
Kesimpulan uji regresi linier : hanya terdapat pengaruh variabel penyinaran matahari terhadap produktivitas Kacang hijau dengan p-valuenya = 0.00973 ** dan nilai f statistiknya p-valuennya adalah 0.002694


## Produksi Kacang Tanah - VAR

```{r}
#Mengambil tanaman pangan Kacang kedelai di pulau sumatera
Iklim_kacangtanah<- Iklim_clean %>%
  filter(Jenis_Komoditi == "Kacang Tanah") 

Iklim_kacangtanah
```

```{r}
# Pilih variabel yang akan diprediksi

kacangtanah_var_sumatera1<- Iklim_kacangtanah[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
kacangtanah_var_sumatera1
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_kacangtanah_sumatera1 <- ts(kacangtanah_var_sumatera1, start = c(2006,1), frequency = 1)
ts_kacangtanah_sumatera1
```


```{r}
lag_kacangtanah_sumatera1<- VARselect(ts_kacangtanah_sumatera1, lag.max = 5, type = "both")
lag_kacangtanah_sumatera1
```

### VAR Model Iklim terhadap produksi kacangtanah Sumatera
```{r}
var_model_kacangtanah_sumatera1 <- VAR(ts_kacangtanah_sumatera1, p = lag_kacangtanah_sumatera1$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_kacangtanah_sumatera1)
```

### Uji kolerasi pearson produksi kacangtanah Sumatera
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah1 <- cor(kacangtanah_var_sumatera1$Produksi, kacangtanah_var_sumatera1$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_kacangtanah1)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: 0.2669739



```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah3 <- cor(kacangtanah_var_sumatera1$Produksi, kacangtanah_var_sumatera1$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:", kolerasi_kacangtanah3)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produksi:  -0.4686038

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah4 <- cor(kacangtanah_var_sumatera1$Produksi, kacangtanah_var_sumatera1$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produksi:", kolerasi_kacangtanah4)
```
Koefisien Korelasi Pearson Kelembapan dan Produksi: -0.14

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah5 <- cor(kacangtanah_var_sumatera1$Produksi, kacangtanah_var_sumatera1$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi:", kolerasi_kacangtanah5)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produksi: -0.038

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah6 <- cor(kacangtanah_var_sumatera1$Produksi, kacangtanah_var_sumatera1$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produksi:", kolerasi_kacangtanah6)
```
Koefisien Korelasi Pearson Suhu dan Produksi: -0.049

### Uji Granger Causality produksi kacang tanah
```{r}
# Melakukan uji Granger Causality 
granger_kacangtanah_sumatera1 <- causality(var_model_kacangtanah_sumatera1, cause = "Curah_hujan")
granger_kacangtanah_sumatera1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_kacangtanah_sumatera2 <- causality(var_model_kacangtanah_sumatera1, cause = "kelembapan")
granger_kacangtanah_sumatera2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_kacangtanah_sumatera3 <- causality(var_model_kacangtanah_sumatera1, cause = "Suhu")
granger_kacangtanah_sumatera3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

### Uji regresi linier produksi kacang tanah
```{r}
# Membuat model regresi linier
regresi_kacangtanah_sumatera1 <- lm(Produksi ~ Curah_hujan + Kelembapan + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = kacangtanah_var_sumatera1)

# Ringkasan hasil model
summary(regresi_kacangtanah_sumatera1)
```
Kesimpulan
suhu p-valuenya = 0.02125* , Kecepatan_Angin  p-valuenya = 0.00642**  dengna  nilai f-statistik pa-valuenya adalah < 2.2e-16 

##  Produktivitas Kacang tanah - VAR

```{r}
# Pilih variabel yang akan diprediksi

kacangtanah_var_sumatera2 <- Iklim_kacangtanah[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
kacangtanah_var_sumatera2
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_kacangtanah_sumatera2 <- ts(kacangtanah_var_sumatera2, start = c(2006,1), frequency = 1)
ts_kacangtanah_sumatera2
```


```{r}
lag_kacangtanah_sumatera2<- VARselect(ts_kacangtanah_sumatera2, lag.max = 5, type = "both")
lag_kacangtanah_sumatera2
```

### VAR Model Iklim terhadap produktivitas kacang tanah sumatera
```{r}

var_model_kacangtanah_sumatera2 <- VAR(ts_kacangtanah_sumatera2, p = lag_kacangtanah_sumatera2$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_kacangtanah_sumatera2)
```

### Uji Kolerasi person Produktivitas tanah
```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah7 <- cor(kacangtanah_var_sumatera2$Produktivitas, kacangtanah_var_sumatera2$Curah_hujan)
cat ("Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi:",kolerasi_kacangtanah7)
```
Koefisien Korelasi Pearson Rata-rata Curah hujan dan Produksi: 0.086


```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah9 <- cor(kacangtanah_var_sumatera2$Produktivitas, kacangtanah_var_sumatera2$Kecepatan_Angin)
cat ("Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas:", kolerasi_kacangtanah9)
```
Koefisien Korelasi Pearson Kecepatan Angin dan Produktivitas: -0.55

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah10<- cor(kacangtanah_var_sumatera2$Produktivitas, kacangtanah_var_sumatera2$Kelembapan)
cat ("Koefisien Korelasi Pearson Kelembapan dan Produktivitas:", kolerasi_kacangtanah10)
```
Koefisien Korelasi Pearson Kelembapan dan Produktivitas: -0.05

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah11 <- cor(kacangtanah_var_sumatera2$Produktivitas, kacangtanah_var_sumatera2$Penyinaran_Matahari)
cat ("Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas:", kolerasi_kacangtanah11)
```
Koefisien Korelasi Pearson Penyinaran_Matahari dan Produktivitas : -0.04

```{r}
# Menghitung koefisien korelasi Pearson
kolerasi_kacangtanah12 <- cor(kacangtanah_var_sumatera2$Produktivitas, kacangtanah_var_sumatera2$Suhu)
cat ("Koefisien Korelasi Pearson Suhu dan Produktivitas:", kolerasi_kacangtanah12)
```
Koefisien Korelasi Pearson Suhu dan Produktivitas: -0.16

### Uji Granger Causality produktivitas kacang tanah
```{r}
# Melakukan uji Granger Causality 
granger_kacangtanah_produktivitas1 <- causality(var_model_kacangtanah_sumatera2, cause = "Curah_hujan")
granger_kacangtanah_produktivitas1

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_kacangtanah_produktivitas2 <- causality(var_model_kacangtanah_sumatera2, cause = "Kelembapan")
granger_kacangtanah_produktivitas2

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```

```{r}
# Melakukan uji Granger Causality 
granger_kacangtanah_produktivitas3 <- causality(var_model_kacangtanah_sumatera2, cause = "Suhu")
granger_kacangtanah_produktivitas3

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```


### Uji regresi linier produktivitas kacang tanah
```{r}
# Membuat model regresi linier
regresi_kacang_tanah2 <- lm(Produktivitas ~ Curah_hujan + Kelembapan  + Suhu + Kecepatan_Angin + Penyinaran_Matahari, data = kacangtanah_var_sumatera2)

# Ringkasan hasil model
summary(regresi_kacang_tanah2)
```
Kesimpulan uji regresi linier:
Terdapat pengaruh kecepatan angin dengan p-value 4.43e-06 *** terhadap produktivitas kacang tanah dan nilai f-statistik p-valuenya adalah 4.819e-07



# B. MODEL GLM
Melakukan Analisis Iklim terhadap tanaman pangan di pulau Sumatera tahun 2006-2015 dengan model GLM

## Produksi padi - GLM
```{r}
# Pilih variabel yang akan diprediksi
produksi_padi_glm <- Iklim_padi[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produksi_padi_glm
```

```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_produksi_padi <- sample.split(produksi_padi_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_ps_padi_glm <- subset(produksi_padi_glm, split_produksi_padi == TRUE)
test_ps_padi_glm <- subset(produksi_padi_glm, split_produksi_padi == FALSE)
```

```{r}
dim(train_ps_padi_glm)
dim(test_ps_padi_glm)
```

### GLM model Iklim terhadap Produksi padi
```{r}
#model GLM
glm_produksi_padi <- glm(Produksi ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = train_ps_padi_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_produksi_padi)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_ps_padi_glm <- predict(glm_produksi_padi, newdata = test_ps_padi_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_ps_padi_glm)
```
```{r}
head(predict_ps_padi_glm)
```

```{r}
# Visualisasi Hasil
result_ps_padi_glm <- data.frame(Produksi_1 = test_ps_padi_glm$Produksi, Predictions_1 = predict_ps_padi_glm)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_padi_glm, aes(x = Produksi_1, y = Predictions_1)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produksi", y = "Predicted Produksi") +
  ggtitle("Comparison of Actual Produksi and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_padi_glm, aes(x = 1:length(Produksi_1))) +
  geom_line(aes(y = Produksi_1, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_1, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produksi") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_1 <- mae(test_ps_padi_glm$Produksi, predict_ps_padi_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_1 <- mse(tes_ps_padi_glm$Produksi, predict_ps_padi_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_1 <- rmse(test_ps_padi_glm$Produksi, predict_ps_padi_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_1 <- mape(test_ps_padi_glm$Produksi, predict_ps_padi_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_1, "\n"))
cat(paste("MSE: ", mse_value_glm_1, "\n"))
cat(paste("RMSE: ", rmse_value_glm_1, "\n"))
cat(paste("MAPE: ", mape_value_glm_1, "%\n"))
```
MAE:  1272921.36158324 
MSE:  2100608327097.84 
RMSE:  1449347.55221025 
MAPE:  160.734034463418 %


## Produktivitas Padi - GLM
```{r}
# Pilih variabel yang akan diprediksi
produktivitas_padi_glm <- Iklim_padi[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produktivitas_padi_glm
```


```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_pt_padi <- sample.split(produktivitas_padi_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_pt_padi_glm <- subset(produktivitas_padi_glm, split_pt_padi == TRUE)
test_pt_padi_glm <- subset(produktivitas_padi_glm, split_pt_padi == FALSE)
```

```{r}
dim(train_pt_padi_glm)
dim(test_pt_padi_glm)
```


### GLM model Iklim terhadap Produktivitas padi
```{r}
glm_Produktivitas_padi <- glm(Produktivitas ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = test_pt_padi_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_Produktivitas_padi)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_pt_padi_glm <- predict(glm_Produktivitas_padi, newdata = test_pt_padi_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_pt_padi_glm)
```

```{r}
# Visualisasi Hasil
result_pt_padi_glm <- data.frame(Produktivitas_1 = test_pt_padi_glm$Produktivitas, Predictions_2 = predict_pt_padi_glm)

# Visualisasi Perbandingan Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_padi_glm, aes(x = Produktivitas_1, y = Predictions_2)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produktivitas", y = "Predicted Produktivitas") +
  ggtitle("Comparison of Actual Produktivitas and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_padi_glm, aes(x = 1:length(Produktivitas_1))) +
  geom_line(aes(y = Produktivitas_1, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_2, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produktivitas") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_2 <- mae(test_pt_padi_glm$Produktivitas, predict_pt_padi_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_2 <- mse(test_pt_padi_glm$Produktivitas, predict_pt_padi_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_2 <- rmse(test_pt_padi_glm$Produktivitas, predict_pt_padi_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_2 <- mape(test_pt_padi_glm$Produktivitas, predict_pt_padi_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_2, "\n"))
cat(paste("MSE: ", mse_value_glm_2, "\n"))
cat(paste("RMSE: ", rmse_value_glm_2, "\n"))
cat(paste("MAPE: ", mape_value_glm_2, "%\n"))
```


## Produksi Jagung sumatera - GLM

```{r}
# Pilih variabel yang akan diprediksi
produksi_jagung_glm <- Iklim_jagung[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produksi_jagung_glm
```

```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_produksi_jagung <- sample.split(produksi_jagung_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_ps_jagung_glm <- subset(produksi_jagung_glm, split_produksi_jagung == TRUE)
test_ps_jagung_glm <- subset(produksi_jagung_glm, split_produksi_jagung == FALSE)
```

```{r}
dim(train_ps_jagung_glm)
dim(test_ps_jagung_glm)
```

### GLM model Iklim terhadap Produksi jagung
```{r}
#model GLM
glm_produksi_jagung <- glm(Produksi ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = train_ps_jagung_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_produksi_jagung)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_ps_jagung_glm <- predict(glm_produksi_jagung, newdata = test_ps_jagung_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_ps_jagung_glm)
```
```{r}
head(predict_ps_jagung_glm)
```

```{r}
# Visualisasi Hasil
result_ps_jagung_glm <- data.frame(Produksi_2 = test_ps_jagung_glm$Produksi, Predictions_3 = predict_ps_jagung_glm)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_jagung_glm, aes(x = Produksi_2, y = Predictions_3)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produksi", y = "Predicted Produksi") +
  ggtitle("Comparison of Actual Produksi and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_jagung_glm, aes(x = 1:length(Produksi_2))) +
  geom_line(aes(y = Produksi_2, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_3, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produksi") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_3 <- mae(test_ps_jagung_glm$Produksi, predict_ps_jagung_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_3 <- mse(tes_ps_jagung_glm$Produksi, predict_ps_jagung_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_3 <- rmse(test_ps_jagung_glm$Produksi, predict_ps_jagung_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_3 <- mape(test_ps_jagung_glm$Produksi, predict_ps_jagung_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_3, "\n"))
cat(paste("MSE: ", mse_value_glm_3, "\n"))
cat(paste("RMSE: ", rmse_value_glm_3, "\n"))
cat(paste("MAPE: ", mape_value_glm_3, "%\n"))
```
MAE:  1272921.36158324 
MSE:  2100608327097.84 
RMSE:  1449347.55221025 
MAPE:  160.734034463418 %


## Produktivitas jagung - GLM
```{r}
# Pilih variabel yang akan diprediksi
produktivitas_jagung_glm <- Iklim_jagung[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produktivitas_jagung_glm
```


```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_pt_jagung <- sample.split(produktivitas_jagung_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_pt_jagung_glm <- subset(produktivitas_jagung_glm, split_pt_jagung == TRUE)
test_pt_jagung_glm <- subset(produktivitas_jagung_glm, split_pt_jagung == FALSE)
```

```{r}
dim(train_pt_jagung_glm)
dim(test_pt_jagung_glm)
```


### GLM model Iklim terhadap Produktivitas jagung
```{r}
glm_Produktivitas_jagung <- glm(Produktivitas ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = test_pt_jagung_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_Produktivitas_jagung)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_pt_jagung_glm <- predict(glm_Produktivitas_jagung, newdata = test_pt_jagung_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_pt_jagung_glm)
```

```{r}
# Visualisasi Hasil
result_pt_jagung_glm <- data.frame(Produktivitas_2 = test_pt_jagung_glm$Produktivitas, Predictions_4 = predict_pt_jagung_glm)

# Visualisasi Perbandingan Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_jagung_glm, aes(x = Produktivitas_2, y = Predictions_4)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produktivitas", y = "Predicted Produktivitas") +
  ggtitle("Comparison of Actual Produktivitas and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_jagung_glm, aes(x = 1:length(Produktivitas_2))) +
  geom_line(aes(y = Produktivitas_2, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_4, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produktivitas") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_4 <- mae(test_pt_jagung_glm$Produktivitas, predict_pt_jagung_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_4 <- mse(test_pt_jagung_glm$Produktivitas, predict_pt_jagung_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_4 <- rmse(test_pt_jagung_glm$Produktivitas, predict_pt_jagung_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_4 <- mape(test_pt_jagung_glm$Produktivitas, predict_pt_jagung_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_4, "\n"))
cat(paste("MSE: ", mse_value_glm_4, "\n"))
cat(paste("RMSE: ", rmse_value_glm_4, "\n"))
cat(paste("MAPE: ", mape_value_glm_4, "%\n"))
```


## Produksi ubi_jalar sumatera - GLM

```{r}
# Pilih variabel yang akan diprediksi
produksi_ubijalar_glm <- Iklim_ubi_jalar[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produksi_ubijalar_glm
```

```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_produksi_ubijalar <- sample.split(produksi_ubijalar_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_ps_ubijalar_glm <- subset(produksi_ubijalar_glm, split_produksi_ubijalar == TRUE)
test_ps_ubijalar_glm <- subset(produksi_ubijalar_glm, split_produksi_ubijalar == FALSE)
```

```{r}
dim(train_ps_ubijalar_glm)
dim(test_ps_ubijalar_glm)
```

### GLM model Iklim terhadap Produksi ubijalar
```{r}
#model GLM
glm_produksi_ubijalar <- glm(Produksi ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = train_ps_ubijalar_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_produksi_ubijalar)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_ps_ubijalar_glm <- predict(glm_produksi_ubijalar, newdata = test_ps_ubijalar_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_ps_ubijalar_glm)
```
```{r}
head(predict_ps_ubijalar_glm)
```

```{r}
# Visualisasi Hasil
result_ps_ubijalar_glm <- data.frame(Produksi_3 = test_ps_ubijalar_glm$Produksi, Predictions_5 = predict_ps_ubijalar_glm)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_ubijalar_glm, aes(x = Produksi_3, y = Predictions_5)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produksi", y = "Predicted Produksi") +
  ggtitle("Comparison of Actual Produksi and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_ubijalar_glm, aes(x = 1:length(Produksi_3))) +
  geom_line(aes(y = Produksi_3, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_5, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produksi") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_5 <- mae(test_ps_ubijalar_glm$Produksi, predict_ps_ubijalar_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_5 <- mse(tes_ps_ubijalar_glm$Produksi, predict_ps_ubijalar_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_5 <- rmse(test_ps_ubijalar_glm$Produksi, predict_ps_ubijalar_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_5 <- mape(test_ps_ubijalar_glm$Produksi, predict_ps_ubijalar_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_5, "\n"))
cat(paste("MSE: ", mse_value_glm_5, "\n"))
cat(paste("RMSE: ", rmse_value_glm_5, "\n"))
cat(paste("MAPE: ", mape_value_glm_5, "%\n"))
```
MAE:  1272921.36158324 
MSE:  2100608327097.84 
RMSE:  1449347.55221025 
MAPE:  160.734034463418 %


## Produktivitas ubijalar - GLM
```{r}
# Pilih variabel yang akan diprediksi
produktivitas_ubijalar_glm <- Iklim_ubi_jalar[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produktivitas_ubijalar_glm
```


```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_pt_ubijalar <- sample.split(produktivitas_ubijalar_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_pt_ubijalar_glm <- subset(produktivitas_ubijalar_glm, split_pt_ubijalar == TRUE)
test_pt_ubijalar_glm <- subset(produktivitas_ubijalar_glm, split_pt_ubijalar == FALSE)
```

```{r}
dim(train_pt_ubijalar_glm)
dim(test_pt_ubijalar_glm)
```


### GLM model Iklim terhadap Produktivitas ubijalar
```{r}
glm_Produktivitas_ubijalar <- glm(Produktivitas ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = test_pt_ubijalar_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_Produktivitas_ubijalar)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_pt_ubijalar_glm <- predict(glm_Produktivitas_ubijalar, newdata = test_pt_ubijalar_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_pt_ubijalar_glm)
```

```{r}
# Visualisasi Hasil
result_pt_ubijalar_glm <- data.frame(Produktivitas_3 = test_pt_ubijalar_glm$Produktivitas, Predictions_6 = predict_pt_ubijalar_glm)

# Visualisasi Perbandingan Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_ubijalar_glm, aes(x = Produktivitas_3, y = Predictions_6)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produktivitas", y = "Predicted Produktivitas") +
  ggtitle("Comparison of Actual Produktivitas and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_ubijalar_glm, aes(x = 1:length(Produktivitas_3))) +
  geom_line(aes(y = Produktivitas_3, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_6, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produktivitas") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_6 <- mae(test_pt_ubijalar_glm$Produktivitas, predict_pt_ubijalar_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_6 <- mse(test_pt_ubijalar_glm$Produktivitas, predict_pt_ubijalar_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_6 <- rmse(test_pt_ubijalar_glm$Produktivitas, predict_pt_ubijalar_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_6 <- mape(test_pt_ubijalar_glm$Produktivitas, predict_pt_ubijalar_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_6, "\n"))
cat(paste("MSE: ", mse_value_glm_6, "\n"))
cat(paste("RMSE: ", rmse_value_glm_6, "\n"))
cat(paste("MAPE: ", mape_value_glm_6, "%\n"))
```

## Produksi ubi_kayu sumatera - GLM

```{r}
# Pilih variabel yang akan diprediksi
produksi_ubikayu_glm <- Iklim_ubikayu[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produksi_ubikayu_glm
```

```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_produksi_ubikayu <- sample.split(produksi_ubikayu_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_ps_ubikayu_glm <- subset(produksi_ubikayu_glm, split_produksi_ubikayu == TRUE)
test_ps_ubikayu_glm <- subset(produksi_ubikayu_glm, split_produksi_ubikayu == FALSE)
```

```{r}
dim(train_ps_ubikayu_glm)
dim(test_ps_ubikayu_glm)
```

### GLM model Iklim terhadap Produksi ubikayu
```{r}
#model GLM
glm_produksi_ubikayu <- glm(Produksi ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = train_ps_ubikayu_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_produksi_ubikayu)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_ps_ubikayu_glm <- predict(glm_produksi_ubikayu, newdata = test_ps_ubikayu_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_ps_ubikayu_glm)
```
```{r}
head(predict_ps_ubikayu_glm)
```

```{r}
# Visualisasi Hasil
result_ps_ubikayu_glm <- data.frame(Produksi_4 = test_ps_ubikayu_glm$Produksi, Predictions_7 = predict_ps_ubikayu_glm)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_ubikayu_glm, aes(x = Produksi_4, y = Predictions_7)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produksi", y = "Predicted Produksi") +
  ggtitle("Comparison of Actual Produksi and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_ubikayu_glm, aes(x = 1:length(Produksi_4))) +
  geom_line(aes(y = Produksi_4, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_7, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produksi") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_7 <- mae(test_ps_ubikayu_glm$Produksi, predict_ps_ubikayu_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_7 <- mse(tes_ps_ubikayu_glm$Produksi, predict_ps_ubikayu_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_7 <- rmse(test_ps_ubikayu_glm$Produksi, predict_ps_ubikayu_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_7 <- mape(test_ps_ubikayu_glm$Produksi, predict_ps_ubikayu_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_7, "\n"))
cat(paste("MSE: ", mse_value_glm_7, "\n"))
cat(paste("RMSE: ", rmse_value_glm_7, "\n"))
cat(paste("MAPE: ", mape_value_glm_7, "%\n"))
```
MAE:  1272921.36158324 
MSE:  2100608327097.84 
RMSE:  1449347.55221025 
MAPE:  160.734034463418 %


## Produktivitas ubikayu - GLM
```{r}
# Pilih variabel yang akan diprediksi
produktivitas_ubikayu_glm <- Iklim_ubikayu[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produktivitas_ubikayu_glm
```


```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_pt_ubikayu <- sample.split(produktivitas_ubikayu_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_pt_ubikayu_glm <- subset(produktivitas_ubikayu_glm, split_pt_ubikayu == TRUE)
test_pt_ubikayu_glm <- subset(produktivitas_ubikayu_glm, split_pt_ubikayu == FALSE)
```

```{r}
dim(train_pt_ubikayu_glm)
dim(test_pt_ubikayu_glm)
```


### GLM model Iklim terhadap Produktivitas ubikayu
```{r}
glm_Produktivitas_ubikayu <- glm(Produktivitas ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = test_pt_ubikayu_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_Produktivitas_ubikayu)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_pt_ubikayu_glm <- predict(glm_Produktivitas_ubikayu, newdata = test_pt_ubikayu_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_pt_ubikayu_glm)
```

```{r}
# Visualisasi Hasil
result_pt_ubikayu_glm <- data.frame(Produktivitas_4 = test_pt_ubikayu_glm$Produktivitas, Predictions_8 = predict_pt_ubikayu_glm)

# Visualisasi Perbandingan Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_ubikayu_glm, aes(x = Produktivitas_4, y = Predictions_8)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produktivitas", y = "Predicted Produktivitas") +
  ggtitle("Comparison of Actual Produktivitas and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_ubikayu_glm, aes(x = 1:length(Produktivitas_4))) +
  geom_line(aes(y = Produktivitas_4, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_8, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produktivitas") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_8 <- mae(test_pt_ubikayu_glm$Produktivitas, predict_pt_ubikayu_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_8 <- mse(test_pt_ubikayu_glm$Produktivitas, predict_pt_ubikayu_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_8 <- rmse(test_pt_ubikayu_glm$Produktivitas, predict_pt_ubikayu_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_8 <- mape(test_pt_ubikayu_glm$Produktivitas, predict_pt_ubikayu_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_8, "\n"))
cat(paste("MSE: ", mse_value_glm_8, "\n"))
cat(paste("RMSE: ", rmse_value_glm_8, "\n"))
cat(paste("MAPE: ", mape_value_glm_8, "%\n"))
```


## Produksi Kacang kedelai sumatera - GLM

```{r}
# Pilih variabel yang akan diprediksi
produksi_Kedelai_glm <- Iklim_Kedelai[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produksi_Kedelai_glm
```

```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_produksi_Kedelai <- sample.split(produksi_Kedelai_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_ps_Kedelai_glm <- subset(produksi_Kedelai_glm, split_produksi_Kedelai == TRUE)
test_ps_Kedelai_glm <- subset(produksi_Kedelai_glm, split_produksi_Kedelai == FALSE)
```

```{r}
dim(train_ps_Kedelai_glm)
dim(test_ps_Kedelai_glm)
```

### GLM model Iklim terhadap Produksi Kedelai
```{r}
#model GLM
glm_produksi_Kedelai <- glm(Produksi ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = train_ps_Kedelai_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_produksi_Kedelai)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_ps_Kedelai_glm <- predict(glm_produksi_Kedelai, newdata = test_ps_Kedelai_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_ps_Kedelai_glm)
```
```{r}
head(predict_ps_Kedelai_glm)
```

```{r}
# Visualisasi Hasil
result_ps_Kedelai_glm <- data.frame(Produksi_5 = test_ps_Kedelai_glm$Produksi, Predictions_9 = predict_ps_Kedelai_glm)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_Kedelai_glm, aes(x = Produksi_5, y = Predictions_9)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produksi", y = "Predicted Produksi") +
  ggtitle("Comparison of Actual Produksi and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_Kedelai_glm, aes(x = 1:length(Produksi_5))) +
  geom_line(aes(y = Produksi_5, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_9, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produksi") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_9 <- mae(test_ps_Kedelai_glm$Produksi, predict_ps_Kedelai_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_9 <- mse(tes_ps_Kedelai_glm$Produksi, predict_ps_Kedelai_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_9 <- rmse(test_ps_Kedelai_glm$Produksi, predict_ps_Kedelai_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_9 <- mape(test_ps_Kedelai_glm$Produksi, predict_ps_Kedelai_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_9, "\n"))
cat(paste("MSE: ", mse_value_glm_9, "\n"))
cat(paste("RMSE: ", rmse_value_glm_9, "\n"))
cat(paste("MAPE: ", mape_value_glm_9, "%\n"))
```



## Produktivitas Kedelai - GLM
```{r}
# Pilih variabel yang akan diprediksi
produktivitas_Kedelai_glm <- Iklim_Kedelai[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produktivitas_Kedelai_glm
```


```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_pt_Kedelai <- sample.split(produktivitas_Kedelai_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_pt_Kedelai_glm <- subset(produktivitas_Kedelai_glm, split_pt_Kedelai == TRUE)
test_pt_Kedelai_glm <- subset(produktivitas_Kedelai_glm, split_pt_Kedelai == FALSE)
```

```{r}
dim(train_pt_Kedelai_glm)
dim(test_pt_Kedelai_glm)
```


### GLM model Iklim terhadap Produktivitas Kedelai
```{r}
glm_Produktivitas_Kedelai <- glm(Produktivitas ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = test_pt_Kedelai_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_Produktivitas_Kedelai)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_pt_Kedelai_glm <- predict(glm_Produktivitas_Kedelai, newdata = test_pt_Kedelai_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_pt_Kedelai_glm)
```

```{r}
# Visualisasi Hasil
result_pt_Kedelai_glm <- data.frame(Produktivitas_5 = test_pt_Kedelai_glm$Produktivitas, Predictions_10 = predict_pt_Kedelai_glm)

# Visualisasi Perbandingan Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_Kedelai_glm, aes(x = Produktivitas_5, y = Predictions_10)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produktivitas", y = "Predicted Produktivitas") +
  ggtitle("Comparison of Actual Produktivitas and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_Kedelai_glm, aes(x = 1:length(Produktivitas_5))) +
  geom_line(aes(y = Produktivitas_5, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_10, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produktivitas") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_10 <- mae(test_pt_Kedelai_glm$Produktivitas, predict_pt_Kedelai_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_10 <- mse(test_pt_Kedelai_glm$Produktivitas, predict_pt_Kedelai_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_10 <- rmse(test_pt_Kedelai_glm$Produktivitas, predict_pt_Kedelai_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_10 <- mape(test_pt_Kedelai_glm$Produktivitas, predict_pt_Kedelai_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_10, "\n"))
cat(paste("MSE: ", mse_value_glm_10, "\n"))
cat(paste("RMSE: ", rmse_value_glm_10, "\n"))
cat(paste("MAPE: ", mape_value_glm_10, "%\n"))
```



## Produksi Kacang hijau sumatera - GLM

```{r}
# Pilih variabel yang akan diprediksi
produksi_kcgHijau_glm <- Iklim_kacanghijau[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produksi_kcgHijau_glm
```

```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_produksi_kcgHijau <- sample.split(produksi_kcgHijau_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_ps_kcgHijau_glm <- subset(produksi_kcgHijau_glm, split_produksi_kcgHijau == TRUE)
test_ps_kcgHijau_glm <- subset(produksi_kcgHijau_glm, split_produksi_kcgHijau == FALSE)
```

```{r}
dim(train_ps_kcgHijau_glm)
dim(test_ps_kcgHijau_glm)
```

### GLM model Iklim terhadap Produksi kacang Hijau
```{r}
#model GLM
glm_produksi_kcgHijau <- glm(Produksi ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = train_ps_kcgHijau_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_produksi_kcgHijau)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_ps_kcgHijau_glm <- predict(glm_produksi_kcgHijau, newdata = test_ps_kcgHijau_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_ps_kcgHijau_glm)
```
```{r}
head(predict_ps_kcgHijau_glm)
```

```{r}
# Visualisasi Hasil
result_ps_kcgHijau_glm <- data.frame(Produksi_6 = test_ps_kcgHijau_glm$Produksi, Predictions_11 = predict_ps_kcgHijau_glm)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_kcgHijau_glm, aes(x = Produksi_6, y = Predictions_11)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produksi", y = "Predicted Produksi") +
  ggtitle("Comparison of Actual Produksi and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_kcgHijau_glm, aes(x = 1:length(Produksi_6))) +
  geom_line(aes(y = Produksi_6, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_11, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produksi") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_11 <- mae(test_ps_kcgHijau_glm$Produksi, predict_ps_kcgHijau_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_11 <- mse(tes_ps_kcgHijau_glm$Produksi, predict_ps_kcgHijau_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_11 <- rmse(test_ps_kcgHijau_glm$Produksi, predict_ps_kcgHijau_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_11 <- mape(test_ps_kcgHijau_glm$Produksi, predict_ps_kcgHijau_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_11, "\n"))
cat(paste("MSE: ", mse_value_glm_11, "\n"))
cat(paste("RMSE: ", rmse_value_glm_11, "\n"))
cat(paste("MAPE: ", mape_value_glm_11, "%\n"))
```



## Produktivitas kacang Hijau - GLM
```{r}
# Pilih variabel yang akan diprediksi
produktivitas_kcgHijau_glm <- Iklim_kacanghijau[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produktivitas_kcgHijau_glm
```


```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_pt_kcgHijau <- sample.split(produktivitas_kcgHijau_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_pt_kcgHijau_glm <- subset(produktivitas_kcgHijau_glm, split_pt_kcgHijau == TRUE)
test_pt_kcgHijau_glm <- subset(produktivitas_kcgHijau_glm, split_pt_kcgHijau == FALSE)
```

```{r}
dim(train_pt_kcgHijau_glm)
dim(test_pt_kcgHijau_glm)
```


### GLM model Iklim terhadap Produktivitas kacang Hijau
```{r}
glm_Produktivitas_kcgHijau <- glm(Produktivitas ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = test_pt_kcgHijau_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_Produktivitas_kcgHijau)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_pt_kcgHijau_glm <- predict(glm_Produktivitas_kcgHijau, newdata = test_pt_kcgHijau_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_pt_kcgHijau_glm)
```

```{r}
# Visualisasi Hasil
result_pt_kcgHijau_glm <- data.frame(Produktivitas_6 = test_pt_kcgHijau_glm$Produktivitas, Predictions_12 = predict_pt_kcgHijau_glm)

# Visualisasi Perbandingan Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_kcgHijau_glm, aes(x = Produktivitas_6, y = Predictions_12)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produktivitas", y = "Predicted Produktivitas") +
  ggtitle("Comparison of Actual Produktivitas and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_kcgHijau_glm, aes(x = 1:length(Produktivitas_6))) +
  geom_line(aes(y = Produktivitas_6, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_12, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produktivitas") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_12 <- mae(test_pt_kcgHijau_glm$Produktivitas, predict_pt_kcgHijau_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_12 <- mse(test_pt_kcgHijau_glm$Produktivitas, predict_pt_kcgHijau_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_12 <- rmse(test_pt_kcgHijau_glm$Produktivitas, predict_pt_kcgHijau_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_12 <- mape(test_pt_kcgHijau_glm$Produktivitas, predict_pt_kcgHijau_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_12, "\n"))
cat(paste("MSE: ", mse_value_glm_12, "\n"))
cat(paste("RMSE: ", rmse_value_glm_12, "\n"))
cat(paste("MAPE: ", mape_value_glm_12, "%\n"))
```



## Produksi Kacang tanah sumatera - GLM

```{r}
# Pilih variabel yang akan diprediksi
produksi_kcgtanah_glm <- Iklim_kacangtanah[, c("Produksi", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produksi_kcgtanah_glm
```

```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_produksi_kcgtanah <- sample.split(produksi_kcgtanah_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_ps_kcgtanah_glm <- subset(produksi_kcgtanah_glm, split_produksi_kcgtanah == TRUE)
test_ps_kcgtanah_glm <- subset(produksi_kcgtanah_glm, split_produksi_kcgtanah == FALSE)
```

```{r}
dim(train_ps_kcgtanah_glm)
dim(test_ps_kcgtanah_glm)
```

### GLM model Iklim terhadap Produksi kacang tanah
```{r}
#model GLM
glm_produksi_kcgtanah <- glm(Produksi ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = train_ps_kcgtanah_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_produksi_kcgtanah)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_ps_kcgtanah_glm <- predict(glm_produksi_kcgtanah, newdata = test_ps_kcgtanah_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_ps_kcgtanah_glm)
```
```{r}
head(predict_ps_kcgtanah_glm)
```

```{r}
# Visualisasi Hasil
result_ps_kcgtanah_glm <- data.frame(Produksi_7 = test_ps_kcgtanah_glm$Produksi, Predictions_13 = predict_ps_kcgtanah_glm)

# Visualisasi Perbandingan Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_kcgtanah_glm, aes(x = Produksi_7, y = Predictions_13)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produksi", y = "Predicted Produksi") +
  ggtitle("Comparison of Actual Produksi and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produksi Aktual dengan Hasil Prediksi
ggplot(data = result_ps_kcgtanah_glm, aes(x = 1:length(Produksi_7))) +
  geom_line(aes(y = Produksi_7, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_13, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produksi") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_13 <- mae(test_ps_kcgtanah_glm$Produksi, predict_ps_kcgtanah_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_13 <- mse(tes_ps_kcgtanah_glm$Produksi, predict_ps_kcgtanah_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_13 <- rmse(test_ps_kcgtanah_glm$Produksi, predict_ps_kcgtanah_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_13 <- mape(test_ps_kcgtanah_glm$Produksi, predict_ps_kcgtanah_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_13, "\n"))
cat(paste("MSE: ", mse_value_glm_13, "\n"))
cat(paste("RMSE: ", rmse_value_glm_13, "\n"))
cat(paste("MAPE: ", mape_value_glm_13, "%\n"))
```



## Produktivitas kacang tanah - GLM
```{r}
# Pilih variabel yang akan diprediksi
produktivitas_kcgtanah_glm <- Iklim_kacangtanah[, c("Produktivitas", "Kecepatan_Angin", "Kelembapan", "Suhu", "Penyinaran_Matahari", "Curah_hujan")]
produktivitas_kcgtanah_glm
```


```{r}
# Membagi dataset menjadi data pelatihan dan pengujian
set.seed(123) # Set seed untuk reproduktibilitas
split_pt_kcgtanah <- sample.split(produktivitas_kcgtanah_glm$Produksi, SplitRatio = 0.7) # 70% untuk data pelatihan, 30% untuk data pengujian
```

```{r}
# Membuat subset data pelatihan dan pengujian
train_pt_kcgtanah_glm <- subset(produktivitas_kcgtanah_glm, split_pt_kcgtanah == TRUE)
test_pt_kcgtanah_glm <- subset(produktivitas_kcgtanah_glm, split_pt_kcgtanah == FALSE)
```

```{r}
dim(train_pt_kcgtanah_glm)
dim(test_pt_kcgtanah_glm)
```


### GLM model Iklim terhadap Produktivitas kacang tanah
```{r}
glm_Produktivitas_kcgtanah <- glm(Produktivitas ~ Curah_hujan + Suhu + Penyinaran_Matahari+ Kecepatan_Angin + Kelembapan, 
                      data = test_pt_kcgtanah_glm, 
                      family = gaussian(link = "identity"),
                      control = list(epsilon = 1e-8, maxit = 100))
```

```{r}
summary(glm_Produktivitas_kcgtanah)
```


### Prediksi data testing dengan model
```{r}
# Melakukan prediksi dengan model GLM pada data testing
predict_pt_kcgtanah_glm <- predict(glm_Produktivitas_kcgtanah, newdata = test_pt_kcgtanah_glm, type = "response")
```

```{r}
# Menampilkan hasil prediksi
head(predict_pt_kcgtanah_glm)
```

```{r}
# Visualisasi Hasil
result_pt_kcgtanah_glm <- data.frame(Produktivitas_7 = test_pt_kcgtanah_glm$Produktivitas, Predictions_14 = predict_pt_kcgtanah_glm)

# Visualisasi Perbandingan Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_kcgtanah_glm, aes(x = Produktivitas_7, y = Predictions_14)) +
  geom_point() +
  geom_abline(intercept = 0, slope = 1, color = "red", linetype = "dashed") +
  scale_x_continuous(labels = scales::comma) +
  scale_y_continuous(labels = scales::comma) +
  labs(x = "Actual Produktivitas", y = "Predicted Produktivitas") +
  ggtitle("Comparison of Actual Produktivitas and GLM Model Prediction") +
  theme_minimal()
```

```{r}
# Visualisasi Produktivitas Aktual dengan Hasil Prediksi
ggplot(data = result_pt_kcgtanah_glm, aes(x = 1:length(Produktivitas_7))) +
  geom_line(aes(y = Produktivitas_7, color = "Actual"), size = 1) +
  geom_line(aes(y = Predictions_14, color = "GLM Prediction"), size = 1) +
  labs(x = "Observation", y = "Produktivitas") +
  scale_color_manual(values = c("Actual" = "blue", "GLM Prediction" = "red")) +
  ggtitle("Comparison of Actual Sales and GLM Model Prediction") +
  theme_minimal()
```


### Evaluasi Model
```{r}
# Hitung MAE (Mean Absolute Error)
mae_value_glm_14 <- mae(test_pt_kcgtanah_glm$Produktivitas, predict_pt_kcgtanah_glm)

# Hitung MSE (Mean Squared Error)
mse_value_glm_14 <- mse(test_pt_kcgtanah_glm$Produktivitas, predict_pt_kcgtanah_glm)

# Hitung RMSE (Root Mean Square Error)
rmse_value_glm_14 <- rmse(test_pt_kcgtanah_glm$Produktivitas, predict_pt_kcgtanah_glm)

# Hitung MAPE (Mean Absolute Percent Error)
mape_value_glm_14 <- mape(test_pt_kcgtanah_glm$Produktivitas, predict_pt_kcgtanah_glm)

# Tampilkan hasil evaluasi
cat(paste("MAE: ", mae_value_glm_14, "\n"))
cat(paste("MSE: ", mse_value_glm_14, "\n"))
cat(paste("RMSE: ", rmse_value_glm_14, "\n"))
cat(paste("MAPE: ", mape_value_glm_14, "%\n"))
```

