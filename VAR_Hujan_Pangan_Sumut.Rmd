---
title: "EDA_Hujan_Pangan_Sumut"
author: "Fitria"
date: "2023-10-12"
output: pdf_document
---

# Panggil Library
```{r}
library(dplyr)
library(ggplot2)
library(lubridate)
library(summarytools)
library(readxl)
library(cluster)
library(scales)
library(vars)
```

#1. Tanaman Pangan Sumut 2010-2022
## Obstain - Load Dataset

```{r}
tanaman_pangan <- read_excel("C:/Users/Lenovo/Documents/File R skripsi/Dataset Tanaman Pangan Sumut/Tanaman Pangan_Sumut_2010-2022.xlsx")
tanaman_pangan
```

```{r}
#Merubah type data dari cdouble menjadi numeric agar mudah di operasikan
tanaman_pangan$Ratarata_produksi<-as.numeric(tanaman_pangan$Ratarata_produksi)
tanaman_pangan$Produksi<-as.numeric(tanaman_pangan$Produksi)
tanaman_pangan$Luas_Panen<-as.numeric(tanaman_pangan$Luas_Panen)
tanaman_pangan
```

```{r}
#merubah type data tahun dari double menjadi date
tanaman_pangan$Tahun<-make_date(tanaman_pangan$Tahun)
tanaman_pangan
```


```{r}
#Merubah variabel nama
names(tanaman_pangan) [names(tanaman_pangan) == "Ratarata_produksi"] <- "Rata_rata_produksi"
glimpse(tanaman_pangan)
```

```{r}
tail(tanaman_pangan)
```
```{r}
head(tanaman_pangan)
```
```{r}
# Menampikan variabel dengan baris kosong
colSums(is.na(tanaman_pangan))
```
### Menghapus Data Kosong

```{r}
# Menampikan variabel dengan baris kosong
colSums(is.na(tanaman_pangan))
```

```{r}
# Menghapus data NA's
tanaman_pangan_clean <- na.omit(tanaman_pangan)
summary(tanaman_pangan_clean)
```

```{r}
colSums(is.na(tanaman_pangan_clean))
```

Semua data NA's sudah dihapus. Data tanaman pangan di wilayah sumut mulai dari
Tahun 2010 - 2020 dengan frekuensi data per Tahun. Dalam dataset
tanaman_pangan_clean masih terdapat data dari provinsi Sumatera Utara
keseluruhan. Agar memudahkan dalam tahap analisis selanjutnya maka data
tanaman_pangan_clean yang diambil hanya berdasarkan kabupaten/kota saja.
Sekarang data final yang siap dianalisis adalah sebanyak 359 baris #revisi nanti
observasi dengan 6 kolom variabel


```{r}
#menfilter data kabupaten/kota saja tanpa data sumatera utara
tanaman_pangan_filter <- tanaman_pangan_clean[tanaman_pangan_clean$Kabupaten_Kota != "Sumatera Utara",]
tanaman_pangan_filter
```
```{r}
options(dplyr.summarise.inform = FALSE) # untuk menonaktifkan pesan peringatan yang biasanya muncul ketika Anda menggunakan summarise() untuk menghitung statistik tertentu
```

## Eksplorasi Data Analisis (EDA)

### Jumlah Produksi Tanaman Pangan per Kabupaten/Kota
```{r}
# Hitung total produksi semua tanaman pangan per kabupaten di setiap tahun
totproduksi_pangan <- tanaman_pangan_filter %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi)) %>%
  arrange(desc(total_produksi))

totproduksi_pangan
```

```{r}
# Hitung total produksi semua tanaman pangan per setiap Kabupaten/Kota
totproduksi_kabkota <- tanaman_pangan_filter %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_kabkota
```

### Tren Produksi Tanaman Pangan per Kabupaten/Kota


```{r}
# Visualisasi Tren Produksi tanaman pangan per kabupaten/kota di setiap tahun
plot_1 <- ggplot(totproduksi_pangan, aes(x = Tahun, y = total_produksi, color = Kabupaten_Kota)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Tanaman Pangan", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_1
```

```{r}

# Visualisasi dengan barplot
plot_2 <- ggplot(totproduksi_kabkota, aes(x = Kabupaten_Kota, y = total_produksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Tanaman pangan antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_2 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi tanaman pangan dalam kurun waktu 2010 - 2022 adalah dari Kabupaten Simalungun yang terbanyak dengan Jumlah Produksi 13.271.196,14 Ton


# 2. Curah hujan

```{r}
rainfall <-read_excel("D:/OneDrive - mikroskil.ac.id/Documents/File R skripsi/Rainfall Sumut_2010-2022.xlsx")
rainfall
```


```{r}
# Merubah type variabel DateTime menjadi Date
rainfall$DateTime <- as.Date(rainfall$DateTime)
glimpse(rainfall)
```

```{r}
# Merubah nama variabel
names(rainfall)[names(rainfall) == "UCSB CHIRPS Rainfall: avg"] <- "rainfall_avg"
names(rainfall)[names(rainfall) == "DateTime"] <- "date"
glimpse(rainfall)
```

```{r}
#Merubah type data rainfallavg menjadi numeric dan
rainfall$rainfall_avg <-as.numeric(rainfall$rainfall_avg)
rainfall
```
```{r}
head(rainfall)
```
```{r}
tail(rainfall)
```

```{r}
# Mengambil rata-rata curah hujan per tahun
rainfall_yearly <- rainfall %>%
  mutate(year = lubridate::year(date)) %>%
  group_by(year) %>%
  summarise(avg_rainfall = mean(rainfall_avg))
rainfall_yearly  
```

```{r}
# Merubah type tahun menjadi date
rainfall_yearly$year <- make_date(rainfall_yearly$year)
rainfall_yearly
```


# 3. Padi

```{r}
# Ambil data padi di dataset tanaman pangan 
Padi <- tanaman_pangan_filter[tanaman_pangan_filter$Nama_Tanaman_Pangan == "Padi",]
```

```{r}
glimpse(Padi)
```

## EDA Padi

### Jumlah Produksi Padi per Kabupaten/Kota
```{r}
# Hitung total produksi padi per kabupaten/kota di setiap tahun
totproduksi_padi <- Padi %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
totproduksi_padi
```


```{r}
# Hitung total produksi padi per setiap Kabupaten/Kota
totproduksi_kabkota_padi <- Padi %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_kabkota_padi
```
Produksi padi tertinggi adalah dari kabupaten Deli Serdang sebanyak 5213178,41 Ton	


### Tren Produksi Tanaman Pangan per Kabupaten/Kota

```{r}
# Visualisasi Tren Produksi tanaman pangan per kabupaten/kota di setiap tahun
plot_padi_1 <- ggplot(totproduksi_padi, aes(x = Tahun, y = total_produksi, color = Kabupaten_Kota)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Padi", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_padi_1
```

```{r}

# Visualisasi dengan barplot total produksi padi di setiap kabupaten/kota
plot_padi_2<- ggplot(totproduksi_kabkota_padi, aes(x = Kabupaten_Kota, y = total_produksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Padi antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_padi_2 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi padi dalam kurun waktu 2010 - 2022 adalah dari Deli serdang yang terbanyak dengan Jumlah Produksi 5213178.41 ton

### Perbandingan Rata-rata produksi Padi per Kabupaten/Kota

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren rata-rata produksi padi
rataproduksi_padi <- Padi %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(Rata_rata_produksi = sum(Rata_rata_produksi))
rataproduksi_padi
```

```{r}
# Hitung total rata-rata produksi padi per Kabupaten/Kota
totrataproduksi_kabkota_padi <- Padi %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_rataproduksi = sum(Rata_rata_produksi)) %>%
  arrange(desc(total_rataproduksi))
totrataproduksi_kabkota_padi
```

```{r}

# Visualisasi dengan barplot
plot_padi_3 <- ggplot(totrataproduksi_kabkota_padi, aes(x = Kabupaten_Kota, y = total_rataproduksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Rata_rata Produksi Padi antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Rata_rata Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_padi_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Perbandingan Rata-rata produksi dengan Produksi Padi

```{r}
# Create a boxplot using ggplot2
plot_padi_4 <- ggplot(Padi, aes(x = Kabupaten_Kota, y = Produksi - Rata_rata_produksi, fill = Kabupaten_Kota)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Rata-rata Produksi per Kabupaten/Kota", x = "Kabupaten/Kota", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_padi_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

```{r}
# Hitung Pearson correlation coefficient
correlation_padi_1 <- cor(Padi$Luas_Panen, Padi$Produksi)
# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_padi_1)
```


## Curah hujan terhadap Padi

```{r}
# Ambil data padi di dataset tanaman pangan yang belum di filter sumatera utara 
Padi_Sumut <- tanaman_pangan_clean[tanaman_pangan_clean$Nama_Tanaman_Pangan == "Padi",]
Padi_Sumut
```

```{r}
# Filter data for "Sumatera Utara" kabupaten
sumut_dataPadi<- Padi_Sumut %>%
  filter(Kabupaten_Kota == "Sumatera Utara")
sumut_dataPadi
```

```{r}
# Mengabungkan kedua dataset
merged_data_padi <- merge(sumut_dataPadi, rainfall_yearly, by.x = "Tahun", by.y = "year")
merged_data_padi
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_for_var_padi <- merged_data_padi[, c("Rata_rata_produksi", "avg_rainfall")]
data_for_var_padi
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_data_padi <- ts(data_for_var_padi, start = c(2010,1), frequency = 1)
ts_data_padi
```

```{r}
best_lag_padi <- VARselect(ts_data_padi, lag.max = 5, type = "both")
best_lag_padi
```
### VAR Model Rata-rata curah hujan terhadap rata-rata produksi padi
```{r}
# VAR Model Rata-rata curah hujan terhadap rata-rata produksi padi
var_model_Padi <- VAR(ts_data_padi, p = best_lag_padi$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_Padi)
```


Dalam model VAR ini, "avg_rainfall.l1" memiliki koefisien -0.69380 pada "Rata_rata_produksi.l1" (lag 1). Ini berarti bahwa dalam periode yang sama, jika ada peningkatan satu unit dalam curah hujan rata-rata, maka rata-rata produksi padi cenderung menurun sebesar -0.69380 unit. 

p-value dari F-statistic lebih besar dari 0.05 (0.7351 dan 0.614), yang menunjukkan bahwa Anda tidak dapat menolak hipotesis nol bahwa keseluruhan model tersebut tidak signifikan secara statistik.

```{r}
# Melakukan uji Granger Causality
granger_test_padi <- causality(var_model_Padi, cause = "avg_rainfall")
granger_test_padi
```

*Granger* tidak memiliki bukti statistik yang cukup untuk menyatakan bahwa "avg_rainfall" Granger-cause "Rata_rata_produksi." Dengan kata lain, uji Granger Causality tidak menemukan hubungan sebab-akibat yang signifikan antara curah hujan rata-rata ("avg_rainfall") dan produksi padi rata-rata ("Rata_rata_produksi").

*Instant*memiliki bukti statistik yang cukup untuk menyatakan bahwa terdapat hubungan causality instan antara "avg_rainfall" dan "Rata_rata_produksi." 

*Kesimpulan*
hasil ini menunjukkan bahwa sementara tidak ada bukti hubungan sebab-akibat jangka panjang, terdapat hubungan instan antara curah hujan rata-rata dan produksi padi rata-rata.


```{r}
# Membuat model regresi linier
regression_model_padi <- lm(Rata_rata_produksi ~ avg_rainfall, data = data_for_var_padi)

# Ringkasan hasil model
summary(regression_model_padi)
```

hasil regresi linier ini menunjukkan bahwa avg_rainfall p-valuenya 0,059 dan nilai estimate nya -1.3753 yang memiliki pengaruh negatif yang tidak signifikan terhadap produksi padi rata-rata. Meskipun koefisien negatif menunjukkan bahwa ada hubungan negatif antara kedua variabel tersebut, P-value yang tinggi pada F-statistik (0.05901) mengindikasikan bahwa pengaruh ini tidak signifikan secara statistik. Dengan kata lain, *tidak* dapat menyatakan bahwa curah hujan rata-rata secara signifikan memengaruhi produksi padi rata-rata berdasarkan hasil regresi ini.

```{r}
# Menghitung koefisien korelasi Pearson
correlation_Padi <- cor(data_for_var_padi$Rata_rata_produksi, data_for_var_padi$avg_rainfall)
correlation_Padi
```
 koefisien korelasi Pearson adalah -0.5359986, yang mendekati -1. Ini menunjukkan bahwa ada hubungan negatif antara curah hujan rata-rata ("avg_rainfall") dan produksi padi rata-rata ("Rata_rata_produksi"). Artinya, ketika curah hujan rata-rata meningkat, produksi padi rata-rata cenderung menurun, dan sebaliknya.



#4. Ubi Jalar

```{r}
# Ambil data Ubi Jalar dari dataset tanaman pangan 
Ubi_Jalar <- tanaman_pangan_filter[tanaman_pangan_filter$Nama_Tanaman_Pangan == "Ubi Jalar",]
Ubi_Jalar
```

## EDA Ubi Jalar

### Jumlah Produksi Ubi Jalar per Kabupaten/Kota
```{r}
# Hitung total produksi Ubi Jalar per kabupaten/kota di setiap tahun
totproduksi_UbiJalar <- Ubi_Jalar %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi))

totproduksi_UbiJalar
```


```{r}
# Hitung total produksi padi per setiap Kabupaten/Kota
totproduksi_kabkota_UbiJalar <- Ubi_Jalar %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_kabkota_UbiJalar
```


### Tren Produksi Ubi Jalar per Kabupaten/Kota


```{r}
# Visualisasi Tren Produksi   Ubi Jalar per kabupaten/kota di setiap tahun
plot_UbiJalar_1 <- ggplot(totproduksi_UbiJalar, aes(x = Tahun, y = total_produksi, color = Kabupaten_Kota)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Ubi Jalar", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_UbiJalar_1
```


```{r}

# Visualisasi dengan barplot total produksi Ubi Jalar di setiap kabupaten/kota
plot_UbiJalar_2<- ggplot(totproduksi_kabkota_UbiJalar, aes(x = Kabupaten_Kota, y = total_produksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Ubi Jalar antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_UbiJalar_2 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Ubi Jalar dalam kurun waktu 2010 - 2022 adalah dari Dairi yang terbanyak dengan Jumlah Produksi	328992.82 Ton

### Perbandingan Rata-rata produksi Ubi Jalar per Kabupaten/Kota

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren rata-rata produksi Ubi Jalar
rataproduksi_UbiJalar <- Ubi_Jalar %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(Rata_rata_produksi = sum(Rata_rata_produksi))
rataproduksi_UbiJalar
```

```{r}
# Hitung total rata-rata produksiUbi Jalar per Kabupaten/Kota
totrataproduksi_kabkota_UbiJalar <- Ubi_Jalar %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_rataproduksi = sum(Rata_rata_produksi)) %>%
  arrange(desc(total_rataproduksi))
totrataproduksi_kabkota_UbiJalar
```

```{r}

# Visualisasi dengan barplot
plot_UbiJalar_3 <- ggplot(totrataproduksi_kabkota_UbiJalar, aes(x = Kabupaten_Kota, y = total_rataproduksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Rata_rata Produksi Ubi Jalar antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Rata_rata Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_UbiJalar_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Perbandingan Rata-rata produksi dengan Produksi Ubi Jalar

```{r}
# Create a boxplot using ggplot2
plot_UbiJalar_4 <- ggplot(Ubi_Jalar, aes(x = Kabupaten_Kota, y = Produksi - Rata_rata_produksi, fill = Kabupaten_Kota)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Rata-rata Produksi per Kabupaten/Kota", x = "Kabupaten/Kota", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_UbiJalar_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
## Curah hujan terhadap Ubi Jalar

```{r}
# Ambil data Ubi Jalar di dataset tanaman pangan yang belum di filter sumatera utara 
UbiJalar_Sumut <- tanaman_pangan_clean[tanaman_pangan_clean$Nama_Tanaman_Pangan == "Ubi Jalar",]
UbiJalar_Sumut
```

```{r}
# Filter data for "Sumatera Utara" kabupaten
sumut_data_UbiJalar<- UbiJalar_Sumut %>%
  filter(Kabupaten_Kota == "Sumatera Utara")
sumut_data_UbiJalar
```

```{r}
# Mengabungkan kedua dataset
merged_data_UbiJalar <- merge(sumut_data_UbiJalar, rainfall_yearly, by.x = "Tahun", by.y = "year")
merged_data_UbiJalar
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_for_var_UbiJalar <- merged_data_UbiJalar[, c("Rata_rata_produksi", "avg_rainfall")]
data_for_var_UbiJalar
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_data_UbiJalar <- ts(data_for_var_UbiJalar, start = c(2010,1), frequency = 1)
ts_data_UbiJalar
```

```{r}
best_lag_UbiJalar <- VARselect(ts_data_UbiJalar, lag.max = 5, type = "both")
best_lag_UbiJalar
```

```{r}
# VAR Model
var_model_UbiJalar <- VAR(ts_data_UbiJalar, p = best_lag_UbiJalar$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_UbiJalar)
```
Estimation results for equation Rata_rata_produksi: 
Rata_rata_produksi.l1 Nilai estimasinya adalah 0.7145 dan P-value 0.405 sedangkan avg_rainfall.l1 estimatenya adalah -4.0116 sedangkan p-valuenya 0.772 dan P-value fstatistiknya adalah 0.1826 lebih besar dari 0,05 menunjukan bahwa tidak ada bukti statistik pengaruh rata-rata curah hujan terhadap rata-rata produksi.

Estimation results for equation avg_rainfall: 
Rata_rata_produksi.l1 nilai estimatenya -0.009615 dan P-value 0.885 sedangkan avg_rainfall.l1 nilai estimatenya -0.031986 dan P-valuenya 0.978 dan p-valuen f-statistiknya adalah 0.9188  yg lebih besar dari 0,05 menunjukan bahwa tidak ada bukti statistik pengaruh rata-rata curah hujan terhadap rata-rata produksi.

Dalam kesimpulan, berdasarkan hasil analisis VAR dan p-value yang tinggi, Hasil ini menunjukkan bahwa dalam kerangka model ini, hubungan antara curah hujan rata-rata dan produksi ubi jalar mungkin tidak signifikan secara statistik.

```{r}
# Melakukan uji Granger Causality
granger_test_UbiJalar <- causality(var_model_UbiJalar, cause = "avg_rainfall")
granger_test_UbiJalar
```
berdasarkan uji *Granger Causality* dengan F-Test, tidak ada bukti statistik yang cukup kuat untuk menyatakan bahwa curah hujan rata-rata "Granger-cause" (menyebabkan) perubahan dalam produksi ubi jalar.

Pada uji *Instantaneous Causality*, p-value adalah 0.05322. ada sedikit bukti statistik untuk mendukung adanya hubungan sebab-akibat instan antara curah hujan rata-rata dan produksi ubi jalar, tetapi hasil ini mungkin belum cukup kuat untuk dianggap signifikan.


```{r}
# Membuat model regresi linier
regression_model_UbiJalar <- lm(Rata_rata_produksi ~ avg_rainfall, data = data_for_var_UbiJalar)

# Ringkasan hasil model
summary(regression_model_UbiJalar)
```

enyimpulkan bahwa tidak ada bukti statistik yang kuat untuk mendukung adanya pengaruh curah hujan rata-rata terhadap produksi ubi jalar. Koefisien untuk curah hujan rata-rata tidak signifikan secara statistik, dan model regresi ini tidak sesuai dengan data dengan baik (R-squared yang rendah). Sehingga, dalam konteks model ini, curah hujan rata-rata tidak memiliki pengaruh yang signifikan terhadap produksi ubi jalar.

```{r}
# Menghitung koefisien korelasi Pearson
correlation_UbiJalar <- cor(data_for_var_UbiJalar$Rata_rata_produksi, data_for_var_UbiJalar$avg_rainfall)
correlation_UbiJalar
```

Nilai -0.2818502 menunjukkan adanya hubungan korelasi negatif yang lemah antara curah hujan rata-rata dan produksi ubi jalar. Namun, nilai ini dekat dengan nol, dan tidak cukup kuat untuk mengindikasikan hubungan korelasi yang signifikan.

Dengan kata lain, hasil ini menunjukkan bahwa ada sedikit korelasi negatif antara curah hujan rata-rata dan produksi ubi jalar, tetapi hubungannya sangat lemah dan tidak signifikan secara statistik.

#5. Ubi Kayu

```{r}
# Ambil data Ubi Jalar dari dataset tanaman pangan 
Ubi_Kayu <- tanaman_pangan_filter[tanaman_pangan_filter$Nama_Tanaman_Pangan == "Ubi Kayu",]
Ubi_Kayu
```

## EDA Ubi Kayu

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)
```

### Jumlah Produksi Ubi Kayu per Kabupaten/Kota
```{r}
# Hitung total produksi Ubi Kayu per kabupaten/kota di setiap tahun
totproduksi_UbiKayu <- Ubi_Kayu %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi))

totproduksi_UbiKayu
```


```{r}
# Hitung total produksi Ubi Kayu per setiap Kabupaten/Kota
totproduksi_kabkota_UbiKayu <- Ubi_Kayu %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_kabkota_UbiKayu
```


### Tren Produksi Ubi Kayu per Kabupaten/Kota


```{r}
# Visualisasi Tren Ubi Kayu per kabupaten/kota di setiap tahun
plot_UbiKayu_1 <- ggplot(totproduksi_UbiKayu, aes(x = Tahun, y = total_produksi, color = Kabupaten_Kota)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Ubi Kayu ", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_UbiKayu_1
```


```{r}

# Visualisasi dengan barplot total produksi Ubi Kayu di setiap kabupaten/kota
plot_UbiKayu_2<- ggplot(totproduksi_kabkota_UbiKayu, aes(x = Kabupaten_Kota, y = total_produksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Ubi Kayu antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_UbiKayu_2 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Ubi kayu dalam kurun waktu 2010 - 2022 adalah dari Serdang Begadai yang terbanyak dengan Jumlah Produksi 6187194.15	Ton

### Perbandingan Rata-rata produksi Padi per Kabupaten/Kota

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren rata-rata produksi Ubi Kayu
rataproduksi_UbiKayu <- Ubi_Kayu %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(Rata_rata_produksi = sum(Rata_rata_produksi))
rataproduksi_UbiKayu
```

```{r}
# Hitung total rata-rata produksi Ubi Kayu per Kabupaten/Kota
totrataproduksi_kabkota_UbiKayu <- Ubi_Kayu %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_rataproduksi = sum(Rata_rata_produksi)) %>%
  arrange(desc(total_rataproduksi))
totrataproduksi_kabkota_UbiKayu
```

```{r}

# Visualisasi dengan barplot
plot_UbiKayu_3 <- ggplot(totrataproduksi_kabkota_UbiKayu, aes(x = Kabupaten_Kota, y = total_rataproduksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Rata_rata Produksi Ubi kayu antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Rata_rata Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_UbiKayu_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Perbandingan Rata-rata produksi dengan Produksi Ubi Kayu

```{r}
# Create a boxplot using ggplot2
plot_UbiKayu_4 <- ggplot(Ubi_Kayu, aes(x = Kabupaten_Kota, y = Produksi - Rata_rata_produksi, fill = Kabupaten_Kota)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Rata-rata Produksi per Kabupaten/Kota", x = "Kabupaten/Kota", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_UbiKayu_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
## Curah hujan terhadap Ubi Kayu

```{r}
# Ambil data Ubi Kayu di dataset tanaman pangan yang belum di filter sumatera utara 
UbiKayu_Sumut <- tanaman_pangan_clean[tanaman_pangan_clean$Nama_Tanaman_Pangan == "Ubi Kayu",]
UbiKayu_Sumut
```

```{r}
# Filter data for "Sumatera Utara" kabupaten
sumut_data_UbiKayu<- UbiKayu_Sumut %>%
  filter(Kabupaten_Kota == "Sumatera Utara")
sumut_data_UbiKayu
```

```{r}
# Mengabungkan kedua dataset
merged_data_UbiKayu <- merge(sumut_data_UbiKayu, rainfall_yearly, by.x = "Tahun", by.y = "year")
merged_data_UbiKayu
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_for_var_UbiKayu <- merged_data_UbiKayu[, c("Rata_rata_produksi", "avg_rainfall")]
data_for_var_UbiKayu
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_data_UbiKayu <- ts(data_for_var_UbiKayu, start = c(2010,1), frequency = 1)
ts_data_UbiKayu
```

```{r}
best_lag_UbiKayu <- VARselect(ts_data_UbiKayu, lag.max = 5, type = "both")
best_lag_UbiKayu
```

```{r}
# VAR Model
var_model_UbiKayu <- VAR(ts_data_UbiKayu, p = best_lag_UbiKayu$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_UbiKayu)
```
Kesimpulan:

Coefficients (Estimasi Koefisien):Untuk persamaan Rata_rata_produksi, tidak ada koefisien yang signifikan secara statistik (semua p-value lebih besar dari 0.05), termasuk koefisien avg_rainfall.l1, avg_rainfall.l2, dan avg_rainfall.l3. Hal ini menunjukkan bahwa curah hujan rata-rata tidak memiliki dampak signifikan pada produksi ubi kayu dalam model VAR ini.
Untuk persamaan avg_rainfall, juga tidak ada koefisien yang signifikan secara statistik.
Residual standard error: Residual standard error adalah ukuran seberapa baik model VAR ini cocok dengan data. Semakin rendah nilainya, semakin baik modelnya. Dalam kasus ini, residual standard error cukup tinggi, yang menunjukkan bahwa model ini mungkin tidak cukup baik dalam menjelaskan hubungan antara kedua variabel.

Multiple R-Squared: Multiple R-Squared mengukur seberapa baik model dapat menjelaskan variasi dalam data. Nilai yang mendekati 1 menunjukkan bahwa model tersebut sangat baik dalam menjelaskan data. Namun, dalam hal ini, nilai Multiple R-Squared sangat rendah, menunjukkan bahwa model ini tidak menjelaskan variasi dalam data dengan baik.

F-statistic: F-statistic digunakan untuk menguji signifikansi keseluruhan model. Nilai F-statistic yang tinggi menunjukkan bahwa model secara keseluruhan signifikan. Namun, dalam hal ini, nilai F-statistic rendah, yang menunjukkan bahwa model VAR ini mungkin tidak signifikan secara keseluruhan.

```{r}
# Melakukan uji Granger Causality
granger_test_UbiKayu <- causality(var_model_UbiKayu, cause = "avg_rainfall")
granger_test_UbiKayu
```

Berdasarkan hasil kedua uji ini, tidak ada bukti statistik yang kuat untuk mendukung adanya hubungan sebab-akibat antara curah hujan rata-rata dan produksi ubi kayu dalam model VAR ini.


```{r}
# Membuat model regresi linier
regression_model_UbiKayu <- lm(Rata_rata_produksi ~ avg_rainfall, data = data_for_var_UbiKayu)

# Ringkasan hasil model
summary(regression_model_UbiKayu)
```
Berdasarkan hasil ini, kita tidak memiliki bukti statistik yang kuat untuk menyatakan bahwa curah hujan rata-rata memiliki pengaruh signifikan pada produksi ubi kayu. Nilai p-value yang tinggi (lebih besar dari tingkat signifikansi umum) menunjukkan bahwa tidak ada hubungan linier yang signifikan antara kedua variabel ini dalam model regresi ini.

```{r}
# Menghitung koefisien korelasi Pearson
correlation_UbiKayu <- cor(data_for_var_UbiKayu$Rata_rata_produksi, data_for_var_UbiKayu$avg_rainfall)
correlation_UbiKayu
```
Meskipun terdapat hubungan negatif antara curah hujan rata-rata dan produksi ubi kayu, hubungan ini lemah, dan tidak dapat dianggap sebagai hubungan yang signifikan secara statistik.



#6. Kacang Hijau

```{r}
# Ambil data Kacang Hijau dari dataset tanaman pangan 
Kacang_Hijau <- tanaman_pangan_filter[tanaman_pangan_filter$Nama_Tanaman_Pangan == "Kacang Hijau",]
Kacang_Hijau
```

## EDA Kacang Hijau

### Jumlah Produksi Kacang Hijau per Kabupaten/Kota
```{r}
# Hitung total produksi Kacang Hijau per kabupaten/kota di setiap tahun
totproduksi_KacangHijau <- Kacang_Hijau %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi))

totproduksi_KacangHijau
```


```{r}
# Hitung total produksi Kacang Hijau per setiap Kabupaten/Kota
totproduksi_kabkota_KacangHijau <- Kacang_Hijau %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_kabkota_KacangHijau
```


### Tren Produksi Kacang Hijau per Kabupaten/Kota


```{r}
# Visualisasi Tren Produksi Kacang Hijau per kabupaten/kota di setiap tahun
plot_KacangHijau_1 <- ggplot(totproduksi_KacangHijau, aes(x = Tahun, y = total_produksi, color = Kabupaten_Kota)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Kacang Hijau", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_KacangHijau_1
```


```{r}

# Visualisasi dengan barplot total produksi Kacang Hijau di setiap kabupaten/kota
plot_KacangHijau_2<- ggplot(totproduksi_kabkota_KacangHijau, aes(x = Kabupaten_Kota, y = total_produksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Kacang Hijau antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_KacangHijau_2 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Kacang Hijau dalam kurun waktu 2010 - 2022 adalah dari Langkat yang terbanyak dengan Jumlah Produksi 8670.18	 Ton

### Perbandingan Rata-rata produksi Kacang Hijau per Kabupaten/Kota

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren rata-rata produksi Kacang Hijau
rataproduksi_KacangHijau <- Kacang_Hijau %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(Rata_rata_produksi = sum(Rata_rata_produksi))
rataproduksi_KacangHijau
```

```{r}
# Hitung total rata-rata produksi Kacang Hijau per Kabupaten/Kota
totrataproduksi_kabkota_KacangHijau <- Kacang_Hijau %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_rataproduksi = sum(Rata_rata_produksi)) %>%
  arrange(desc(total_rataproduksi))
totrataproduksi_kabkota_KacangHijau
```

```{r}

# Visualisasi dengan barplot
plot_KacangHijau_3 <- ggplot(totrataproduksi_kabkota_KacangHijau, aes(x = Kabupaten_Kota, y = total_rataproduksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Rata_rata Produksi Kacang Hijau antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Rata_rata Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_KacangHijau_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Perbandingan Rata-rata produksi dengan Produksi Kacang Hijau

```{r}
# Create a boxplot using ggplot2
plot_KacangHijau_4 <- ggplot(Kacang_Hijau, aes(x = Kabupaten_Kota, y = Produksi - Rata_rata_produksi, fill = Kabupaten_Kota)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Rata-rata Produksi per Kabupaten/Kota", x = "Kabupaten/Kota", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_KacangHijau_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
## Curah hujan terhadap Kacang Hijau

```{r}
# Ambil data Kacang Hijau di dataset tanaman pangan yang belum di filter sumatera utara 
KacangHijau_Sumut <- tanaman_pangan_clean[tanaman_pangan_clean$Nama_Tanaman_Pangan == "Kacang Hijau",]
KacangHijau_Sumut
```

```{r}
# Filter data for "Sumatera Utara" kabupaten
sumut_data_KacangHijau<- KacangHijau_Sumut %>%
  filter(Kabupaten_Kota == "Sumatera Utara")
sumut_data_KacangHijau
```

```{r}
# Mengabungkan kedua dataset
merged_data_KacangHijau <- merge(sumut_data_KacangHijau, rainfall_yearly, by.x = "Tahun", by.y = "year")
merged_data_KacangHijau
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_for_var_KacangHijau <- merged_data_KacangHijau[, c("Rata_rata_produksi", "avg_rainfall")]
data_for_var_KacangHijau
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_data_KacangHijau <- ts(data_for_var_KacangHijau, start = c(2010,1), frequency = 1)
ts_data_KacangHijau
```

```{r}
best_lag_KacangHijau <- VARselect(ts_data_KacangHijau, lag.max = 5, type = "both")
best_lag_KacangHijau
```

```{r}
# VAR Model
var_model_KacangHijau <- VAR(ts_data_KacangHijau, p = best_lag_KacangHijau$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_KacangHijau)
```

berdasarkan analisis ini, tidak ada cukup bukti statistik yang mendukung hubungan sebab-akibat antara curah hujan rata-rata dan produksi kacang hijau.

```{r}
# Melakukan uji Granger Causality
granger_test_KacangHijau <- causality(var_model_KacangHijau, cause = "avg_rainfall")
granger_test_KacangHijau
```
Secara keseluruhan, berdasarkan hasil uji Granger Causality dan Instantaneous Causality, tidak ada bukti statistik yang kuat untuk mendukung adanya hubungan sebab-akibat antara "avg_rainfall" dan "Rata_rata_produksi" dalam model VAR, baik dalam jangka waktu lag maupun dalam jangka waktu instan.


```{r}
# Membuat model regresi linier
regression_model_KacangHijau <- lm(Rata_rata_produksi ~ avg_rainfall, data = data_for_var_KacangHijau)

# Ringkasan hasil model
summary(regression_model_KacangHijau)
```

Dilihat dari model regresi juga kelihatan bahwa tidak ada pengaruh curah hujan terhadap produksi padi

```{r}
# Menghitung koefisien korelasi Pearson
correlation_KacangHijau <- cor(data_for_var_KacangHijau$Rata_rata_produksi, data_for_var_KacangHijau$avg_rainfall)
correlation_KacangHijau
```

Dilihat dari hubungan negatif, artinya tingginya curah hujan biasanya berhubungan dengan rata-rata produksi yang rendah.


#7. Kacang Tanah

```{r}
# Ambil data Kacang Tanah dari dataset tanaman pangan 
Kacang_Tanah <- tanaman_pangan_filter[tanaman_pangan_filter$Nama_Tanaman_Pangan == "Kacang Tanah",]
Kacang_Tanah
```

## EDA Kacang Tanah

### Jumlah Produksi Kacang Tanah per Kabupaten/Kota
```{r}
# Hitung total produksi Kacang Tanah per kabupaten/kota di setiap tahun
totproduksi_KacangTanah <- Kacang_Tanah %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi))

totproduksi_KacangTanah
```


```{r}
# Hitung total produksi Kacang Tanah per setiap Kabupaten/Kota
totproduksi_kabkota_KacangTanah <- Kacang_Tanah %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_kabkota_KacangTanah
```


### Tren Produksi Kacang Tanah per Kabupaten/Kota


```{r}
# Visualisasi Tren Produksi Kacang Tanah per kabupaten/kota di setiap tahun
plot_KacangTanah_1 <- ggplot(totproduksi_KacangTanah, aes(x = Tahun, y = total_produksi, color = Kabupaten_Kota)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Kacang Tanah", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_KacangTanah_1
```


```{r}

# Visualisasi dengan barplot total produksi Kacang Tanah di setiap kabupaten/kota
plot_KacangTanah_2<- ggplot(totproduksi_kabkota_KacangTanah, aes(x = Kabupaten_Kota, y = total_produksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Kacang Tanah antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_KacangTanah_2 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
``` 
Perbandingan produksi Kacang Tanah dalam kurun waktu 2010 - 2022 adalah dari Tapanuli Utara yang terbanyak dengan Jumlah Produksi 26056.17	

### Perbandingan Rata-rata produksi Kacang Tanah per Kabupaten/Kota

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren rata-rata produksi Kacang Tanah
rataproduksi_KacangTanah <- Kacang_Tanah %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(Rata_rata_produksi = sum(Rata_rata_produksi))
rataproduksi_KacangTanah
```

```{r}
# Hitung total rata-rata produksi Kacang Tanah per Kabupaten/Kota
totrataproduksi_kabkota_KacangTanah <- Kacang_Tanah %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_rataproduksi = sum(Rata_rata_produksi)) %>%
  arrange(desc(total_rataproduksi))
totrataproduksi_kabkota_KacangTanah
```

```{r}

# Visualisasi dengan barplot
plot_KacangTanah_3 <- ggplot(totrataproduksi_kabkota_KacangTanah, aes(x = Kabupaten_Kota, y = total_rataproduksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Rata_rata Produksi Kacang Tanah antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Rata_rata Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_KacangTanah_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Perbandingan Rata-rata produksi dengan Produksi Kacang Tanah

```{r}
# Create a boxplot using ggplot2
plot_KacangTanah_4 <- ggplot(Kacang_Tanah, aes(x = Kabupaten_Kota, y = Produksi - Rata_rata_produksi, fill = Kabupaten_Kota)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Rata-rata Produksi per Kabupaten/Kota", x = "Kabupaten/Kota", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_KacangTanah_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```


## Curah hujan terhadap Kacang Tanah

```{r}
# Ambil data Kacang Tanah di dataset tanaman pangan yang belum di filter sumatera utara 
KacangTanah_Sumut <- tanaman_pangan_clean[tanaman_pangan_clean$Nama_Tanaman_Pangan == "Kacang Tanah",]
KacangTanah_Sumut
```

```{r}
# Filter data for "Sumatera Utara" kabupaten
sumut_data_KacangTanah<- KacangTanah_Sumut %>%
  filter(Kabupaten_Kota == "Sumatera Utara")
sumut_data_KacangTanah
```

```{r}
# Mengabungkan kedua dataset
merged_data_KacangTanah <- merge(sumut_data_KacangTanah, rainfall_yearly, by.x = "Tahun", by.y = "year")
merged_data_KacangTanah
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_for_var_KacangTanah <- merged_data_KacangTanah[, c("Rata_rata_produksi", "avg_rainfall")]
data_for_var_KacangTanah
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_data_KacangTanah <- ts(data_for_var_KacangTanah, start = c(2010,1), frequency = 1)
ts_data_KacangTanah
```

```{r}
best_lag_KacangTanah <- VARselect(ts_data_KacangTanah, lag.max = 5, type = "both")
best_lag_KacangTanah
```

```{r}
# VAR Model
var_model_KacangTanah <- VAR(ts_data_KacangHijau, p = best_lag_KacangTanah$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_KacangTanah)
```

Model VAR yang digunakan menunjukkan bahwa ada beberapa koefisien regresi yang signifikan secara statistik. Dalam hal ini, koefisien lag pertama Rata_rata_produksi.l1 adalah -3.2634 dan signifikan pada tingkat signifikansi 0.05, yang mengindikasikan adanya dampak yang signifikan dari variabel Rata_rata_produksi pada dirinya sendiri pada periode sebelumnya. Namun, koefisien lag pertama avg_rainfall.l1 adalah -0.5136 dan tidak signifikan pada tingkat signifikansi 0.05.

Multiple R-Squared untuk model ini adalah 0.9624, yang menunjukkan tingkat variasi yang dapat dijelaskan oleh model terhadap variabel respons (Rata_rata_produksi). Namun, untuk variabel curah hujan rata-rata (avg_rainfall), Multiple R-Squared adalah 0.7683.

Hasil uji F-statistic menunjukkan bahwa model secara keseluruhan tidak signifikan (p-value > 0.05), yang berarti bahwa model tidak dapat secara statistik menjelaskan hubungan antara curah hujan rata-rata dan produksi kacang hijau.

Hasil analisis Granger Causality juga tidak memberikan cukup bukti statistik untuk mendukung adanya hubungan sebab-akibat antara curah hujan rata-rata (avg_rainfall) dan produksi kacang hijau (Rata_rata_produksi).

Dengan demikian, berdasarkan analisis ini, tidak ada cukup bukti statistik yang mendukung hubungan sebab-akibat antara curah hujan rata-rata dan produksi kacang hijau.


```{r}
# Melakukan uji Granger Causality
granger_test_KacangTanah <- causality(var_model_KacangTanah, cause = "avg_rainfall")
granger_test_KacangTanah
```
Secara keseluruhan, berdasarkan hasil uji Granger Causality dan Instantaneous Causality, tidak ada bukti statistik yang kuat untuk mendukung adanya hubungan sebab-akibat antara "avg_rainfall" dan "Rata_rata_produksi" dalam model VAR, baik dalam jangka waktu lag maupun dalam jangka waktu instan.


```{r}
# Membuat model regresi linier
regression_model_KacangTanah <- lm(Rata_rata_produksi ~ avg_rainfall, data = data_for_var_KacangTanah)

# Ringkasan hasil model
summary(regression_model_KacangTanah)
```

Dilihat dari model regresi juga kelihatan bahwa tidak ada pengaruh curah hujan terhadap produksi padi

```{r}
# Menghitung koefisien korelasi Pearson
correlation_KacangTanah <- cor(data_for_var_KacangTanah$Rata_rata_produksi, data_for_var_KacangTanah$avg_rainfall)
correlation_KacangTanah
```

Dilihat dari hubungan negatif, artinya tingginya curah hujan biasanya berhubungan dengan rata-rata produksi yang rendah.


#8. Kacang Kedelai

```{r}
# Ambil data Kacang Kedelai dari dataset tanaman pangan 
Kacang_Kedelai <- tanaman_pangan_filter[tanaman_pangan_filter$Nama_Tanaman_Pangan == "Kacang Kedelai",]
Kacang_Kedelai
```

## EDA Kacang Kedelai

### Jumlah Produksi Kacang Kedelai per Kabupaten/Kota
```{r}
# Hitung total produksi Kacang_Kedelai per kabupaten/kota di setiap tahun
totproduksi_Kedelai <- Kacang_Kedelai %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi))

totproduksi_Kedelai
```


```{r}
# Hitung total produksi Kacang Kedelai  per setiap Kabupaten/Kota
totproduksi_kabkota_Kedelai <- Kacang_Kedelai %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_kabkota_Kedelai
```


### Tren Produksi Kacang Kedelai  per Kabupaten/Kota


```{r}
# Visualisasi Tren Produksi Kacang Kedelai  per kabupaten/kota di setiap tahun
plot_Kedelai_1 <- ggplot(totproduksi_Kedelai, aes(x = Tahun, y = total_produksi, color = Kabupaten_Kota)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Kacang Kedelai ", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_Kedelai_1
```


```{r}

# Visualisasi dengan barplot total produksi Kacang Kedelai  di setiap kabupaten/kota
plot_Kedelai_2<- ggplot(totproduksi_kabkota_UbiJalar, aes(x = Kabupaten_Kota, y = total_produksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Kacang Kedelai  antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_Kedelai_2 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Kacang Kedelai dalam kurun waktu 2010 - 2022 adalah dari Simalungu yang terbanyak dengan Jumlah Produksi 16699.54	

### Perbandingan Rata-rata produksi Kacang Kedelai  per Kabupaten/Kota

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren rata-rata produksi Kacang Kedelai 
rataproduksi_Kedelai <- Kacang_Kedelai %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(Rata_rata_produksi = sum(Rata_rata_produksi))
rataproduksi_Kedelai
```

```{r}
# Hitung total rata-rata produksi Kacang Kedelai per Kabupaten/Kota
totrataproduksi_kabkota_Kedelai <- Kacang_Kedelai %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_rataproduksi = sum(Rata_rata_produksi)) %>%
  arrange(desc(total_rataproduksi))
totrataproduksi_kabkota_Kedelai
```

```{r}

# Visualisasi dengan barplot
plot_Kedelai_3 <- ggplot(totrataproduksi_kabkota_Kedelai, aes(x = Kabupaten_Kota, y = total_rataproduksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Rata_rata Produksi Kacang Kedelai antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Rata_rata Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_Kedelai_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Perbandingan Rata-rata produksi dengan Produksi Kacang Kedelai

```{r}
# Create a boxplot using ggplot2
plot_Kedelai_4 <- ggplot(Kacang_Kedelai, aes(x = Kabupaten_Kota, y = Produksi - Rata_rata_produksi, fill = Kabupaten_Kota)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Rata-rata Produksi per Kabupaten/Kota", x = "Kabupaten/Kota", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_Kedelai_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

## Curah hujan terhadap Kacang Kedelai

```{r}
# Ambil data Kacang Kedelai di dataset tanaman pangan yang belum di filter sumatera utara 
Kedelai_Sumut <- tanaman_pangan_clean[tanaman_pangan_clean$Nama_Tanaman_Pangan == "Kacang Kedelai",]
Kedelai_Sumut
```

```{r}
# Filter data for "Sumatera Utara" kabupaten
sumut_data_Kedelai<- Kedelai_Sumut %>%
  filter(Kabupaten_Kota == "Sumatera Utara")
sumut_data_Kedelai
```

```{r}
# Mengabungkan kedua dataset
merged_data_Kedelai <- merge(sumut_data_Kedelai, rainfall_yearly, by.x = "Tahun", by.y = "year")
merged_data_Kedelai
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_for_var_Kedelai <- merged_data_Kedelai[, c("Rata_rata_produksi", "avg_rainfall")]
data_for_var_Kedelai
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_data_Kedelai <- ts(data_for_var_Kedelai, start = c(2010,1), frequency = 1)
ts_data_Kedelai
```

```{r}
best_lag_Kedelai <- VARselect(ts_data_Kedelai, lag.max = 2, type = "both")
best_lag_Kedelai
```

```{r}
# VAR Model
var_model_Kedelai <- VAR(ts_data_Kedelai, p = best_lag_Kedelai$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_Kedelai)
```

Kalau dilihat dari hasil model VAR diatas, peningkatan curah hujan pada lag 1 akan cenderung menyebabkan penurunan produksi kacang kedelai saat ini, sementara peningkatan curah hujan pada lag 2 akan cenderung menyebabkan peningkatan produksi kacang kedelai saat ini.

p-value F-statistic adalah 0.06078, dan  0.7444 yang lebih besar dari 0.05. Oleh karena itu, berdasarkan tingkat signifikansi 0.05, kita tidak dapat mengatakan bahwa model secara keseluruhan signifikan. 

```{r}
# Melakukan uji Granger Causality
granger_test_Kedelai<- causality(var_model_Kedelai, cause = "avg_rainfall")
granger_test_Kedelai
```

*Uji Granger* menyatakan bahwa "avg_rainfall" Granger-cause "Rata_rata_produksi." Dalam konteks ini, terdapat bukti yang mendukung adanya hubungan sebab-akibat antara curah hujan rata-rata ("avg_rainfall") dan produksi kedelai ("Rata_rata_produksi").

*Uji Instant* P-value dari uji chi-squared adalah 0.7063. Dalam uji ini, p-value lebih besar dari 0.05, yang menunjukkan bahwa Anda tidak dapat menolak hipotesis nol. Ini berarti bahwa tidak ada bukti statistik yang cukup untuk menyatakan bahwa terdapat hubungan causality instan antara "avg_rainfall" dan "Rata_rata_produksi."


```{r}
# Membuat model regresi linier
regression_model_Kedelai<- lm(Rata_rata_produksi ~ avg_rainfall, data = data_for_var_Kedelai)

# Ringkasan hasil model
summary(regression_model_Kedelai)
```

Dalam kesimpulan, hasil regresi linier ini menunjukkan bahwa tidak ada bukti statistik yang cukup untuk menyatakan bahwa curah hujan rata-rata ("avg_rainfall") memiliki pengaruh signifikan terhadap produksi kacang kedelai ("Rata_rata_produksi"). Hasil ini mencerminkan kurangnya hubungan linear yang kuat antara kedua variabel tersebut dalam kerangka model ini.

```{r}
# Menghitung koefisien korelasi Pearson
correlation_Kedelai <- cor(data_for_var_Kedelai$Rata_rata_produksi, data_for_var_Kedelai$avg_rainfall)
correlation_Kedelai
```

koefisien korelasi Pearson adalah -0.2732312, yang mendekati -1. Ini mengindikasikan bahwa terdapat hubungan negatif antara curah hujan rata-rata ("avg_rainfall") dan produksi kacang kedelai ("Rata_rata_produksi"). Artinya, ketika curah hujan rata-rata meningkat, produksi kacang kedelai cenderung menurun, dan sebaliknya.


#9. Jagung

```{r}
# Ambil data Jagung dari dataset tanaman pangan 
Jagung <- tanaman_pangan_filter[tanaman_pangan_filter$Nama_Tanaman_Pangan == "Jagung",]
Jagung
```

## EDA Jagung

### Jumlah Produksi Jagung per Kabupaten/Kota
```{r}
# Hitung total produksi Jagung per kabupaten/kota di setiap tahun
totproduksi_Jagung <-Jagung %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi))

totproduksi_Jagung
```


```{r}
# Hitung total produksi Jagung per setiap Kabupaten/Kota
totproduksi_kabkota_Jagung <- Jagung %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_kabkota_Jagung
```


### Tren Produksi Jagung per Kabupaten/Kota


```{r}
# Visualisasi Tren Produksi tanaman pangan per kabupaten/kota di setiap tahun
plot_Jagung_1 <- ggplot(totproduksi_Jagung, aes(x = Tahun, y = total_produksi, color = Kabupaten_Kota)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Jagung", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_Jagung_1
```


```{r}

# Visualisasi dengan barplot total produksi padi di setiap kabupaten/kota
plot_Jagung_2<- ggplot(totproduksi_kabkota_Jagung, aes(x = Kabupaten_Kota, y = total_produksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Jagung antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_Jagung_2 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
Perbandingan produksi Jagung dalam kurun waktu 2011 - 2022 adalah dari Karo yang terbanyak dengan Jumlah Produksi 11164760.42	ton

### Perbandingan Rata-rata produksi Jagung per Kabupaten/Kota

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE)

# Melihat tren rata-rata produksi Jagung
rataproduksi_Jagung<- Jagung %>% 
  group_by(Tahun, Kabupaten_Kota, .drop = FALSE) %>%  # Add .drop argument
  summarise(Rata_rata_produksi = sum(Rata_rata_produksi))
rataproduksi_Jagung
```

```{r}
# Hitung total rata-rata produksi padi per Kabupaten/Kota
totrataproduksi_kabkota_Jagung<- Jagung %>% 
  group_by(Kabupaten_Kota) %>% 
  summarise(total_rataproduksi = sum(Rata_rata_produksi)) %>%
  arrange(desc(total_rataproduksi))
totrataproduksi_kabkota_Jagung
```

```{r}

# Visualisasi dengan barplot
plot_Jagung_3 <- ggplot(totrataproduksi_kabkota_Jagung, aes(x = Kabupaten_Kota, y = total_rataproduksi, fill = Kabupaten_Kota)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Rata_rata Produksi Jagung antara Kabupaten/Kota", x = "Kabupaten/Kota", y = "Rata_rata Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_Jagung_3 + theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Perbandingan Rata-rata produksi dengan Produksi Jagung

```{r}
# Create a boxplot using ggplot2
plot_Jagung_4 <- ggplot(Jagung, aes(x = Kabupaten_Kota, y = Produksi - Rata_rata_produksi, fill = Kabupaten_Kota)) +
  geom_boxplot() +
  labs(title = "Perbandingan Produksi dan Rata-rata Produksi per Kabupaten/Kota", x = "Kabupaten/Kota", y = "Selisih Produksi") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")

# Rotasi sumbu x agar mudah dibaca
plot_Jagung_4 + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```
### Korelasi Luas Panen dan Produksi Padi

```{r}
# Visualisasi korelasi luas panen dan produksi padi
plot_Jagung_5 <- ggplot(Jagung, aes(x = Luas_Panen, y = Produksi, color = Kabupaten_Kota)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_Jagung_5
```

```{r}
# Hitung Pearson correlation coefficient
correlation_Jagung <- cor(Jagung$Luas_Panen, Jagung$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_Jagung)
```

## Curah hujan terhadap Jagung

```{r}
# Ambil data Kacang Kedelai di dataset tanaman pangan yang belum di filter sumatera utara 
Jagung_Sumut <- tanaman_pangan_clean[tanaman_pangan_clean$Nama_Tanaman_Pangan == "Jagung",]
Jagung_Sumut
```

```{r}
# Filter data for "Sumatera Utara" kabupaten
sumut_data_Jagung<- Jagung_Sumut %>%
  filter(Kabupaten_Kota == "Sumatera Utara")
sumut_data_Jagung
```

```{r}
# Mengabungkan kedua dataset
merged_data_Jagung <- merge(sumut_data_Jagung, rainfall_yearly, by.x = "Tahun", by.y = "year")
merged_data_Jagung
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_for_var_Jagung <- merged_data_Jagung[, c("Rata_rata_produksi", "avg_rainfall")]
data_for_var_Jagung
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_data_Jagung <- ts(data_for_var_Jagung, start = c(2010,1), frequency = 1)
ts_data_Jagung
```

```{r}
best_lag_Jagung <- VARselect(ts_data_Jagung, lag.max = 5, type = "both")
best_lag_Jagung
```

```{r}
# VAR Model
var_model_Jagung <- VAR(ts_data_Jagung, p = best_lag_Jagung$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_Jagung)
```

###Revisi

Untuk persamaan "Rata_rata_produksi":
Koefisien "avg_rainfall.l1" adalah -3.9523.
P-value untuk "avg_rainfall.l1" adalah 0.427.
Koefisien "avg_rainfall.l1" adalah negatif, yang berarti bahwa ada hubungan negatif antara curah hujan rata-rata dan produksi jagung dalam periode lalu (lag 1). Namun, p-value adalah 0.427, yang lebih besar dari 0.05 (tingkat signifikansi yang umumnya digunakan). Ini menunjukkan bahwa dalam periode lalu (lag 1), pengaruh curah hujan rata-rata tidak signifikan secara statistik terhadap produksi jagung.

Untuk persamaan "avg_rainfall":
Koefisien "Rata_rata_produksi.l1" adalah 0.10642.
P-value untuk "Rata_rata_produksi.l1" adalah 0.789.
Koefisien "Rata_rata_produksi.l1" adalah positif, namun p-value adalah 0.789, yang juga lebih besar dari 0.05. Ini menunjukkan bahwa dalam periode lalu (lag 1), pengaruh produksi jagung tidak signifikan secara statistik terhadap curah hujan rata-rata.

Selain itu, nilai-nilai Adjusted R-squared (R-squared yang disesuaikan) untuk kedua persamaan tersebut juga rendah, menunjukkan bahwa model VAR ini mungkin tidak sangat baik dalam menjelaskan hubungan antara kedua variabel.


```{r}
# Melakukan uji Granger Causality
granger_test_Jagung<- causality(var_model_Jagung, cause = "avg_rainfall")
granger_test_Jagung
```
hasil uji Granger Causality menunjukkan bahwa dalam model VAR yang Anda gunakan, tidak ada bukti statistik yang mendukung hubungan sebab-akibat antara curah hujan rata-rata ("avg_rainfall") dan produksi jagung ("Rata_rata_produksi"). Baik uji Granger maupun uji causality instan tidak menemukan hubungan yang signifikan antara kedua variabel tersebut dalam kerangka model ini


```{r}
# Membuat model regresi linier
regression_model_Jagung<- lm(Rata_rata_produksi ~ avg_rainfall, data = data_for_var_Jagung)

# Ringkasan hasil model
summary(regression_model_Jagung)
```

hasil regresi linier ini menunjukkan bahwa ada kemungkinan pengaruh curah hujan rata-rata ("avg_rainfall") terhadap produksi jagung rata-rata ("Rata_rata_produksi"). Namun, pengaruh ini mungkin tidak terlalu kuat, dan ada sedikit bukti statistik yang mendukung signifikansinya. 

```{r}
# Menghitung koefisien korelasi Pearson
correlation_Jagung <- cor(data_for_var_Jagung$Rata_rata_produksi, data_for_var_Jagung$avg_rainfall)
correlation_Jagung
```
oefisien korelasi Pearson adalah -0.5196848, yang mendekati -1. Ini menunjukkan bahwa ada hubungan negatif antara curah hujan rata-rata ("avg_rainfall") dan produksi jagung rata-rata ("Rata_rata_produksi"). Artinya, ketika curah hujan rata-rata meningkat, produksi jagung rata-rata cenderung menurun, dan sebaliknya.



#10. Padi Sumatera tahun 1993-2020

## Obstain - Load Dataset Padi Sumatera tahun 1993-2020

```{r}
sumatera_padi <- read.csv("D:/OneDrive - mikroskil.ac.id/Skripsi/Data_Tanaman_Padi_Sumatera_V1.csv")
sumatera_padi
```


```{r}
# Merubah nama variabel 
names(sumatera_padi)[names(sumatera_padi) == "Curah.hujan"] <- "Curah_hujan"
names(sumatera_padi)[names(sumatera_padi) == "Suhu.rata.rata"] <- "Suhu_rata_rata"
names(sumatera_padi)[names(sumatera_padi) == "Luas.Panen"] <- "Luas_panen"
glimpse(sumatera_padi)
```
### a. Merubah type data
```{r}
# Merubah type data karakter menjadi numeric
sumatera_padi$Produksi <- as.numeric(sumatera_padi$Produksi)
sumatera_padi$`Luas_panen` <- as.numeric(sumatera_padi$Luas_panen)
sumatera_padi$Curah_hujan <- as.numeric(sumatera_padi$Curah_hujan)
sumatera_padi$Kelembapan <- as.numeric(sumatera_padi$Kelembapan)
sumatera_padi$Suhu_rata_rata <- as.numeric(sumatera_padi$Suhu_rata_rata)
sumatera_padi
```

```{r}
# Merubah type Tahun menjadi Date
sumatera_padi$Tahun <- make_date(sumatera_padi$Tahun)
glimpse(sumatera_padi)
```
### b. Menghapus Data Kosong

```{r}
# Menampikan variabel dengan baris kosong
colSums(is.na(sumatera_padi))
```

## EDA Padi Sumatera tahun 1993-2020

### Jumlah Produksi Padi per Provinsi

```{r}
plot_sumatera <- ggplot(sumatera_padi, aes(x = Tahun, y = Produksi, group = Provinsi, color = Provinsi)) +
  geom_line() +
  labs(title = "Jumlah Produksi Padi", x = "Tahun", y = "Produksi Padi (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_sumatera

```

```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE) # untuk menonaktifkan pesan peringatan yang biasanya muncul ketika Anda menggunakan summarise() untuk menghitung statistik tertentu

# Hitung total produksi per kabupaten di setiap tahun
totproduksi <- sumatera_padi %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi))

totproduksi
```

### Tren Produksi Padi per Provinsi

```{r}
# Visualisasi Tren Produksi Padi
plot_2_sumatera <- ggplot(totproduksi, aes(x = Tahun, y = total_produksi, color = Provinsi)) +
  geom_line() +
  geom_point() +
  labs(title = "Tren Produksi Padi di Sumatera", x = "Tahun", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_2_sumatera
```

```{r}
# Hitung total produksi padi per Provinsi dan kemudian di urutkan dari yang tertingi ke terkecil
totproduksi_provinsi <- sumatera_padi %>% 
  group_by(Provinsi) %>% 
  summarise(total_produksi = sum(Produksi))%>%
  arrange(desc(total_produksi))
  
totproduksi_provinsi
```

Jadi produksi tertingi di sumatera tahun 1993-2020 adalah dari provinsi Sumatera Utara yaitu sebesar 93253195 ton


```{r}
# Visualisasi Produksi tertingi Provinsi dengan barplot
plot_3_sumatera <- ggplot(totproduksi_provinsi, aes(x = Provinsi, y = total_produksi, fill = Provinsi)) +
  geom_bar(stat = "identity") +
  labs(title = "Perbandingan Produksi Padi antara Provinsi di Sumatera", x = "Provinsi", y = "Total Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "none")  # hilangkan legend

# Rotasi sumbu x agar mudah dibaca
plot_3_sumatera + theme(axis.text.x = element_text(angle = 45, hjust = 1))
```

Perbandingan produksi padi dalam kurun waktu 1993 - 2020 adalah dari provinsi sumatera utara yang terbanyak dengan Jumlah Produksi Padi sebesar 93253195 ton


### Korelasi Luas Panen dan Produksi Padi

```{r}
#menghitung total luas panen lalu mengurutkan dari terbesar
totluaspanen_sumatera<- sumatera_padi %>% 
  group_by(Provinsi) %>% 
  summarise(total_luas_panen = sum(Luas_panen)) %>%
  arrange(desc(total_luas_panen))

totluaspanen_sumatera
```

```{r}
# Visualisasi korelasi luas panen dan produksi padi
plot_5_sumatera <- ggplot(sumatera_padi, aes(x = Luas_panen, y = Produksi, color = Provinsi)) +
  geom_point() +
  labs(title = "Korelasi Produksi dan Luas Panen di Sumatera", x = "Luas Panen (Ha)", y = "Produksi (Ton)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_5_sumatera
```

```{r}
# Hitung Pearson correlation coefficient
correlation_sumatera<- cor(sumatera_padi$Luas_panen, sumatera_padi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_sumatera)
```

Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas
panen dan produksi. Hubungan korelasi adalah positif dengan nilai
korelasi sebesar 0,90, sehingga bisa disimpulkan bahwa jika semakin
banyak luas panen maka akan meningkat jumlah produksi padi.


### Curah hujan Terhadap produksi Padi Sumatera


```{r}
# Pilih variabel yang akan diprediksi di dataset sumatera
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi

Var_sumatera <- sumatera_padi[, c("Curah_hujan", "Produksi")] #subdataset yang hanya berisikan 2 kolom
Var_sumatera
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_sumatera <- ts(Var_sumatera, start = c(1993,1), frequency = 1)
ts_sumatera
```

```{r}
#menetukan jumlah lag yang optimal dlm Var
best_lag_sumatera <- VARselect(ts_sumatera, lag.max = 5, type = "both")
best_lag_sumatera

#akan berisi hasil pemilihan model VAR terbaik berdasarkan perbandingan AIC dan BIC untuk berbagai jumlah lag
```

```{r}
# VAR Model
var_model_sumatera <- VAR(ts_sumatera, p = best_lag_sumatera$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_sumatera)

#Tujuan dari coding ini adalah untuk membangun model VAR yang sesuai dengan jumlah lag terbaik yang telah Anda tentukan sebelumnya dan kemudian menganalisis model tersebut dengan melihat ringkasan yang dihasilkan. 
```

*Kesimpulan*
-Estimation results for equation Curah_hujan:
Pada "Curah_hujan lag 1,2,3 dan 4 terdapat hubungan positif yang signifikan (p-value < 0.05) antara curah hujan dan dirinya sendiri. Ini menunjukkan bahwa curah hujan pada lag 1,2,3 dan 4 memiliki pengaruh yang signifikan terhadap dirinya sendiri. F-statistic p-value adalah 2.171e-13  sehingga dapat menyimpulkan bahwa model VAR tersebut memiliki efek statistik yang signifikan dan kuat dalam menjelaskan hubungan antara variabel-variabel tersebut.

-Estimation results for equation Produksi:
Pada "Produksi.l1" (lag 1), terdapat hubungan positif yang signifikan (p-value < 0.05) antara produksi tanaman padi dan curah hujan pada lag 1. Ini menunjukkan bahwa curah hujan pada lag 1 memiliki pengaruh yang signifikan terhadap produksi tanaman padi. Selain itu, "Produksi.l4" (lag 4) juga memiliki hubungan positif yang signifikan dengan curah hujan pada tingkat signifikansi 0.05. Ini mengindikasikan pengaruh positif yang signifikan dari curah hujan pada lag 4 terhadap produksi. F-statistic p-value adalah < 2.2e-16 (nilai yang sangat kecil, mendekati nol) sehingga dapat menyimpulkan bahwa model VAR tersebut memiliki efek statistik yang signifikan dan kuat dalam menjelaskan hubungan antara variabel-variabel tersebut.


```{r}
# Melakukan uji Granger Causality
granger_test_sumatera <- causality(var_model_sumatera, cause = "Curah_hujan")
granger_test_sumatera

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```
*Kesimpulan*
-Granger P-value adalah 0.0972.
Hasil ini menunjukkan bahwa pada tingkat signifikansi 0.05, tidak ada cukup bukti statistik untuk mendukung hipotesis bahwa "Curah_hujan menjadi penyebab Granger dari Produksi
-Instant P-value adalah 0.08623.
Hasil ini menunjukkan bahwa pada tingkat signifikansi 0.05, tidak ada cukup bukti statistik untuk mendukung adanya hubungan kausal instan (pengaruh yang terjadi secara langsung) antara Curah_hujan dan Produksi. Meskipun p-value (0.08623) mendekati tingkat signifikansi 0.05, hasil ini belum mencapai tingkat signifikansi yang umumnya digunakan.


```{r}
# Membuat model regresi linier
regression_model_sumatera <- lm(Produksi ~ Curah_hujan, data = Var_sumatera)

# Ringkasan hasil model
summary(regression_model_sumatera)
```
*kesimpulan*

model regresi linier ini tidak memberikan bukti yang kuat untuk mengatakan bahwa curah hujan memiliki pengaruh yang signifikan terhadap produksi tanaman padi dalam data Anda. Koefisien "Curah_hujan" tidak signifikan, dan model regresi ini memiliki nilai R-squared yang sangat rendah, menunjukkan bahwa model ini tidak efektif dalam menjelaskan variasi dalam produksi.

```{r}
# Menghitung koefisien korelasi Pearson
correlation_sumatera <- cor(Var_sumatera$Produksi, Var_sumatera$Curah_hujan)
correlation_sumatera

```
*Kesiimpulan*

Hasil (-0.0421286) menunjukkan adanya korelasi negatif yang sangat lemah antara kedua variabel tersebut. Korelasi negatif menunjukkan bahwa saat satu variabel naik, variabel lainnya cenderung turun, dan sebaliknya. Meskipun ada korelasi, nilainya sangat rendah, sehingga hubungan antara curah hujan dan produksi tanaman padi tidak terlalu kuat.


# 11. Curah hujan dan tanaman padi provinsi Sumatera Utara tahun 1993-2020

## Curah hujan terhadap tanaman padi sumut tahun 1993-2020

```{r}
#mengambil data sumut saja
sumut_padi_filter <- sumatera_padi %>%
  filter(Provinsi == "Sumatera Utara")
sumut_padi_filter
```

## Eksplorasi Data Analisis (EDA) Sumut padi tahun 1993-2020

### Jumlah Produksi Padi tertingi berdasarkan tahun
```{r}
# Turn off dplyr summarise() warning
options(dplyr.summarise.inform = FALSE) # untuk menonaktifkan pesan peringatan yang biasanya muncul ketika Anda menggunakan summarise() untuk menghitung statistik tertentu

# Hitung total produksi padi di setiap tahun
totproduksi <- sumut_padi_filter %>% 
  group_by(Tahun, Provinsi, .drop = FALSE) %>%  # Add .drop argument
  summarise(total_produksi = sum(Produksi)) %>%
  arrange(desc(total_produksi))

totproduksi
```
Tahun tertinggi Produksi padi di sumatera utara adalah tahun 2017

```{r}
#Menvisualisasikan jumlah produksi tertingi di setiap tahun di Provinsi Sumut

plot_sumut_padi <- ggplot(sumut_padi_filter, aes(x = Tahun, y = Produksi, color = Produksi)) +
  geom_line() +
  geom_point() +
  labs(title = "Jumlah Produksi Padi", x = "Tahun", y = "Produksi Padi (Ha)") +
  scale_y_continuous(labels = scales::comma) +
  theme_minimal() +
  theme(legend.position = "right")
plot_sumut_padi
```


```{r}
# Hitung Pearson correlation coefficient
correlation_padi <- cor(sumut_padi_filter$Luas_panen, sumut_padi_filter$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", correlation_padi)
```
Berdasarkan grafik diatas bisa lihat bahwa ada korelasi antara luas panen dan produksi. Hubungan korelasi adalah positif dengan nilai korelasi sebesar 0,23, sehingga bisa disimpulkan bahwa jika Luas Panen meningkat, Produksi juga cenderung meningkat, tetapi tingkat kenaikan dalam Produksi tidak sangat dipengaruhi oleh kenaikan dalam Luas Panen.


```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi

Var_sumut_padi <- sumut_padi_filter[, c("Produksi", "Curah_hujan")] #subdataset yang hanya berisikan 2 kolom
Var_sumut_padi
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_sumut_padi <- ts(Var_sumut_padi, start = c(1993,1), frequency = 1)
ts_sumut_padi
```

```{r}
#menetukan jumlah lag yang optimal dlm Var
best_lag_sumut_padi <- VARselect(ts_sumut_padi, lag.max = 5, type = "both")
best_lag_sumut_padi

#akan berisi hasil pemilihan model VAR terbaik berdasarkan perbandingan AIC dan BIC untuk berbagai jumlah lag
```

```{r}
# VAR Model
var_model_sumut_padi <- VAR(ts_sumut_padi, p = best_lag_sumut_padi$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_sumut_padi)

#Tujuan dari coding ini adalah untuk membangun model VAR yang sesuai dengan jumlah lag terbaik yang telah Anda tentukan sebelumnya dan kemudian menganalisis model tersebut dengan melihat ringkasan yang dihasilkan. 
```
*Kesimpulan*
- Hasil estimasi persamaan Produksi :
Produksi.l1 Estimatsinya adalah 2.023e-01 dan p-valuenya 0.56399   dan Curah_hujan.l1  2.292e+01 dan p-valuenya 0.88387 . tetapi Variabel "Produksi" pada lag 3 memiliki pengaruh signifikan (p-value < 0.01) terhadap dirinya sendiri. Namun, pengaruh variabel "Curah_hujan" pada "Produksi" dan sebaliknya tampaknya tidak signifikan pada tingkat signifikansi yakni 0,05. 
p-value adalah 0.06235  pada F-statistiknya menunjukan bahwa P-value yang lebih besar dari tingkat signifikansi yang telah ditetapkan (0.05) menunjukkan bahwa secara keseluruhan, model regresi VAR ini tidak signifikan. 

- Hasil estimasi persamaan Curah_hujan :
"Produksi.l1" dengan p-value 0.0363 berarti bahwa pada lag 1, "Produksi" memiliki pengaruh yang signifikan pada "Curah_hujan.
Curah_hujan.l1 dengan p-valuenya 0.3728  berarti bahwa pada lag 1, "Curah_hujan" tidak memiliki pengaruh yang signifikan pada "Produksi.
p-value pada F-statistik adalah 0.5304 P-value yang lebih tinggi dari tingkat signifikansi (0.05) menunjukkan bahwa secara keseluruhan, model ini tidak signifikan dalam menjelaskan hubungan antara kedua variabel tersebut.

```{r}
# Melakukan uji Granger Causality
granger_test_sumut_padi <- causality(var_model_sumut_padi, cause = "Curah_hujan")
granger_test_sumut_padi

#Uji Granger Causality digunakan untuk menguji apakah suatu variabel dapat digunakan untuk memprediksi variabel lain dalam model VAR
```
*Granger*
P-value adalah 0.445.
Hasil ini menunjukkan bahwa pada tingkat signifikansi 0.05, tidak ada cukup bukti statistik untuk mendukung hipotesis bahwa "Curah_hujan menjadi penyebab Granger dari Produksi." Dengan kata lain, berdasarkan hasil ini, tidak ada bukti statistik yang mendukung adanya hubungan kausal dari curah hujan ke produksi tanaman padi dalam model VAR.

*Instant*
P-value adalah 0.05523.
Hasil ini menunjukkan bahwa pada tingkat signifikansi 0.05, terdapat bukti yang hampir signifikan (p-value mendekati 0.05) yang mengindikasikan adanya hubungan kausal instan antara Curah_hujan dan Produksi. Namun, hasil ini belum mencapai tingkat signifikansi 0.05 secara eksak, sehingga mungkin perlu melakukan analisis lebih lanjut untuk memahami apakah hubungan ini benar-benar signifikan atau mungkin hanya karena fluktuasi kecil dalam data.

```{r}
# Membuat model regresi linier
regression_model_sumut_padi <- lm(Produksi ~ Curah_hujan, data = Var_sumut_padi)

# Ringkasan hasil model
summary(regression_model_sumut_padi)
```
*Kesimpulan* 
tidak ada bukti statistik yang cukup untuk mendukung bahwa "Curah_hujan" memiliki pengaruh yang signifikan terhadap "Produksi." Nilai p-value untuk koefisien "Curah_hujan" adalah lebih besar dari tingkat signifikansi (0.05). Selain itu, Multiple R-squared yang rendah juga menunjukkan bahwa variabel "Curah_hujan" tidak menjelaskan variasi yang signifikan dalam "Produksi."

```{r}
# Menghitung koefisien korelasi Pearson
correlation_sumut_padi <- cor(Var_sumut_padi$Produksi, Var_sumut_padi$Curah_hujan)
correlation_sumut_padi
```
*Kesimpulan*
Nilai korelasi sekitar 0.2187 mengindikasikan bahwa ada korelasi positif antara "Produksi" dan "Curah_hujan," tetapi korelasinya lemah. hasil ini menunjukkan bahwa ada hubungan positif antara kenaikan curah hujan dan kenaikan produksi tanaman padi, namun hubungan ini tidak kuat.


## Scenario baru 1

-Menggunakan koefisien korelasi Pearson pada scenario pengujian hubungan antara jumlah curah hujan pada luas panen karena Koefisien korelasi Pearson adalah metode yang paling sesuai untuk mengukur hubungan linear antara dua variabel. Dapat mengetahui sejauh mana perubahan dalam satu variabel (curah hujan) berkaitan dengan perubahan dalam variabel lain (produksi atau luas panen) dalam hubungan yang bersifat linear. 

*A.Curah hujan terhadap luas panen padi di Sumatera 1993-2020*

### Sebelum menggunakan korelasi pearson, saya akan memodelkan VAR curah hujan terhadap luas panen padi di Sumatera tahun 1993-2020

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh Luas panen terhadap peningkatan produksi
var_luaspanen_1 <- sumatera_padi[, c("Produksi", "Luas_panen")]
var_luaspanen_1
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_luaspanen_1 <- ts(var_luaspanen_1, start = c(1993,1), frequency = 1)
ts_luaspanen_1
```

```{r}
lag_luaspanen_1 <- VARselect(ts_luaspanen_1, lag.max = 5, type = "both")
lag_luaspanen_1
```

```{r}
# VAR Model
Model_Var1_luaspanen <- VAR(ts_luaspanen_1, p = lag_luaspanen_1$selection[1], type = "both") # jumlah order dari model VAR
summary(Model_Var1_luaspanen)
```


*Kesimpulan*
- Estimation results for equation Produksi: 
Nilai p-value Luas_panen.l1 yaitu 0.816399 tetapi  Luas_panen.l2, l3 dan l4 memiliki p-valuenya elbih kecil dari 0,05 yaitu ( 4.30e-13*** , 1.02e-08*** , dan 0.002209 **   ) dan Produksi l1.l2.l3.dan l.4 memilki p-value lebih kecil dari 0,05 dan nila f-statistikap-valuenya adalah < 2.2e-16 sehingga dapat disimpulkan bahwa terdapat pengaruh luas panen terhadap produksi. 




```{r}
# Melakukan uji Granger Causality
granger_luaspanen_1 <- causality(Model_Var1_luaspanen, cause = "Luas_panen")
granger_luaspanen_1
```
*Granger causality*
F-Test = 28.8
p-value = < 2.2e-16
Kesimpulan: P-value lebih kecil dari 0,05. Oleh karena itu, ada bukti yang cukup kuat untuk menyatakan bahwa Luas panen secara statistik signifikan  berpengaruh jangka panjang terhadapa produksi padi. 

*Instantaneous causality*
Chi-squared = 45.105
p-value = 1.868e-11
Kesimpulan: P-value lebih kecil dari 0,05 Ini menunjukkan bahwa tidak ada bukti yang cukup kuat untuk mendukung adanya pengaruh jangka pendek antara Luas_panen dan produksi padi.


```{r}
# Membuat model regresi linier
regression_1 <- lm(Luas_panen ~ Produksi, data = var_luaspanen_1)

# Ringkasan hasil model
summary(regression_1)
```
*Kesimpulan*

Koefisien estimasi untuk Produksi  adalah 1.815e-01 dengan P-value < 2e-16 *** yang lebih besar dari tingkat signifikansi yang umumnya digunakan (0.05) dan F-statistic adalah 1012 dengan p-value: < 2.2e-16. Oleh karena itu, Luas panen secara statistik signifikan mempengaruhi Produksi dalam model regresi ini.


```{r}
# Menghitung koefisien korelasi Pearson
correlation_1 <- cor(var_luaspanen_1$Luas_panen, var_luaspanen_1$Produksi)
correlation_1
```
*Kesimpulan*
Koefisien korelasi Pearson antara Luas_panen dan Curah_hujan adalah  0.9056222

Koefisien korelasi ini memiliki nilai poditif, yang menunjukkan adanya hubungan yang kuat antara Luas_panen dan Produksi ditunjukkan oleh nilainya adalah 0.9056222. nilai koefisien korelasi ini cukup mendekati satu, sehingga hubungan antara kedua variabel ini sangat kuat.


*B.Curah hujan terhadap luas panen padi di SUMUT 1993-2020*

### Saya akan memodelkan VAR luas panen terhadap produksi padi di SUMUT tahun 1993-2020

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh Luas panen terhadap peningkatan produksi
var_luaspanen_2 <- sumut_padi_filter[, c("Produksi", "Luas_panen")]
var_luaspanen_2
```

Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_luaspanen_2 <- ts(var_luaspanen_2, start = c(1993,1), frequency = 1)
ts_luaspanen_2
```

```{r}
lag_luaspanen_2 <- VARselect(ts_luaspanen_2, lag.max = 5, type = "both")
lag_luaspanen_2
```

```{r}
# VAR Model
Model_Var2_luaspanen <- VAR(ts_luaspanen_2, p = lag_luaspanen_2$selection[1], type = "both") # jumlah order dari model VAR
summary(Model_Var2_luaspanen)
```

*Kesimpulan*
- Estimation results for equation Produksi:
Produksi.l1 P-valuenya = 0.00675 **  dan Luas_panen.l1 P-valuenya =   0.17353    
Produksi.l2  P-valuenya =  0.00114 **  dan Luas_panen.l2 P-valuenya = 1.68e-05 ***
Produksi.l3 P-valuenya =  0.06934 dan Luas_panen.l3 P-valuenya = 0.00326 ** 
Produksi.l4 P-valuenya =  0.01033 *  dan Luas_panen.l4  P-valuenya = 0.00136 ** 
pada F-statistic p-value: 2.734e-05 menunjukkan signifikansi keseluruhan dari model memiliki efek statistik yang signifikan dalam menjelaskan hubungan antara variabel  Luas_panen dan produksi. Jadi dapat disimpulkan bahwa terdapat pengaruh luas panen terhadap produksi padi sumut tahun 1993-2020.



```{r}
# Melakukan uji Granger Causality
granger_luaspanen_2 <- causality(Model_Var2_luaspanen, cause = "Luas_panen")
granger_luaspanen_2
```
Secara keseluruhan, berdasarkan hasil uji Granger Causality( p-value = 4.914e-06) dan Instantaneous Causality(p-value = 0.1338) sehingga dapat disimpulkan bahwa terdapat pengaruh jangka pajang luas panen terhadap produksi padi tetapi tidak terdapat pengaruh jangka pendek luas panen terhadap produksi.


```{r}
# Membuat model regresi linier
regression_2 <- lm(Produksi ~ Luas_panen, data = var_luaspanen_2)

# Ringkasan hasil model
summary(regression_2)
```

Dilihat dari nilai p-value luas panen adalah 0.233 dan nilai f-statistik p-valuenya adalah 0.2335 jadi di model regresi ini tidak hubungan luas panen terhadap produksi padi



```{r}
# Menghitung koefisien korelasi Pearson
correlation_2 <- cor(var_luaspanen_2$Luas_panen, var_luaspanen_2$Produksi)
correlation_2
```

# 12. Model GARCH

```{r}
library(rugarch)
```

```{r}
# Membuat data frame dengan kolom 'Curah_hujan' dan 'Produksi_padi'
data_padi <- data.frame(Curah_hujan = sumatera_padi$Curah_hujan, Produksi= sumatera_padi$Produksi)
data_padi
```

```{r}
# Membuat model GARCH
model_garch_1 <- ugarchspec(variance.model = list(model = "sGARCH", garchOrder = c(1, 1)), 
                          distribution.model = "std")
```

```{r}

# Estimasi model GARCH
fit_garch_1 <- ugarchfit(spec = model_garch_1, data = data_padi$Curah_hujan)

# Tampilkan hasil
summary(fit_garch_1)
```

# 13. Padi Kabupaten Deli Serdang

##Obstain
```{r}
# Load data curah hujan
Hujan_kab <- read_excel("D:/OneDrive - mikroskil.ac.id/Skripsi/Curah hujan Kab Sumut.xlsx")
Hujan_kab
```


```{r}
# Merubah type data Tahun menjadi Date
Hujan_kab$Tahun <- make_date(Hujan_kab$Tahun)
#Merubah type data charater menjadi numeric
Hujan_kab$Curah_hujan <-as.numeric(Hujan_kab$Curah_hujan)
Hujan_kab$Hari_hujan <-as.numeric(Hujan_kab$Hari_hujan)
glimpse(Hujan_kab)
```


### Menghapus data kosong
```{r}
# Menampikan variabel dengan baris kosong
colSums(is.na(Hujan_kab))
```

### Mengambil data padi di kabupaten Deli serdang dari tahun 2015-2022

```{r}
# Filter data for kabupaten hanya "deli serdang" saja dari tahun 2015 s.d 2022
Padi_deliserdang <- Padi %>%
  filter(Kabupaten_Kota == "Deli Serdang" & year(Tahun) >= 2015 & year(Tahun) <= 2022)
Padi_deliserdang
```

```{r}
# Mengabungkan kedua dataset
merged_padi_kab <- merge(Padi_deliserdang, Hujan_kab, by.x = "Tahun", by.y = "Tahun")
merged_padi_kab
```


## VAR Model
```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan, luas panen, dan hari hujan terhadap peningkatan produksi

Var1_padi_deli <- merged_padi_kab[, c("Produksi", "Curah_hujan", "Luas_Panen", "Hari_hujan")]
Var1_padi_deli
```



```{r}
#Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam format time series (ts)
ts_padi_deli <- ts(Var1_padi_deli, start = c(2015,5), frequency = 1)
head(ts_padi_deli)
```



```{r}
#menetukan jumlah lag yang optimal dlm Var
lag_padi_deli <- VARselect(ts_padi_deli, lag.max = 1, type = "both")
lag_padi_deli

#akan berisi hasil pemilihan model VAR terbaik berdasarkan perbandingan AIC dan BIC untuk berbagai jumlah lag
```


```{r}
# VAR Model
var_padi_deliserdang <- VAR(ts_padi_deli, p = lag_padi_deli$selection[1], type = "both") # jumlah order dari model VAR
summary(var_padi_deliserdang)

#Saya menguji dengan 4 variabel yaitu produksi, curah hujan, luas panen dan hari hujan
```
*Ksesimpulan*
Estimation results for equation Produksi: 
nilai dari p-value luas panen, curah hujan dan hari hujan semuanya lebih besar dari 0,05 yg berarti tidak memiliki pengaruh terhadap produksi, tetapi produksi pada lag 1 memiliki p-value adalah 2.67e-07 *** yang bearti produksi berpengaruh terhadap dirinya sendiri. sedangkan nilai f-statistik p-value (<2.2e-16) syang bearti signifikan dalam menjelaskan hubungan2 variabel tersebut

Estimation results for equation Curah_hujan:
nilai p value dari masing 4 varibel semuanya lebih besar dari 0,05 tetapi nilai f-statistik p-valuenya adalah 7.757e-06  yg lebih kecil dari 0,05 yang bearti signifikan dalam menjelaskan hubungan2 variabel tersebut.

Estimation results for equation Luas_Panen:
nilai dari p-value produksi, curah hujan dan hari hujan pada lag 1 lebih besar dari 0,05 yg berarti tidak memiliki pengaruh terhadap luas panen. tetapi luas panen pada lag 1 memiliki p-valuen adalah 0.00143 ** yang bearti luas panen berpegaruh terhadap dirinya sendiri. sedangkan nilai f-statistik p-value (< 2.2e-16) yang bearti signifikan dalam menjelaskan hubungan2 variabel tersebut.

Estimation results for equation Hari_hujan:
nilai dari p-value produksi, curah hujan, hari hujan dan luas panen semuanya lebih besar dari 0,05 yg berarti tidak memiliki pengaruh terhadap hari hujan. sedangkan nilai f-statistik p-value 0.002252  yang bearti signifikan dalam menjelaskan hubungan2 variabel tersebut.

Jadi secara keseluruhan curah hujan, hari hujan dan luas panen tidak berpegaruh terhadap produksi padi di kabupaten deli serdang.


```{r}
# Melakukan uji Granger Causality
granger_padi_deli <- causality(var_padi_deliserdang, cause = "Curah_hujan")
granger_padi_deli
```
*Kesimpulan* Tidak terdapat pengaruh jangka panjang tetapi terdapat pengaruh jangka pendek(instans) dengan p-value = 4.182e-07

```{r}
# Hitung Pearson correlation coefficient
pearson_curahhujan_deli <- cor(merged_padi_kab$Curah_hujan, merged_padi_kab$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah hujan dan Produksi:", pearson_curahhujan_deli)
```
Koefisien Korelasi Pearson Curah hujan dan Produksi: -0.1996802 yang berarti kolerasinya bernilai negetif tetapi sangat lemah karena mendekati 0 


### Selanjutnya saya akan mencoba melihat haril model VAR yg menggunakan 2 variabel saja yaitu variabel hari hujan dan produksi

```{r}
Var1_deli <-merged_padi_kab[, c("Hari_hujan", "Produksi")]
Var1_deli
```

```{r}
ts_deli1 <- ts(Var1_deli, start = c(2015,5), frequency = 1)
head(ts_deli1)
```

```{r}
lag1_deli <- VARselect(ts_deli1, lag.max = 1, type = "both")
lag1_deli
```

```{r}
# VAR Model
Model_var_deli1 <- VAR(ts_deli1, p = lag1_deli$selection[1], type = "both") # jumlah order dari model VAR
summary(Model_var_deli1)
```

```{r}
# Melakukan uji Granger Causality
granger_padi_deli1 <- causality(var_padi_deliserdang, cause = "Hari_hujan")
granger_padi_deli1
```
```{r}
# Hitung Pearson correlation coefficient
pearson_harihujan_deli <- cor(merged_padi_kab$Hari_hujan, merged_padi_kab$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Hari_hujan dan Produksi:", pearson_harihujan_deli)
```
Koefisien Korelasi Pearson Hari_hujan dan Produksi: 0.01718668

### Saya akan mencoba melakukan VAR luas panen terhadap produksi
```{r}
Var2_deli <-merged_padi_kab[, c("Produksi", "Luas_Panen")]
Var2_deli
```

```{r}
ts_deli2 <- ts(Var2_deli, start = c(2015,5), frequency = 1)
head(ts_deli2)
```

```{r}
lag2_deli <- VARselect(ts_deli2, lag.max = 1, type = "both")
lag2_deli
```

```{r}
# VAR Model
Model_var_deli2 <- VAR(ts_deli2, p = lag2_deli$selection[1], type = "both") # jumlah order dari model VAR
summary(Model_var_deli2)
```

Estimation results for equation Luas_Panen: 
                Estimate Std. Error t value Pr(>|t|)   
Produksi.l1      0.03973    0.03442   1.154  0.25139   
Luas_Panen.l1    0.68129    0.20663   3.297  0.00139 **
Nilai F-statistic p-value: < 2.2e-16 Sehingga dapat di simpulkan bahwa luas panen berpengaruh terhadap dirinya sendiri

Estimation results for equation Produksi: 
Estimate Std. Error t value Pr(>|t|)    
Produksi.l1       1.1010     0.1945   5.660 1.74e-07 ***
Luas_Panen.l1    -1.0851     1.1679  -0.929   0.3553 
nilai F-statistic  p-value: < 2.2e-16 Sehingga dapat di simpulkan bahwa produksi berpengaruh terhadap dirinya sendiri


```{r}
# Melakukan uji Granger Causality
granger_padi_deli2 <- causality(Model_var_deli2, cause = "Luas_Panen")
granger_padi_deli2
```
Granger p-value = 0.3541 sedangkan Instant p-value = 1.257e-11, sehingga dapat diismpulkan bahwa tidak terdapat pengaruh jangka panajng tetapi terdapat pengaruh jangka pendek.

```{r}
# Hitung Pearson correlation coefficient
pearson_luaspanen_deli <- cor(merged_padi_kab$Luas_Panen, merged_padi_kab$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", pearson_luaspanen_deli)
```
Koefisien Korelasi Pearson Luas Panen dan Produksi: 0.9872632, dapat disimpulkan bahwa kolerasinya positif dan kuat karena  mendekati 1


### Model VAR Curah hujan terhadap rata-rata produksi padi deli serdang

```{r}
Var3_deli <-merged_padi_kab[, c("Curah_hujan", "Rata_rata_produksi")]
Var3_deli
```

```{r}
ts_deli3 <- ts(Var3_deli, start = c(2015,5), frequency = 1)
head(ts_deli3)
```

```{r}
lag3_deli <- VARselect(ts_deli3, lag.max = 1, type = "both")
lag3_deli
```

```{r}
# VAR Model
Model_var_deli3 <- VAR(ts_deli3, p = lag3_deli$selection[1], type = "both") # jumlah order dari model VAR
summary(Model_var_deli3)
```

```{r}
# Melakukan uji Granger Causality
granger_padi_deli3 <- causality(Model_var_deli3, cause = "Curah_hujan")
granger_padi_deli3
```


```{r}
# Hitung Pearson correlation coefficient
pearson_curahhujan_deli3 <- cor(merged_padi_kab$Curah_hujan, merged_padi_kab$Rata_rata_produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Curah hujan dan Rata-rata Produksi:", pearson_curahhujan_deli3)
```
Koefisien Korelasi Pearson Curah hujan dan Rata-rata Produksi: 0.2838944

#Mencoba melihat kolerasi setiap variabel

```{r}
# Hitung Pearson correlation coefficient
pearson_1 <- cor(merged_padi_kab$Hari_hujan, merged_padi_kab$Rata_rata_produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Hari hujan dan Rata-rata Produksi:", pearson_1)
```
Koefisien Korelasi Pearson Curah hujan dan Rata-rata Produksi: 0.2838944

```{r}
# Hitung Pearson correlation coefficient
pearson_2 <- cor(merged_padi_kab$Luas_Panen, merged_padi_kab$Rata_rata_produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson luas panen dan Rata-rata Produksi:", pearson_2)
```
Koefisien Korelasi Pearson luas panen dan Rata-rata Produksi: -0.4080495


# 14. Ubi Jalar kab.Dairi
```{r}
Hujan<- read_excel("D:/OneDrive - mikroskil.ac.id/Skripsi/Curah hujan palawija Kabupaten.xlsx")
Hujan
```

```{r}
# Merubah type data karakter menjadi numeric
Hujan$Curah_hujan <- as.numeric(Hujan$Curah_hujan)
Hujan$Hari_hujan <- as.numeric(Hujan$Hari_hujan)
Hujan
```

```{r}
# Merubah type Tahun menjadi Date
Hujan$Tahun <- make_date(Hujan$Tahun)
glimpse(Hujan)
```

### b. Menghapus Data Kosong

```{r}
# Menampikan variabel dengan baris kosong
colSums(is.na(Hujan))
```

```{r}
# Menghapus data NA's
Hujan_clean <- na.omit(Hujan)
summary(Hujan_clean)
```

```{r}
colSums(is.na(Hujan_clean))
```
```{r}
# Filter data for "Dairi" kabupaten dari Hujan Clean
Dairi_hujan <- Hujan_clean %>%
  filter(Kabupaten_kota == "Dairi")
Dairi_hujan
```

```{r}
# Filter data for "Dairi" kabupaten dari dataset UbiJalar_Sumut
Ubijalar_Dairi <- UbiJalar_Sumut %>%
  filter(Kabupaten_Kota == "Dairi" & year(Tahun) >= 2015 & year(Tahun) <= 2021)
Ubijalar_Dairi
```

```{r}
# Mengabungkan kedua dataset
merged_dairi <- merge(Ubijalar_Dairi, Dairi_hujan, by.x = "Tahun", by.y = "Tahun")
merged_dairi
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_var_dairi <- merged_dairi [, c("Produksi", "Curah_hujan", "Hari_hujan","Luas_Panen")]
data_var_dairi
```



Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_dairi <- ts(data_var_dairi, start = c(2015,1), frequency = 1)
ts_dairi
```

```{r}
lag_dairi <- VARselect(ts_dairi, lag.max = 5, type = "both")
lag_dairi
```

```{r}
# VAR Model
var_model_Dairi <- VAR(ts_dairi, p = lag_dairi$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_Dairi)
```


```{r}
# Melakukan uji Granger Causality
granger_test1 <- causality(var_model_Dairi, cause = "Curah_hujan")
granger_test1
```


```{r}
# Menghitung koefisien korelasi Pearson
correlation_dairi <- cor(data_var_dairi$Produksi, data_var_dairi$Curah_hujan)
cat("Koefisien Korelasi Pearson Curah hujan Produksi:", correlation_dairi)
```
Koefisien Korelasi Pearson Curah hujan Produksi: 0.1315519

```{r}
# Hitung Pearson correlation coefficient
pearson_dairi <- cor(data_var_dairi$Hari_hujan, data_var_dairi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Hari hujan dan Produksi:", pearson_dairi)
```

```{r}
# Hitung Pearson correlation coefficient
pearson_dairi2 <- cor(data_var_dairi$Luas_Panen, data_var_dairi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", pearson_dairi2)
```
Koefisien Korelasi Pearson Luas Panen dan Produksi: 0.9384474


# 15. Kacang Kedelai Kab.Simalungun 

```{r}
# Filter data for "Dairi" kabupaten dari Hujan Clean
Simalungun_hujan <- Hujan_clean %>%
  filter(Kabupaten_kota == "Simalungun")
Simalungun_hujan
```
```{r}
# Filter data for "Simalungun" kabupaten dari dataset Kacang_Kedelai
Kedelai_simalungun <- Kacang_Kedelai %>%
  filter(Kabupaten_Kota == "Simalungun" & year(Tahun) >= 2013 & year(Tahun) <= 2019)
Kedelai_simalungun
```

```{r}
# Mengabungkan kedua dataset
merged_simalungun <- merge(Kedelai_simalungun, Simalungun_hujan, by.x = "Tahun", by.y = "Tahun")
merged_simalungun
```

```{r}
# Pilih variabel yang akan diprediksi
# dalam pengujian ini akan dilihat apakah ada pengaruh curah hujan terhadap peningkatan produksi
data_var_simalungun <- merged_simalungun [, c("Produksi", "Curah_hujan", "Hari_hujan","Luas_Panen")]
data_var_simalungun
```



Untuk mendukung prediksi dengan Model VAR, data harus dirubah kedalam
format time series (ts)

```{r}
ts_simalungun <- ts(data_var_simalungun, start = c(2013,1), frequency = 1)
ts_simalungun
```

```{r}
lag_simalungun <- VARselect(ts_simalungun, lag.max = 5, type = "both")
lag_simalungun
```

```{r}
# VAR Model
var_model_simalungun <- VAR(ts_simalungun, p = lag_simalungun$selection[1], type = "both") # jumlah order dari model VAR
summary(var_model_simalungun)
```

Estimation results for equation Produksi: 
hanya Produksi.l1 yang memiliki p-value lebih kecil dari 0,05 yaitu  0.000752*** sedangkan curah_hujan.l1, hari_hujan.l1 dan luas panen.l1 memiliki p-value lebih besar dari 0,05 dengan f-statistik  p-value: < 2.2e-16 



```{r}
# Melakukan uji Granger Causality
granger_simalungun <- causality(var_model_simalungun, cause = "Curah_hujan")
granger_simalungun
```
Granger causality H0: Curah_hujan do not Granger-cause Produksi Hari_hujan Luas_Panen dengan p-value = 0.05022

instantaneous causality between: Curah_hujan and Produksi Hari_hujan Luas_Panen p-value = 3.843e-05


```{r}
# Menghitung koefisien korelasi Pearson
correlation_simalungun1 <- cor(merged_simalungun$Curah_hujan, merged_simalungun$Produksi)
cat("Koefisien Korelasi Pearson Curah hujan Produksi:", correlation_simalungun1)
```
Koefisien Korelasi Pearson Curah hujan Produksi: 0.1008478

```{r}
# Hitung Pearson correlation coefficient
pearson_simalungun1 <- cor(merged_simalungun$Hari_hujan, merged_simalungun$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Hari hujan dan Produksi:", pearson_simalungun1)
```
Koefisien Korelasi Pearson Hari hujan dan Produksi: 0.2544005


```{r}
# Hitung Pearson correlation coefficient
pearson_simalungun2 <- cor(data_var_dairi$Luas_Panen, data_var_dairi$Produksi)

# Nilai correlation coefficient
cat("Koefisien Korelasi Pearson Luas Panen dan Produksi:", pearson_simalungun2)
```
Koefisien Korelasi Pearson Luas Panen dan Produksi: 0.9384474

